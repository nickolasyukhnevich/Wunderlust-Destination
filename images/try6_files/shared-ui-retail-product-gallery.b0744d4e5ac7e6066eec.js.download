/*@license For license information please refer to shared-ui-retail-product-gallery.licenses.txt*/
(self.webpackChunkblossom_flex_ui=self.webpackChunkblossom_flex_ui||[]).push([[23701],{95358:function(e,n,t){t.d(n,{Li:function(){return cn},Vp:function(){return Se},q6:function(){return ke}});var l=t(67294),a=t(69430),i=t(92787),r=t(95878),o=t(98250),c=t(64418),u=t(57099),s=t(20501),m=t(12108),d=t(96580),g=t(35623),v=t(58244),p=t(7056),y=t(85518),f=t(36695),E=t(73030),h=t(85395),b=t(16550),I=t(19633),S=t(68810),k=t(9260),G=t(57510),D=t(39348),C=t(20227),T=t(38499),w=t(29892),x=t(81721),P=t(57823),L=t(34353),_=t(49349),A=t(89191),O=t(65160),R=t(26044),M=t(6004),V=t(51330),F=t(8470),N=t(23984),B=t(91233),z=t(93351),U=t(30300),H=t(70006),j=t(8409),Y=t(70131),W=t(83854),K=t(23467),$=t(21869),Q=t(70334),q=t(31305);function X(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,l=new Array(n);t<n;t++)l[t]=e[t];return l}function J(e,n,t,l,a,i,r){try{var o=e[i](r),c=o.value}catch(u){return void t(u)}o.done?n(c):Promise.resolve(c).then(l,a)}function Z(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ee(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},l=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),l.forEach((function(n){Z(e,n,t[n])}))}return e}function ne(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function te(e,n){if(null==e)return{};var t,l,a=function(e,n){if(null==e)return{};var t,l,a={},i=Object.keys(e);for(l=0;l<i.length;l++)t=i[l],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(l=0;l<i.length;l++)t=i[l],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function le(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var l,a,i=[],r=!0,o=!1;try{for(t=t.call(e);!(r=(l=t.next()).done)&&(i.push(l.value),!n||i.length!==n);r=!0);}catch(c){o=!0,a=c}finally{try{r||null==t.return||t.return()}finally{if(o)throw a}}return i}}(e,n)||re(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function ie(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||re(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,n){if(e){if("string"==typeof e)return X(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?X(e,n):void 0}}function oe(e,n){var t,l,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,l&&(a=2&i[0]?l.return:i[0]?l.throw||((a=l.return)&&a.call(l),0):l.next)&&!(a=a.call(l,i[1])).done)return a;switch(l=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,l=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=r.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=n.call(e,r)}catch(o){i=[6,o],l=0}finally{t=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}function ce(){var e=ae(["\n  fragment GalleryButtonsFragment on ProductImageGallery {\n    galleryButtons {\n      accessibility\n      icon {\n        description\n        id\n      }\n      action {\n        resource {\n          value\n        }\n      }\n    }\n  }\n"]);return ce=function(){return e},e}function ue(){var e=ae(["\n  fragment PropertyImageFragment on ProductImageInfo {\n    image {\n      url\n      description\n      analytics {\n        linkName\n        referrerId\n      }\n    }\n    lowResImage {\n      url\n    }\n    analytics {\n      trackingId\n      imageId\n      subjectId\n    }\n    description\n  }\n"]);return ue=function(){return e},e}function se(){var e=ae(["\n  fragment CarouselContainerFragment on ProductImageGallery {\n    accessibilityLabel\n    categoryIdAll\n    categorizedImages {\n      accessibilityLabel\n      clientSideAnalytics {\n        linkName\n        referrerId\n      }\n      images {\n        ...PropertyImageFragment\n      }\n    }\n    ...GalleryButtonsFragment\n  }\n\n  ","\n  ","\n"]);return se=function(){return e},e}function me(){var e=ae(["\n  fragment MosaicContainerFragment on ProductImageGallery {\n    accessibilityLabel\n    categorizedImages {\n      accessibilityLabel\n      clientSideAnalytics {\n        linkName\n        referrerId\n      }\n      images {\n        ...PropertyImageFragment\n      }\n    }\n    ...GalleryButtonsFragment\n  }\n\n  ","\n  ","\n"]);return me=function(){return e},e}function de(){var e=ae(["\n  fragment MediaGalleryDialogFragment on ProductImageGallery {\n    categorizedImages {\n      categoryId\n      categoryName\n      images {\n        ...PropertyImageFragment\n      }\n    }\n    mediaGalleryDialog {\n      toolbar {\n        icon {\n          id\n          description\n        }\n      }\n    }\n  }\n  ","\n"]);return de=function(){return e},e}function ge(){var e=ae(["\n  fragment ThumbnailGalleryDialogFragment on ProductImageGallery {\n    categorizedImages {\n      categoryId\n      categoryName\n      images {\n        ...PropertyImageFragment\n      }\n      galleryButton {\n        button {\n          ... on UISecondaryButton {\n            accessibility\n            primary\n            analytics {\n              referrerId\n              linkName\n            }\n          }\n        }\n      }\n    }\n    thumbnailGalleryDialog {\n      toolbar {\n        title\n        icon {\n          id\n          description\n        }\n      }\n      trigger {\n        accessibilityLabel\n        value\n      }\n      primaryButton {\n        button {\n          ... on UIPrimaryButton {\n            primary\n            accessibility\n            analytics {\n              referrerId\n              linkName\n            }\n          }\n        }\n        targetRef\n      }\n    }\n  }\n  ","\n"]);return ge=function(){return e},e}function ve(){var e=ae(["\n  fragment ProductGalleryImageContainerFragment on ProductImageGallery {\n    ...MosaicContainerFragment\n    ...CarouselContainerFragment\n    ...MediaGalleryDialogFragment\n    ...ThumbnailGalleryDialogFragment\n    ...GalleryButtonsFragment\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return ve=function(){return e},e}function pe(){var e=ae(["\n  query ProductGalleryQuery($context: ContextInput!, $productIdentifier: ProductIdentifierInput!) {\n    productGallery(context: $context, productIdentifier: $productIdentifier) {\n      ...ProductGalleryImageContainerFragment\n    }\n  }\n\n  ","\n"]);return pe=function(){return e},e}var ye=(0,l.createContext)({isRandomAccessOne:!1,data:void 0}),fe=function(e){var n=e.data,t=e.children,a=(0,l.useMemo)((function(){var e,t;return{isRandomAccessOne:!!(null==n||null===(t=n.randomAccessOne)||void 0===t||null===(e=t.mapping)||void 0===e?void 0:e.length),data:n}}),[n]);return l.createElement(ye.Provider,{value:a},t)};var Ee={VIDEO_SUCCESS:new h.nS(h.nl.INFO,"VIDEO_SUCCESS"),VIDEO_FAILED:new h.nS(h.nl.ERROR,"VIDEO_FAILED")},he="Successful lookupVideo call for aerial view, propertyId=",be="lookupVideo call failed for aerial view, propertyId=",Ie=function(e,n){return{event:{event_name:e,event_type:n,event_version:"1.0.0",event_category:""},experience:{app_name:"shared-ui",app_version:"1.0.0",page_name:"PDP Page"}}},Se=(0,l.createContext)({useControlBehaviour:!1,setAdaptExState:function(){},eventType:void 0,setAdaptExSuccessEvent:function(){}}),ke=function(e){var n=e.children,t=le((0,l.useState)(!1),2),a=t[0],i=t[1],r=le((0,l.useState)(void 0),2),o=r[0],c=r[1],u=(0,l.useMemo)((function(){return{useControlBehaviour:a,setAdaptExState:i,eventType:o,setAdaptExSuccessEvent:c}}),[a,i,o,c]);return l.createElement(Se.Provider,{value:u},n)};function Ge(e,n,t,l,a,i,r){var o=[{imageGalleryMetaTagValue:Date.now().toString(),imageGalleryMetaTagType:"DEVICE_TIME_STAMP"}];return r&&o.push({imageGalleryMetaTagValue:r,imageGalleryMetaTagType:"GALLERY_FILTER"}),[{schemaName:"allHotelProducts",messageContent:{hotelProducts:[ee({imageGalleryAlgorithm:{name:"heroaesthetics.v20190411-hsc.v20190223"},algoMediaGuid:n},a?{productId:Number(a)}:{})]}},{schemaName:"imageTracking",messageContent:ee({galleryName:i,galleryType:"GALLERY_TYPE_SINGLE",galleryMaxPosition:t,galleryPosition:e,repeatedGalleryIndex:null,imageGalleryMetaTagList:o},l?{images:[{id:l,galleryPosition:e}]}:{})}]}function De(e){return e.map((function(e){var n,t,l,a,i;return{src:null!==(t=e.image.url)&&void 0!==t?t:"",caption:null!==(l=null===(n=e.image)||void 0===n?void 0:n.description)&&void 0!==l?l:"",alt:null!==(i=null!==(a=e.description)&&void 0!==a?a:e.image.description)&&void 0!==i?i:""}}))}function Ce(e){return e.map((function(e){var n,t,l,a,i,r,o,c,u;return{src:null!==(a=e.image.url)&&void 0!==a?a:"",caption:null!==(r=null!==(i=e.description)&&void 0!==i?i:e.image.description)&&void 0!==r?r:"",displayCaption:null!==(o=e.image.description)&&void 0!==o?o:"",alt:null!==(u=null!==(c=e.description)&&void 0!==c?c:e.image.description)&&void 0!==u?u:"",thumbnailClickAnalytics:null===(n=e.image)||void 0===n?void 0:n.analytics,trackingId:(null===(t=e.analytics)||void 0===t?void 0:t.trackingId)||null,imageId:(null===(l=e.analytics)||void 0===l?void 0:l.imageId)||null}}))}var Te=function(e){var n=e.children;return e.aerialViewButton?l.createElement(o.EgClickstreamImpressionTracker,{eventData:Ie("aerial_view.presented","Impression")},n):n},we=(0,a.Ps)(ce()),xe={position:{zindex:"layer2",bottom:"three",right:"three"},type:"absolute"},Pe=function(e){var n=e.data,t=e.onThumbnailGalleryClick,a=e.onVirtualTourClick,i=e.onAerialViewClick,r=e.thumbnailButtonText,c=e.thumbnailDialogTriggerAccessibilityLabel,u=e.propertyId,s=n.galleryButtons,m=(0,o.useClickTracker)(),d=(0,o.useEgClickstream)(),v=l.useCallback((function(e){var n,t,l,r,o,c,u,m;if("tour_360"===(null==s||null===(t=s[e])||void 0===t||null===(n=t.icon)||void 0===n?void 0:n.id)&&(null===(r=s[e])||void 0===r||null===(l=r.action)||void 0===l?void 0:l.resource)){var g,v,p,y=(null==s||null===(p=s[e])||void 0===p||null===(v=p.action)||void 0===v||null===(g=v.resource)||void 0===g?void 0:g.value)||"";a(y)}else if("visibility"===(null==s||null===(c=s[e])||void 0===c||null===(o=c.icon)||void 0===o?void 0:o.id)&&(null===(m=s[e])||void 0===m||null===(u=m.action)||void 0===u?void 0:u.resource)){var f,E,h,b=(null==s||null===(h=s[e])||void 0===h||null===(E=h.action)||void 0===E||null===(f=E.resource)||void 0===f?void 0:f.value)||"";d(Ie("aerial_view.selected","Interaction")),i(b.replace("#",""))}}),[s,d,a,i]),p=l.useMemo((function(){return{id:"HOT.HIS.PhotoGalleryTrigger",description:"Open Room Gallery dialog",callback:function(e,n){m(e,n,void 0,Ge(0,void 0,0,void 0,u,"PDP_FULL_IMAGE_GALLERY"))}}}),[m]);return l.createElement(g.EGDSLayoutPosition,ee({},xe),l.createElement(D.EGDSLayoutFlex,{space:"two",wrap:"nowrap"},null==s?void 0:s.map((function(e,n){var t,a,i,r;return l.createElement(Te,{aerialViewButton:"visibility"===(null==e||null===(t=e.icon)||void 0===t?void 0:t.id)&&(null==e||null===(a=e.action)||void 0===a?void 0:a.resource)},l.createElement(k.EGDSOverlayButton,{key:"gallery-mosaic-action-".concat(null===(i=e.icon)||void 0===i?void 0:i.id),"aria-label":"gallery-mosaic-action",onClick:function(){return v(n)}},l.createElement(G.EGDSIcon,{name:(null===(r=e.icon)||void 0===r?void 0:r.id)||"",id:"gallery-mosaic-action-trigger"}),e.accessibility))})),l.createElement(k.EGDSOverlayButton,{"aria-label":c||"",onClick:t,analytics:p},l.createElement(G.EGDSIcon,{name:"photo_library",id:"gallery-mosaic-thumbnail-trigger"}),r)))};Pe.displayName="GalleryButtons",Pe.fragment=we;var Le=function(e){var n,t,a=e.button,i=e.onClick,r=e.showTextLabel;return l.createElement(k.EGDSOverlayButton,{"aria-label":(null==a?void 0:a.accessibility)||"",size:k.UitkButtonSize.SMALL,onClick:i},l.createElement(G.EGDSIcon,{size:G.UitkIconSize.SMALL,name:(null==a||null===(n=a.icon)||void 0===n?void 0:n.id)||"",id:"PhotoGallery-".concat(null==a||null===(t=a.icon)||void 0===t?void 0:t.id)}),!r&&(null==a?void 0:a.accessibility))},_e=function(e){var n,t,a=e.button,i=e.onClick,r=e.showTextLabel;return l.createElement(k.EGDSOverlayButton,{"aria-label":(null==a?void 0:a.accessibility)||"",size:k.UitkButtonSize.SMALL,onClick:i},l.createElement(G.EGDSIcon,{size:G.UitkIconSize.SMALL,name:(null==a||null===(n=a.icon)||void 0===n?void 0:n.id)||"",id:"PhotoGallery-".concat(null==a||null===(t=a.icon)||void 0===t?void 0:t.id)}),!r&&(null==a?void 0:a.accessibility))},Ae=function(e){var n=e.uitkImages,t=e.handleMediaButtonClick,a=(0,w.useLocalization)().formatText;return l.createElement(k.EGDSOverlayButton,{size:k.UitkButtonSize.SMALL,onClick:t},l.createElement(G.EGDSIcon,{name:"photo_library",id:"photo_library-id",title:a("gallerycarousel.mediaGalleryButton",n.length)}),l.createElement("span",{"aria-hidden":"true"},String(n.length)))},Oe=function(e){var n,t,a=e.ratio,i=e.uitkImages,r=e.controlAnalytics,o=e.label,u=e.handleIndexChange,s=e.handleImageClick,m=e.handleMediaButtonClick,d=e.onVirtualTourClick,v=e.onAerialViewClick,p=e.virtualTourButton,y=e.aerialViewButton,f=l.useRef(null),E=le(l.useState(0),2),h=E[0],b=E[1],I=0!==(0,c.useExperiment)("mWeb_larger_image_for_top_of_PDP_gallery").exposure.bucket;return l.createElement(g.EGDSLayoutPosition,{type:"relative"},l.createElement(C.EGDSCarousel,{carouselRef:f,analytics:r,carouselHeaderLevel:"h2",carouselHeaderText:o||"",carouselName:"PhotoGallery",itemsVisible:{sm:1,md:1,lg:1},onIndexChange:function(e){b(e),u(e)},hideNav:I,pagingPersistent:!I,pagingInset:!I,pagingOverlay:!I,peek:!1,wrapItems:!0,buttonText:{nextButton:"Show next card",prevButton:"Show previous card"}},i.map((function(e,n){return l.createElement(S.EGDSFigure,{ratio:a,key:n},l.createElement(S.EGDSImage,{placeholderImage:!0,alt:e.alt,src:e.src,lazyLoading:"lazy"}),l.createElement(S.EGDSImageLink,null,l.createElement("button",{type:"button",onClick:s},e.alt)))}))),(null===(n=f.current)||void 0===n?void 0:n.changeIndex)&&I&&l.createElement(T.EGDSScrim,{type:T.EGDSScrimType.BOTTOM},l.createElement(C.EGDSCarouselPaginationDots,{activeIndex:h,inset:!0,itemCount:i.length,changeIndex:null===(t=f.current)||void 0===t?void 0:t.changeIndex})),I?l.createElement(l.Fragment,null,l.createElement(g.EGDSLayoutPosition,{position:{bottom:"three",left:"three",zindex:"layer3"},type:"absolute"},p&&l.createElement(Le,{button:p,onClick:d,showTextLabel:I}),y&&l.createElement(Le,{button:y,onClick:v,showTextLabel:I})),l.createElement(g.EGDSLayoutPosition,{position:{bottom:"three",right:"three",zindex:"layer3"},type:"absolute"},l.createElement(Ae,{uitkImages:i,handleMediaButtonClick:m}))):l.createElement(g.EGDSLayoutPosition,{position:{bottom:"three",right:"three",zindex:"layer3"},type:"absolute"},l.createElement(D.EGDSLayoutFlex,{space:"two"},l.createElement(D.EGDSLayoutFlexItem,null,p&&l.createElement(_e,{button:p,onClick:d,showTextLabel:I}),y&&l.createElement(Le,{button:y,onClick:v,showTextLabel:I})),l.createElement(D.EGDSLayoutFlexItem,null,l.createElement(Ae,{uitkImages:i,handleMediaButtonClick:m})))))},Re=function(e){var n,t,a,i,r=e.imageIndex,c=e.images,u=e.propertyId,s=e.children;return l.createElement(o.IntersectionTracker,{tag:"span",referrerId:"HOT.HIS.MosaicTileImageImpression.".concat(r),linkName:"Mosaic Tile Image Impression",trackOnce:!0,additionalUisPrimeMicroMessages:Ge(r,null===(t=c[r])||void 0===t||null===(n=t.analytics)||void 0===n?void 0:n.trackingId,c.length,null===(i=c[r])||void 0===i||null===(a=i.analytics)||void 0===a?void 0:a.imageId,u,"PDP_MOSAIC")},s)},Me=(0,a.Ps)(ue()),Ve=function(e){var n=e.data,t=e.onClick,a=e.index,i=e.className,r=e.fetchPriority,c=e.galleryLength,u=e.propertyId,s=te(e,["data","onClick","index","className","fetchPriority","galleryLength","propertyId"]),m=n.image,d=n.lowResImage,g=n.analytics,v=n.description,p=g||{},y=p.trackingId,f=p.imageId,E=null==m?void 0:m.analytics,h=(0,o.useClickTracker)(),b=(0,l.useContext)(ye).isRandomAccessOne,I=l.useCallback((function(){E&&h(null==E?void 0:E.referrerId,null==E?void 0:E.linkName),t(a)}),[t,a,E]),k=l.createElement(l.Fragment,null,l.createElement(S.EGDSImage,{alt:null!=v?v:"",placeholderImage:!0,src:(null==d?void 0:d.url)?d.url:m.url,additionalProps:{fetchPriority:r}}),l.createElement(S.EGDSImageLink,null,l.createElement("button",{onClick:I,type:"button"},l.createElement("span",{className:"is-visually-hidden"},v))));return l.createElement(S.EGDSFigure,ne(ee({},s),{className:i,ratio:b?S.EGDSFigureAspectRatioType.R3_2:S.EGDSFigureAspectRatioType.R16_9}),E?l.createElement(o.IntersectionTracker,{trackOnce:!0,referrerId:"HOT.HIS.MosaicTileImageImpression.".concat(a),linkName:"Mosaic Tile Image Impression",additionalUisPrimeMicroMessages:Ge(a,y,c,f,u,"PDP_MOSAIC")},k):k)};Ve.displayName="PropertyImage",Ve.fragment=Me;var Fe=(0,a.Ps)(se(),Pe.fragment,Ve.fragment),Ne=function(e){var n=e.data,t=e.allImages,a=e.onImageClick,i=e.onVirtualTourClick,r=e.onAerialViewClick,u=e.onTriggerClick,s=e.imageIndexState,m=e.propertyId,d=n.galleryButtons,g=n.accessibilityLabel,v=l.useContext(Se),p=v.setAdaptExSuccessEvent,y=v.useControlBehaviour,f=(0,o.useClickTracker)(),E=(0,o.useEgClickstream)(),h=le(l.useState(!1),2),b=(h[0],h[1]),I=le(s,2),k=I[0],G=I[1];(0,l.useEffect)((function(){y&&p("ADAPTEX_MOSAIC_VIEW_ATTEMPT_EVENT")}),[]);var D=l.useMemo((function(){return{id:"HOT.HIS.Main",description:"Change image in gallery carousel",callback:function(e,n){var l,a,i,r,o=(a=k,i=t.length,(r=e).includes("clickRight")?a<i-1?a+1:0:r.includes("clickLeft")?a>0?a-1:i-1:a),c=(null===(l=t[o])||void 0===l?void 0:l.analytics)||{},u=c.trackingId,s=c.imageId;f(e,n,void 0,Ge(o,u,t.length,s,m,"PDP_MOSAIC"))}}}),[f]),C=l.useCallback((function(e){G(e),b(!0)}),[G,b]),T=l.useCallback((function(){var e,n,l,i=t[k],r=null==i||null===(e=i.image)||void 0===e?void 0:e.analytics;r&&f(null==r?void 0:r.referrerId,null==r?void 0:r.linkName),f("HOT.HIS.LaunchMainPhotoGallery","Launch Photo Gallery From Image Click",void 0,Ge(k,null==i||null===(n=i.analytics)||void 0===n?void 0:n.trackingId,t.length,null==i||null===(l=i.analytics)||void 0===l?void 0:l.imageId,m,"PDP_MOSAIC")),a(),b(!0)}),[f,a]),w=l.useCallback((function(){f("HOT.HIS.PhotoGalleryTrigger","Open Room Gallery dialog"),u(),b(!0)}),[f,u]),x=null==d?void 0:d.find((function(e){var n,t,l;return"tour_360"===(null===(n=e.icon)||void 0===n?void 0:n.id)?null===(l=e.action)||void 0===l||null===(t=l.resource)||void 0===t?void 0:t.value:null})),P=null==d?void 0:d.find((function(e){var n,t,l;return"visibility"===(null===(n=e.icon)||void 0===n?void 0:n.id)?null===(l=e.action)||void 0===l||null===(t=l.resource)||void 0===t?void 0:t.value:null})),L=l.useCallback((function(){(null==x?void 0:x.action)&&i(x.action.resource.value)}),[i,x]),_=l.useCallback((function(){if(null==P?void 0:P.action){var e,n,t=(null===(n=P.action)||void 0===n||null===(e=n.resource)||void 0===e?void 0:e.value)||"";E(Ie("aerial_view.selected","Interaction")),r(t.replace("#","")),b(!0)}}),[E,r,P]),A=l.useMemo((function(){return De(t)}),[t]),O=function(e){return l.createElement(Te,{aerialViewButton:P},l.createElement(Re,{propertyId:m,images:t,imageIndex:k},l.createElement(Oe,{ratio:e,uitkImages:A,controlAnalytics:D,label:g,handleIndexChange:C,handleImageClick:T,handleMediaButtonClick:w,onVirtualTourClick:L,onAerialViewClick:_,virtualTourButton:x,aerialViewButton:P})))};return l.createElement(c.Experiment,{name:"mWeb_larger_image_for_top_of_PDP_gallery",logExposure:!0},l.createElement(c.ExperimentControl,null,O(S.EGDSFigureAspectRatioType.R16_9)),l.createElement(c.ExperimentVariant,{bucket:1},O(S.EGDSFigureAspectRatioType.R3_2)),l.createElement(c.ExperimentVariant,{bucket:2},O(S.EGDSFigureAspectRatioType.R1_1)))};Ne.displayName="CarouselContainer",Ne.fragment=Fe;var Be=(0,a.Ps)(me(),Pe.fragment,Ve.fragment);var ze=function(e){var n,t=e.data,a=e.allImages,i=e.imagesToShow,r=e.onImageClick,c=e.propertyId,u=t.accessibilityLabel,s=(0,o.useClickTracker)(),m=l.useMemo((function(){var e=a.slice(0,i);return e.length%2==0&&e.pop(),e}),[a,i]),v=l.useCallback((function(e){var n,t=(null===(n=m[e])||void 0===n?void 0:n.analytics)||{},l=t.trackingId,a=t.imageId;s("HOT.HIS.ClickMosaicTileImage.".concat(e),"Property mosaic tile image click",void 0,Ge(e,l,m.length,a,c,"PDP_MOSAIC")),s("HOT.HIS.LaunchMainPhotoGallery","Launch Photo Gallery From Image Click",void 0,Ge(e,l,m.length,a,c,"PDP_MOSAIC")),r(e)}),[s,r]),p=function(e){switch(e){case 5:return 4;case 3:return 3;default:return 1}}(m.length);return l.createElement(g.EGDSLayoutPosition,{type:"relative"},l.createElement(d.EGDSLayoutGrid,{columns:p,rows:2,space:"half"},l.createElement("meta",{itemProp:"image",content:null===(n=m[0])||void 0===n?void 0:n.image.url}),l.createElement("h2",{className:"is-visually-hidden"},u),m.map((function(e,n){return l.createElement(d.EGDSLayoutGridItem,{key:"mosaic-image-".concat(n),colSpan:0===n?2:1,rowSpan:0===n?2:1},l.createElement(Ve,{data:e,onClick:v,index:n,fetchPriority:0===n?"high":void 0,galleryLength:i,propertyId:c}))}))))};ze.fragment=Be,ze.displayName="MosaicContainer";var Ue=function(e){var n=e.isDialogOpen,t=e.onDialogDismiss,a=e.triggerRef,i=e.aerialViewLandscape,r=e.aerialViewDescription,c=(0,o.useClickTracker)(),u=(0,o.useEgClickstream)(),s=l.useMemo((function(){return{id:"HOT.HIS.AerialViewTrigger",description:"Close aerial view dialog",callback:function(e,n){c(e,n),u(Ie("aerial_view.closed","Interaction"))}}}),[c,u]);return l.createElement(L.K,{isVisible:n,liveAnnounceString:"Full Sheet has opened",type:"full",triggerRef:a,theme:"dark"},l.createElement(A.N,{overlay:!0,navigationContent:{navButtonId:"UitkMediaGalleryImageToolbar",navType:"close",navIconLabel:"Close",onClick:t,onClickAnalytics:s}}),i.length>0&&l.createElement(_.z,{padded:!1},l.createElement(D.EGDSLayoutFlex,{justifyContent:"center",alignItems:"center",blockSize:"full_size",direction:"column"},l.createElement(D.EGDSLayoutFlexItem,{alignSelf:"center"},l.createElement(P.Y7,{src:i,autoPlay:!0,muted:!0,controlsList:"nodownload"})),l.createElement(I.Viewport,null,l.createElement(I.ViewSmall,null,l.createElement(D.EGDSLayoutFlexItem,{alignSelf:"start"},l.createElement(y.EGDSSpacing,{margin:"three"},l.createElement(x.EGDSText,{theme:"inverse",overflow:"wrap"},r)))),l.createElement(I.ViewMedium,null,l.createElement(D.EGDSLayoutFlexItem,null,l.createElement(y.EGDSSpacing,{padding:{block:"four",inline:"three"}},l.createElement(D.EGDSLayoutFlex,{justifyContent:"space-between",alignItems:"end"},l.createElement(T.EGDSScrim,{type:T.EGDSScrimType.BOTTOM},l.createElement(x.EGDSText,{theme:"inverse",overflow:"wrap"},r))))))))))};Ue.displayName="AerialViewDialog";var He=(0,a.Ps)(de(),Ve.fragment),je=function(e,n){return l.createElement(N.v,{justifyContent:"space-around",alignItems:"center"},l.createElement(B.t,null,l.createElement(O.S,{iconId:"prev-button-media-gallery",iconTitle:"Show previous card",onClick:function(){e.current&&e.current.changeIndex(n-1)}})),l.createElement(B.t,null,l.createElement(R.Q,{iconId:"next-button-media-gallery",iconTitle:"Show next card",onClick:function(){e.current&&e.current.changeIndex(n+1)}})))},Ye=function(e){var n,t,a,i,r,c=e.data,u=e.allImages,s=e.isDialogOpen,m=e.onDialogDismiss,d=e.imageIndexState,g=e.categoryImageIndexState,v=e.categoryIndexState,p=e.propertyId,y=e.mediaGalleryStartIndexState,f=e.carouselRef,E=c.categorizedImages,h=c.mediaGalleryDialog,b=le(d,2),S=(b[0],b[1]),k=le(g,2),G=k[0],D=k[1],C=le(v,1)[0],T=le(y,2),w=T[0],x=(T[1],le(l.useState(w),2)),P=x[0],O=x[1],R=(0,o.useClickTracker)(),H=l.useMemo((function(){if(C<0)return De(u);var e=E?E[C]:null;return De((null==e?void 0:e.images)||[])}),[C,E,u]),j=l.useMemo((function(){var e={id:"HOT.HIS.PhotoGalleryTrigger",description:"Change image in media gallery",callback:function(e,n){var t,l,a=function(e,n,t){return t.includes("clickRight")||t.includes("scrollRight")?e<n-1?e+1:e:t.includes("clickLeft")||t.includes("scrollLeft")?e>0?e-1:0:t.includes("itemViewed")?parseInt((null==t?void 0:t.split(".")[(null==t?void 0:t.split(".").length)-1])||"0",10):e}(G,H.length,e),i=(null===(l=((null==E||null===(t=E[C])||void 0===t?void 0:t.images)||u)[a])||void 0===l?void 0:l.analytics)||{},r=i.trackingId,o=i.imageId;R(e,n,void 0,Ge(a,r,H.length,o,p,"PDP_FULL_SCREEN_IMAGE_GALLERY"))}};return e}),[R]),Y=l.useMemo((function(){return{id:"HOT.HIS.PhotoGalleryTrigger",description:"Close review gallery dialog",callback:function(e,n){var t,l,a=(null===(l=((null==E||null===(t=E[C])||void 0===t?void 0:t.images)||u)[G])||void 0===l?void 0:l.analytics)||{},i=a.trackingId,r=a.imageId;R(e,n,void 0,Ge(G,i,H.length,r,p,"PDP_FULL_SCREEN_IMAGE_GALLERY"))}}}),[R]),W=l.useCallback((function(e){O(e),C<0?S(e):D(e)}),[C,D,S,O]),K=l.createRef(),$={analytics:j,carouselHeaderText:"MediaGalleryCarousel",carouselName:"MediaGalleryCarousel",itemsVisible:{sm:1,md:1,lg:1,xl:1},onIndexChange:W,pagingInset:!0,pagingPersistent:!0,stretchToFill:!1,navigationIconId:{next:"next-button-media-gallery",prev:"prev-button-media-gallery"},buttonText:{nextButton:"Show next card",prevButton:"Show previous card"},pageBy:1,peek:!1,hideNav:!0};if(!(null==H?void 0:H.length))return null;var Q,q=H.map((function(e,n){return l.createElement(V.N,{key:n,ratio:V.s.R16_9},l.createElement(F.p,{alt:e.alt,src:e.src}))}));return l.createElement(L.K,{isVisible:s,liveAnnounceString:"Full Sheet has opened",type:"full",triggerRef:K,theme:"dark"},l.createElement(A.N,{overlay:!0,navigationContent:{navButtonId:"UitkMediaGalleryImageToolbar",navType:(Q=null==h||null===(t=h.toolbar)||void 0===t||null===(n=t.icon)||void 0===n?void 0:n.id,"arrow_back"===Q?"back":"close"),navIconLabel:null==h||null===(i=h.toolbar)||void 0===i||null===(a=i.icon)||void 0===a?void 0:a.description,onClick:m,onClickAnalytics:Y}}),l.createElement(_.z,{padded:!1},l.createElement(N.v,{direction:"column",blockSize:"full_size"},l.createElement(I.Viewport,null,l.createElement(I.ViewSmall,null,l.createElement(l.Fragment,null,l.createElement(B.t,null,l.createElement(z.l,{padding:{blockstart:"twelve"}},l.createElement(M.wN,ne(ee({},$),{carouselRef:f,fullSheetVisible:s,startIndex:w,stretchToFill:!0}),q))),l.createElement(B.t,null,l.createElement(z.l,{padding:{block:"four",inline:"three"}},je(f,P))))),l.createElement(I.ViewMedium,null,l.createElement(l.Fragment,null,l.createElement(B.t,null,l.createElement(z.l,{padding:{blockstart:"twelve"}},l.createElement(M.wN,ne(ee({},$),{carouselRef:f,fullSheetVisible:s,startIndex:w}),q))),l.createElement(B.t,null,l.createElement(z.l,{padding:{block:"four",inline:"three"}},je(f,P))))),l.createElement(I.ViewLarge,null,l.createElement(B.t,null,l.createElement(z.l,{padding:{block:"four",inline:"three"}},l.createElement(M.wN,ne(ee({},$),{hideNav:!1,fullSheetVisible:s,startIndex:w}),q))))),l.createElement(B.t,null,l.createElement(z.l,{padding:{block:"four",inline:"three"}},l.createElement(N.v,{justifyContent:"space-between",alignItems:"end"},l.createElement(B.t,null,l.createElement(U.b,{theme:"inverse",overflow:"wrap"},null===(r=H[P])||void 0===r?void 0:r.caption)),l.createElement(B.t,null,l.createElement(U.b,{theme:"inverse"},"".concat(String(P+1),"/").concat(String(H.length))))))))))};Ye.displayName="MediaGalleryDialog",Ye.fragment=He;var We=function(e){var n=e.images,t=e.onImageSelected,a=e.columns,i=e.space,r=e.imagesRatio,c=e.focusIndex,u=e.containerRef,s=e.propertyId,m=e.categoryId;return(null==n?void 0:n.length)?l.createElement(Q.EGDSList,{bullet:"no-bullet",spacing:!1},l.createElement(d.EGDSLayoutGrid,{columns:a,space:i},n.map((function(e,a){return l.createElement(d.EGDSLayoutGridItem,{key:a},l.createElement("div",{"data-stid":"image-thumbnail-view-with-label"},e.thumbnailClickAnalytics&&l.createElement(o.IntersectionTracker,{trackOnce:!0,referrerId:"HOT.HIS.ThumbnailImageImpression.".concat(m?"".concat(m,"."):"").concat(a),linkName:"Thumbnail Image Impression",additionalUisPrimeMicroMessages:Ge(a,e.trackingId,n.length,e.imageId,s,"PDP_FULL_IMAGE_GALLERY",m)},l.createElement(q.EGDSMediaGalleryThumbnail,ne(ee({},e),{index:a,imagesRatio:r,onImageSelected:function(){return t(a)},focusIndex:c,containerRef:u}))),!e.thumbnailClickAnalytics&&l.createElement(q.EGDSMediaGalleryThumbnail,ne(ee({},e),{index:a,imagesRatio:r,onImageSelected:function(){return t(a)},focusIndex:c,containerRef:u})),l.createElement(y.EGDSSpacing,{margin:{blockstart:"two",blockend:"three"}},l.createElement(x.EGDSText,{align:"left",overflow:"wrap","aria-hidden":"true"},e.displayCaption))))})))):null};We.displayName="MediaGalleryThumbnailView";var Ke=function(e){var n,t=e.images,a=e.onImageSelected,i=e.propertyId,r=e.categoryId,c=(0,w.useLocalization)().formatText,u=(0,I.useViewportMap)((Z(n={},I.ViewSizes.SMALL,!0),Z(n,I.ViewSizes.MEDIUM,!1),n));if(!(null==t?void 0:t.length))return null;var s=function(e){var n=null==t?void 0:t.length;return n<3?2:n%3==2&&e===n-2?1:e%3==0?2:1},m=function(e){return u?2===s(e)?S.EGDSFigureAspectRatioType.R16_9:S.EGDSFigureAspectRatioType.R3_2:S.EGDSFigureAspectRatioType.R16_9};return l.createElement(d.EGDSLayoutGrid,{columns:2,space:"two"},t.map((function(e,n){return l.createElement(d.EGDSLayoutGridItem,{colSpan:{small:s(n),medium:1},key:n},l.createElement("div",{"data-stid":"multi-image-layout-view"},l.createElement(o.IntersectionTracker,{trackOnce:!0,referrerId:"HOT.HIS.ThumbnailImageImpression.".concat(r?"".concat(r,"."):"").concat(n),linkName:"Thumbnail Image Impression",additionalUisPrimeMicroMessages:Ge(n,e.trackingId,t.length,e.imageId,i,"PDP_FULL_IMAGE_GALLERY",r)},l.createElement(S.EGDSFigure,{ratio:m(n),imageFit:"cover",roundcorner:{medium:["all"]}},l.createElement(S.EGDSImage,{placeholderImage:!0,src:e.src,alt:e.alt}),l.createElement(S.EGDSImageLink,null,l.createElement("button",{onClick:function(){return a(n)},type:"button"},l.createElement("span",{className:"is-visually-hidden"},function(e,n){return(null==e?void 0:e.caption)?c("mediagallery.thumbnailWithCaption",null==e?void 0:e.caption):c("mediagallery.thumbnailWithoutCaption",n+1)}(e,n))))))))})))};Ke.displayName="MultiImageLayoutView";var $e=function(e){var n=e.categories,t=e.images,a=e.onImageClick,i=e.categoryIndexState,r=e.imageIndexState,u=e.propertyId,s=e.showImageNumber,m=void 0!==s&&s,v=e.refGallery,p=e.isSmallView,f=e.refContent,E=e.onPillSelect,h=e.onThumbnailGalleryButtonClick,b=le(r,1)[0],G=le(i,1)[0],C=!(null==n?void 0:n.length)||1===n.length,T=l.useRef(null),w=l.useRef({}),P=l.useRef(null),L=(0,o.useClickTracker)(),_=0!==(0,c.useExperiment)("Multi_image_layout_optimisation_for_gallery_view_Web",!0).exposure.bucket,A=((0,I.useMediaQueries)({viewSizes:I.defaultViewSizes}),I.defaultViewSizes.LARGE,le(l.useState(G>=0||!(null==n?void 0:n.length)?G:0),2)),O=A[0],R=A[1],M=le(l.useState([]),2),V=M[0],F=M[1];l.useEffect((function(){var e=new Array(null==n?void 0:n.length).fill(!1);e[0]=!e[0],F(e)}),[n]);var N=l.useCallback((function(e){if(e){var n=e.linkName,t=e.referrerId;L(t,n)}h&&h()}),[L,h]),B=l.useCallback((function(e){var t,l,a,i,r;if(n){var o,c=e>=0?null===(o=n[e])||void 0===o?void 0:o.categoryName:"";L("HOT.HIS.Gallery.".concat(c,".").concat(e),"Selected gallery tab")}var u=new Array(V.length).fill(!1);u[e]=!0,F(u),R(e),E&&E(e);var s=(null===(t=w.current[e])||void 0===t?void 0:t.offsetTop)||0,m=(null===(a=P.current)||void 0===a||null===(l=a.offsetParent)||void 0===l?void 0:l.clientHeight)||0;null==v||null===(r=v.current)||void 0===r||null===(i=r.offsetParent)||void 0===i||i.scrollTo(0,s-m)}),[R,n,L,V.length,v]),z=l.useCallback((function(e){if(O){var l,i,r,o=(null==n?void 0:n[O])||{},c=o.categoryId,s=o.images,m=void 0===s?[]:s,d=(null===(l=m[e])||void 0===l?void 0:l.analytics)||{},g=d.trackingId,v=d.imageId,p=null===(r=m[e])||void 0===r||null===(i=r.image)||void 0===i?void 0:i.analytics,y=m.length;L("HOT.HIS.ClickThumbnailImage.".concat(c,".").concat(e),"Launch Thumbnail Gallery From Image Click",void 0,Ge(e,g,y,v,u,"PDP_FULL_IMAGE_GALLERY")),p&&L(null==p?void 0:p.referrerId,null==p?void 0:p.linkName),a(e,O)}else{var f,E,h,b=(null===(f=t[e])||void 0===f?void 0:f.analytics)||{},I=b.trackingId,S=b.imageId,k=null===(h=t[e])||void 0===h||null===(E=h.image)||void 0===E?void 0:E.analytics;L("HOT.HIS.ClickThumbnailImage.".concat(e),"Launch Thumbnail Gallery From Image Click",void 0,Ge(e,I,t.length,S,u,"PDP_FULL_IMAGE_GALLERY")),k&&L(null==k?void 0:k.referrerId,null==k?void 0:k.linkName),a(e,O)}}),[O,a,n,L,t,u]),U=l.useCallback((function(e,n,t){return l.createElement(We,{imagesRatio:S.EGDSFigureAspectRatioType.R16_9,images:e,onImageSelected:z,columns:n,space:"three",focusIndex:b,propertyId:u,categoryId:t})}),[z,b,u]),H=l.useCallback((function(e,n){return l.createElement(Ke,{images:e,onImageSelected:z,propertyId:u,categoryId:n})}),[z,b,u]),j=l.useCallback((function(e,n,t,a,i,r,o,c){var u,s=c===O,m=(null==o?void 0:o.button)||{},d=m.analytics,g=m.primary,v=m.accessibility,p=l.createElement(l.Fragment,null,n&&l.createElement(y.EGDSSpacing,{padding:{blockend:"three",small:{inline:_?"three":"unset"},medium:{inline:"unset"}}},l.createElement(x.EGDSHeading,{tag:r,size:i,id:"category-".concat(c)},l.createElement("div",{ref:(u=c,function(e){w.current[u]=e})},n))),g&&l.createElement(y.EGDSSpacing,{margin:{blockend:"three",small:{inline:_?"three":"unset"},medium:{inline:"unset"}}},l.createElement(k.EGDSSecondaryButton,{"data-stid":"category-gallery-button","aria-label":null!=v?v:void 0,size:k.UitkButtonSize.MEDIUM,onClick:function(){return N(d)}},g)),_?H(e,t):U(e,a,t));if(s||C)return l.createElement(y.EGDSSpacing,{padding:{blockend:"three",small:{inline:_?"unset":"three"},medium:{inline:"three"}}},l.createElement("div",null,p))}),[U,O,H]),Y=l.useCallback((function(e,n,t,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return l.createElement(I.Viewport,null,l.createElement(I.ViewSmall,null,j(e,n,t,1,4,"h4",a,i)),l.createElement(I.ViewMedium,null,j(e,n,t,2,3,"h3",a,i)),l.createElement(I.ViewLarge,null,j(e,n,t,2,3,"h3",a,i)))}),[j,2]),Q=l.useCallback((function(e,n){return Y(Ce(e.images),e.categoryName,e.categoryId,e.galleryButton||void 0,n)}),[Y]);if(!(null==n?void 0:n.length)||1===n.length)return Y(Ce(t),void 0,void 0,void 0,0);var q=l.createElement(l.Fragment,null,l.createElement(g.EGDSLayoutPosition,{type:"sticky",position:{top:"zero",zindex:"layer2"},display:"block"},l.createElement(y.EGDSSpacing,{padding:{small:{block:"one",inline:"three"},medium:{block:"one",inline:"three"},large:{block:"three",inline:"three"}}},l.createElement($.LG,{layout:"fullwidth",paddedViewRow:!1,canvasTheme:"primary"},l.createElement("div",{ref:P},l.createElement(K.EGDSScrollable,{direction:"horizontal"},l.createElement(y.EGDSSpacing,{padding:{small:{block:"three"},medium:{block:"three"},large:{block:"one"}}},l.createElement(g.EGDSLayoutPosition,{type:"relative"},l.createElement(D.EGDSLayoutFlex,null,n.map((function(e,n){var t=e.images.length,a=m?"".concat(null==e?void 0:e.categoryName," (").concat(t,")"):null==e?void 0:e.categoryName;return l.createElement(W.EGDSPill,{key:"thumbail-gallery-pill-".concat(n),id:"thumbail-gallery-pill-".concat(n),checked:V[n],onChange:function(){return B(n)},value:null==e?void 0:e.categoryName},a)})))))))))),p?l.createElement(d.EGDSLayoutGrid,{blockSize:"85vb"},l.createElement(K.EGDSScrollable,{direction:"vertical"},l.createElement("div",{ref:f,style:{height:"1px"}}),n.map((function(e,n){return Q(e,n)})))):n.map((function(e,n){return Q(e,n)})));return C?Y(Ce(t)):l.createElement(l.Fragment,null,l.createElement("div",{ref:T}),l.createElement(g.EGDSLayoutPosition,{type:"sticky",position:{top:"zero",zindex:"layer2"},cloneElement:!0},q))},Qe=(0,a.Ps)(ge(),Ve.fragment),qe=function(e){var n,t,a,i,r,c,u,s=e.data,m=e.allImages,d=e.isDialogOpen,p=e.onDialogDismiss,f=e.onImageClick,E=e.categoryIndexState,h=e.imageIndexState,b=e.triggerRef,S=e.propertyId,G=e.onThumbnailGalleryButtonClick,C=s.categorizedImages,T=s.thumbnailGalleryDialog,w=null==T||null===(n=T.primaryButton)||void 0===n?void 0:n.button,L=(0,j.Bz)().scrollTo,_=(0,j.xK)().getTargets,A=(0,Y.YD)({threshold:0}),O=A.ref,R=A.inView,M=A.entry,V=le((0,l.useState)(!1),2),F=(V[0],V[1]),N=le(E,2),B=N[0],z=N[1],U=l.useRef(null),W=(0,o.useClickTracker)();(0,l.useEffect)((function(){!R&&(null==M?void 0:M.target)&&F(!0)}),[R]);var K,$,Q=function(){if(null==w?void 0:w.analytics){var e=w.analytics,n=e.linkName,t=e.referrerId,l="".concat(t,".Thumbnail_Gallery");W(l,n)}setTimeout((function(){p(),setTimeout((function(){var e,n=null==T||null===(e=T.primaryButton)||void 0===e?void 0:e.targetRef;n&&(L(n,[{sectionName:"navigation"}]),setTimeout((function(){var e,t=_([n])[n];null==t||null===(e=t.current)||void 0===e||e.focus({preventScroll:!0})}),300))}),500)}),300)},q=(null==C||null===(t=C.find((function(e){return"all"===e.categoryId})))||void 0===t||t.images.length,w&&l.createElement(y.EGDSSpacing,{padding:{blockend:"two"}},l.createElement(g.EGDSLayoutPosition,{type:"absolute",position:{bottom:"six",left:"center",zindex:"layer1"}},l.createElement(k.EGDSFloatingButton,{onClick:Q,"aria-label":null!==(K=w.accessibility)&&void 0!==K?K:""},w.primary)))),X=w&&l.createElement(k.EGDSPrimaryButton,{"aria-label":null!==($=w.accessibility)&&void 0!==$?$:"",onClick:Q},l.createElement(x.EGDSText,{whiteSpace:"nowrap",theme:"light"},w.primary)),J={id:"HOT.HIS.PhotoGalleryTrigger",description:"Close thumbnail gallery dialog",callback:function(e,n){var t,l,a,i=le(h,1)[0],r=null!==(a=null===(l=C[B])||void 0===l||null===(t=l.images)||void 0===t?void 0:t.length)&&void 0!==a?a:m.length;W(e,n,void 0,Ge(i,void 0,r,void 0,S,"PDP_FULL_IMAGE_GALLERY"))}},Z=T&&l.createElement(H.EGDSToolbar,{navigationContent:{onClick:p,onClickAnalytics:J,navType:null===(i=T.toolbar)||void 0===i||null===(a=i.icon)||void 0===a?void 0:a.id,navIconLabel:null===(c=T.toolbar)||void 0===c||null===(r=c.icon)||void 0===r?void 0:r.description},toolbarTitle:(null===(u=T.toolbar)||void 0===u?void 0:u.title)||"",toolbarActionContent:l.createElement(I.Viewport,null,l.createElement(I.ViewMedium,null,l.createElement(l.Fragment,null,X)))}),te={returnFocusOnClose:!0,isVisible:d,triggerRef:b},ae=function(e){z(e),F(!0)},ie=function(e){return l.createElement($e,{categories:C,images:m,onImageClick:f,categoryIndexState:E,imageIndexState:h,propertyId:S,showImageNumber:!0,refGallery:U,isSmallView:e,refContent:O,onPillSelect:ae,onThumbnailGalleryButtonClick:G})},re=function(e){return l.createElement(l.Fragment,null,Z,l.createElement(v.EGDSSheetContent,{padded:!1},l.createElement("div",{ref:U},ie(e))))};v.EGDSSheet,y.EGDSSpacing,v.EGDSSheetContent,D.EGDSLayoutFlex,D.EGDSLayoutFlexItem,ie(!1);return l.createElement(I.Viewport,null,l.createElement(I.ViewSmall,null,l.createElement(v.EGDSSheet,ne(ee({},te),{type:"full"}),re(!0),q)),l.createElement(I.ViewMedium,null,l.createElement(P.A0,ne(ee({},te),{centeredSheetSize:"xxxlarge",height:1200}),re(!1))))};qe.displayName="ThumbnailGalleryDialog",qe.fragment=Qe;var Xe=function(e,n){var t=function(e){return(0,l.useMemo)((function(){var n,t;return(null==e||null===(t=e.categorizedImages)||void 0===t||null===(n=t.find((function(n){return n.categoryId===e.categoryIdAll})))||void 0===n?void 0:n.images)||[]}),[e])}(e);return(0,l.useMemo)((function(){if(!(null==n?void 0:n.length)||!t.length)return t;var e=t.map((function(e){var n,t,l;return ne(ee({},e),{baseUrl:null!==(l=(null!==(t=null===(n=e.lowResImage)||void 0===n?void 0:n.url)&&void 0!==t?t:e.image.url).split("?")[0])&&void 0!==l?l:""})})),l=n.map((function(e){return ne(ee({},e),{baseUrl:e.url.split("?")[0]})})),a=l.reduce((function(e,n,t){return ne(ee({},e),Z({},n.baseUrl,t))}),{}),i=l.reduce((function(e,n){return ne(ee({},e),Z({},n.baseUrl,n))}),{}),r=ie(e.filter((function(e){return i[e.baseUrl]})).map((function(e){var n,t;return ne(ee({},e),{image:ne(ee({},e.image),{url:(null===(n=i[e.baseUrl])||void 0===n?void 0:n.url)||e.image.url}),lowResImage:ne(ee({},e.lowResImage),{url:(null===(t=i[e.baseUrl])||void 0===t?void 0:t.url)||""})})}))).sort((function(e,n){return(a[e.baseUrl]||-1)-(a[n.baseUrl]||-1)})).map((function(e){e.baseUrl;return te(e,["baseUrl"])})),o=t.filter((function(n,t){var l,a;return!i[null!==(a=null===(l=e[t])||void 0===l?void 0:l.baseUrl)&&void 0!==a?a:""]}));return ie(r).concat(ie(o))}),[t,n])},Je=(0,a.Ps)(ve(),ze.fragment,Ne.fragment,Ye.fragment,qe.fragment,Pe.fragment),Ze=function(e){var n,t,a,i,r,o,s,m,S=e.propertyId,k=e.data,G=e.placeholderData,D=e.className,C=e.shoppingContext,T=e.travelSearchCriteria,w=e.onClickSeeAllReviewsButton,x=le((0,E.useDialog)("media-gallery","pwaDialogNested"),3),P=x[0],L=x[1],_=x[2],A=le((0,E.useDialog)("thumbnail-gallery","pwaThumbnailDialog"),3),O=A[0],R=A[1],M=A[2],V=le((0,E.useDialog)("aerial-view","pwaAerialDialog"),3),F=V[0],N=V[1],B=V[2],z=l.useRef(null),U=l.useRef(null),H=l.useState(0),j=l.useState(-1),Y=l.useState(0),W=l.useState(0),K=le(H,2)[1],$=le(j,2)[1],Q=le(Y,2)[1],q=le(W,2)[1],X=le(l.useState(""),2),Z=X[0],ne=X[1],te=Xe(k,G),ae=(0,h.Iw)(Ee),ie=(0,l.useContext)(Se).useControlBehaviour,re=(s=(0,b.useLocation)(),(0,l.useMemo)((function(){return new URLSearchParams(s.search)}),[s.search])),ce=(m=(0,b.useHistory)(),(0,l.useCallback)((function(e){var n=new URLSearchParams(m.location.search);n.delete(e),m.replace("".concat(m.location.pathname,"?").concat(n))}),[m])),ue=(0,c.useExperiment)("Adaptex_campaign_PDP_mosaic_for_large_screens").exposure.bucket,se=(0,c.useExperiment)("Adaptex_campaign_PDP_mosaic_for_small_screens").exposure.bucket,me=(0,l.useContext)(ye).isRandomAccessOne;l.useEffect((function(){if((1===ue||1===se)&&re.get("imageIndex")){var e=Number(re.get("imageIndex"));K(e),ce("imageIndex")}}),[ue,se,ce,re,K]);var de,ge,ve=l.useCallback((function(e){K(e),$(-1),z.current=document.activeElement,R.openDialog()}),[R,$,K]),pe=l.useCallback((function(e){window.open(e)}),[]),fe=l.useCallback((de=function(e){return oe(this,(function(n){return Z||function(e){return fetch("https://aerialview.googleapis.com/v1/videos:lookupVideo?key=".concat("AIzaSyABOFQNLMiTVN0AG3eWNmspVfVC8gNda68","&videoId=").concat(e),{method:"GET",headers:new Headers({"Content-Type":"application/json",Referer:"https://www.expedia.com/"})}).then((function(e){return e.json()}))}(e).then((function(e){var n,t;(null==e||null===(n=e.uris)||void 0===n?void 0:n.MP4_MEDIUM)?(ne(e.uris.MP4_MEDIUM.landscapeUri),ae.VIDEO_SUCCESS.log(he+S)):(ae.VIDEO_FAILED.log({message:be+S,error:null==e||null===(t=e.error)||void 0===t?void 0:t.message}),ne("error"))})),N.openDialog(),[2]}))},ge=function(){var e=this,n=arguments;return new Promise((function(t,l){var a=de.apply(e,n);function i(e){J(a,t,l,i,r,"next",e)}function r(e){J(a,t,l,i,r,"throw",e)}i(void 0)}))},function(e){return ge.apply(this,arguments)}),[N,ne]),Ie=null==k||null===(n=k.galleryButtons)||void 0===n?void 0:n.find((function(e){var n;return"visibility"===(null===(n=e.icon)||void 0===n?void 0:n.id)})),ke=null==Ie||null===(t=Ie.icon)||void 0===t?void 0:t.description,Ge=l.useCallback((function(){$(-1),R.openDialog()}),[R,$]),De=l.useCallback((function(e,n){U.current=document.activeElement,$(n),Q(e),n<0&&K(e),q(e),L.openDialog()}),[$,Q,L,K,q]),Ce=l.useCallback((function(){var e=document.activeElement;z.current=e,K(0),R.openDialog()}),[R,K]),Te=l.useCallback((function(){R.closeDialog(),setTimeout((function(){var e;null===(e=z.current)||void 0===e||e.focus()}),0)}),[R]),we=l.useCallback((function(){L.closeDialog(),setTimeout((function(){var e;null===(e=U.current)||void 0===e||e.focus()}),0)}),[L]),xe=l.useCallback((function(){N.closeDialog(),setTimeout((function(){var e;null===(e=z.current)||void 0===e||e.focus()}))}),[N]),Le=l.useRef(null);if(!k||!te.length)return null;var _e={imageIndexState:H,categoryImageIndexState:Y,categoryIndexState:j},Ae=ee({onTriggerClick:Ce,onVirtualTourClick:pe,onAerialViewClick:fe,thumbnailDialogTriggerTitle:null==k||null===(i=k.thumbnailGalleryDialog)||void 0===i||null===(a=i.trigger)||void 0===a?void 0:a.value,thumbnailDialogTriggerAccessibilityLabel:null==k||null===(o=k.thumbnailGalleryDialog)||void 0===o||null===(r=o.trigger)||void 0===r?void 0:r.accessibilityLabel,data:k,propertyId:S,allImages:te},_e),Oe=l.createElement(g.EGDSLayoutPosition,{type:"relative"},l.createElement(d.EGDSLayoutGrid,{blockSize:"30vb"},l.createElement(p.EGDSBlockSkeleton,null))),Re=function(e){var n=(0,u.RI)({inputs:{featureId:"image_mosaic_adaptex",productIdentifier:{id:S,type:u.fT.PROPERTY_ID,shoppingContext:C,travelSearchCriteria:T}},batchKey:"default-product-details-experience-batch-key",loadingPlaceholder:Oe});return ie?e:n},Me=function(e){return l.createElement(ze,ee({onImageClick:function(e){return ve(e)},imagesToShow:e},Ae))},Ve=l.createElement(Ne,ee({onImageClick:Ge},Ae)),Fe=function(e){return l.createElement(l.Fragment,null,l.createElement(c.Experiment,{name:"Adaptex_campaign_PDP_mosaic_for_large_screens"},l.createElement(c.ExperimentControl,null,Me(e)),l.createElement(c.ExperimentVariant,{bucket:1},Re(Me(e)))),l.createElement(Pe,{data:k,onThumbnailGalleryClick:Ae.onTriggerClick,onVirtualTourClick:pe,onAerialViewClick:fe,thumbnailButtonText:Ae.thumbnailDialogTriggerTitle,thumbnailDialogTriggerAccessibilityLabel:Ae.thumbnailDialogTriggerAccessibilityLabel,propertyId:S}))},Be=l.createElement(c.Experiment,{name:"Adaptex_campaign_PDP_mosaic_for_small_screens"},l.createElement(c.ExperimentControl,null,Ve),l.createElement(c.ExperimentVariant,{bucket:1},Re(Ve),!ie&&l.createElement(Pe,{data:k,onThumbnailGalleryClick:Ae.onTriggerClick,onVirtualTourClick:pe,onAerialViewClick:fe,thumbnailButtonText:Ae.thumbnailDialogTriggerTitle,thumbnailDialogTriggerAccessibilityLabel:Ae.thumbnailDialogTriggerAccessibilityLabel,propertyId:S})));return l.createElement("div",{className:D},me?l.createElement(l.Fragment,null,l.createElement(I.Viewport,null,l.createElement(I.ViewSmall,null,Ve),l.createElement(I.ViewMedium,null,l.createElement(l.Fragment,null,Me(3),l.createElement(Pe,{data:k,onThumbnailGalleryClick:Ae.onTriggerClick,onVirtualTourClick:pe,onAerialViewClick:fe,thumbnailButtonText:Ae.thumbnailDialogTriggerTitle,thumbnailDialogTriggerAccessibilityLabel:Ae.thumbnailDialogTriggerAccessibilityLabel,propertyId:S})))),l.createElement(f.EGDSThemeProvider,{config:{lightMode:{colorTheme:"bright-1"}},isColorThemeContainer:!0},l.createElement(y.EGDSSpacing,{padding:"half"},l.createElement("div",{"data-stid":"luxury-ribbon"})))):l.createElement(I.Viewport,null,l.createElement(I.ViewSmall,null,Be),l.createElement(I.ViewMedium,null,Fe(3)),l.createElement(I.ViewLarge,null,Fe(5))),l.createElement(v.EGDSSheetTransition,{isVisible:O},l.createElement(M,null,l.createElement(qe,ee({allImages:te,data:k,isDialogOpen:O,onDialogDismiss:Te,onImageClick:De,triggerRef:z,propertyId:S,onThumbnailGalleryButtonClick:w},_e)))),l.createElement(v.EGDSSheetTransition,{isVisible:P},l.createElement(_,null,l.createElement(Ye,ee({allImages:te,data:k,isDialogOpen:P,onDialogDismiss:we,propertyId:S,mediaGalleryStartIndexState:W,carouselRef:Le},_e)))),l.createElement(v.EGDSSheetTransition,{isVisible:F},l.createElement(B,null,l.createElement(Ue,{isDialogOpen:F,onDialogDismiss:xe,triggerRef:z,aerialViewLandscape:Z,aerialViewDescription:ke}))))};Ze.displayName="ProductGalleryImageContainer",Ze.fragment=Je;var en=function(e){switch(e){case 1:return S.EGDSFigureAspectRatioType.R3_2;case 2:return S.EGDSFigureAspectRatioType.R1_1;default:return S.EGDSFigureAspectRatioType.R16_9}},nn=function(e){var n=e.images,t=function(){var e=le((0,l.useState)(!1),2),n=e[0],t=e[1];return(0,l.useEffect)((function(){t(!0)}),[]),n}(),a=(0,l.useContext)(ye).isRandomAccessOne;return l.createElement(l.Fragment,null,t?l.createElement(an,{images:n,isRandomAccessOne:a}):l.createElement(rn,{images:n,isRandomAccessOne:a}))},tn=function(e){var n=e.additionalImage,t=e.className,a=e.style,i=e.isRandomAccessOne,r=(0,c.useExperiment)("mWeb_larger_image_for_top_of_PDP_gallery").exposure;return l.createElement(S.EGDSFigure,{ratio:i?S.EGDSFigureAspectRatioType.R3_2:en(r.bucket),className:t,style:a},l.createElement(S.EGDSImage,{placeholderImage:!0,src:null==n?void 0:n.url,alt:null==n?void 0:n.description,additionalProps:{fetchPriority:(null==n?void 0:n.url)?"high":void 0}}))},ln=function(e){var n=function(e){var n=e.images,t=e.isRandomAccessOne;return l.createElement(I.Viewport,null,l.createElement(I.ViewSmall,null,l.createElement(tn,{additionalImage:null==n?void 0:n[0]})),l.createElement(I.ViewMedium,null,l.createElement(d.EGDSLayoutGrid,{rows:2,columns:3,space:"half"},Array.from(Array(3)).map((function(e,a){return l.createElement(d.EGDSLayoutGridItem,{rowSpan:0===a?2:1,colSpan:0===a?2:1,key:"gallery-placeholder-".concat(a)},l.createElement(tn,{additionalImage:null==n?void 0:n[a],isRandomAccessOne:t}))})))),l.createElement(I.ViewLarge,null,l.createElement(d.EGDSLayoutGrid,{rows:2,columns:4,space:"half"},Array.from(Array(t?3:5)).map((function(e,a){return l.createElement(d.EGDSLayoutGridItem,{rowSpan:0===a?2:1,colSpan:0===a?2:1,key:"gallery-placeholder-".concat(a)},l.createElement(tn,{additionalImage:null==n?void 0:n[a],isRandomAccessOne:t}))})))))};return n.displayName=e,n},an=ln("CsrPlaceholder"),rn=ln("SsrPlaceholder"),on=(0,a.Ps)(pe(),Ze.fragment),cn=function(e){var n,t,a,d,g,v,p,y=e.inputs,f=e.skipSsr,E=e.placeholderData,h=e.batchKey,b=e.onClickSeeAllReviewsButton,I=(0,r.v)().context,S=(0,m.s0)().publishSignal,k=ne(ee({},y),{context:I}),G=(0,s.gf)(),D=(0,c.useExperiment)("Luxury_PDP_Feature_Gate_Web").exposure.bucket,C={context:I,featureId:"standout-stays",productIdentifier:{id:y.productIdentifier.id,type:u.fT.PROPERTY_ID}},T=(0,i.a)(u.zk,{variables:C,ssr:!f,errorPolicy:"all",skip:0===D}).data;(null==T||null===(t=T.randomAccessOne)||void 0===t||null===(n=t.mapping)||void 0===n?void 0:n.length)&&S({type:"LUXURY_PROPERTY",payload:{message:!0}});var w=(0,i.a)(on,{context:{batchKey:null!=h?h:"default-product-details-experience-batch-key"},variables:k,ssr:!f,errorPolicy:"all",skip:null==G||null===(a=G.product)||void 0===a?void 0:a.productGallery}),x=w.data,P=w.loading,L=(null==G||null===(d=G.product)||void 0===d?void 0:d.productGallery)||(null==x?void 0:x.productGallery),_=null==x||null===(p=x.productGallery)||void 0===p||null===(v=p.categorizedImages)||void 0===v||null===(g=v.find((function(e){return"Guest photos"===e.categoryId})))||void 0===g?void 0:g.clientSideAnalytics,A=l.createElement(Ze,{propertyId:y.productIdentifier.id,data:L,placeholderData:E,shoppingContext:y.productIdentifier.shoppingContext,travelSearchCriteria:y.productIdentifier.travelSearchCriteria,onClickSeeAllReviewsButton:b});return l.createElement(fe,{data:T},P&&l.createElement(nn,{images:E}),_?l.createElement(o.IntersectionTracker,{referrerId:_.referrerId,linkName:_.linkName,trackOnce:!0},A):A)};cn.displayName="sharedui-ProductGallery"}}]);
//# sourceMappingURL=shared-ui-retail-product-gallery.b0744d4e5ac7e6066eec.js.map