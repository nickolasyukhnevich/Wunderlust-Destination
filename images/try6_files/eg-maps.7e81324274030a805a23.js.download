/*@license For license information please refer to eg-maps.licenses.txt*/
(self.webpackChunkblossom_flex_ui=self.webpackChunkblossom_flex_ui||[]).push([[87687],{90439:function(e){window,e.exports=function(){var e={736:function(e,t,n){e.exports=function(){var e={712:function(e,t){var n=t.O={};n.read=function(e,t){return e.readFields(n._readField,{dictionary:null,content:null},t)},n._readField=function(e,t,r){1===e?t.dictionary=n.Dictionary.read(r,r.readVarint()+r.pos):2===e&&(t.content=n.Content.read(r,r.readVarint()+r.pos))},n.Dictionary={},n.Dictionary.read=function(e,t){return e.readFields(n.Dictionary._readField,{constants:[]},t)},n.Dictionary._readField=function(e,t,n){1===e&&t.constants.push(n.readString())},n.Feature={},n.Feature.read=function(e,t){return e.readFields(n.Feature._readField,{type:0,id:"",latitude:0,longitude:0,name:"",classifiers:[]},t)},n.Feature._readField=function(e,t,n){1===e?t.type=n.readVarint():2===e?t.id=n.readString():3===e?t.latitude=n.readVarint(!0):4===e?t.longitude=n.readVarint(!0):5===e?t.name=n.readString():6===e&&n.readPackedVarint(t.classifiers,!0)},n.Feature.Type={UNKNOWN:{value:0,options:{}},PLACE:{value:1,options:{}},PROPERTY:{value:2,options:{}}},n.Content={},n.Content.read=function(e,t){return e.readFields(n.Content._readField,{features:[]},t)},n.Content._readField=function(e,t,r){1===e&&t.features.push(n.Feature.read(r,r.readVarint()+r.pos))}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){r.r(i),r.d(i,{EGTSCodec:function(){return l}});var e=n(997),t=r.n(e),o=r(712);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r,i;return n=e,(r=[{key:"decode",value:function(e){var n=this;return new Promise((function(r){var i,s=new(t())(e),u=o.O.read(s),l=[],c=a(u.content.features);try{for(c.s();!(i=c.n()).done;){var f=i.value;l.push({id:f.id,type:n._getType(f.type),lat:f.latitude/1e6-90,lng:f.longitude/1e6-180,name:f.name,qualifiers:f.classifiers.map((function(e){return u.dictionary.constants[e]}))})}}catch(e){c.e(e)}finally{c.f()}r(l)}))}},{key:"_getType",value:function(e){for(var t in o.O.Feature.Type)if(o.O.Feature.Type[t].value===e)return t.toLowerCase()}}])&&u(n.prototype,r),i&&u(n,i),e}()}(),i}()},723:function(){},744:function(e){e.exports=function(){function e(o,a){if(!(this instanceof e))return new e(o,a);a=Object.assign({},n,a);var s=Math.pow(10,a.precision);this.intValue=o=t(o,a),this.value=o/s,a.increment=a.increment||1/s,a.groups=a.useVedic?i:r,this.s=a,this.p=s}function t(t,n){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=n.decimal,o=n.errorOnInvalid,a=n.fromCents,s=Math.pow(10,n.precision),u=t instanceof e;if(u&&a)return t.intValue;if("number"==typeof t||u)i=u?t.value:t;else if("string"==typeof t)o=new RegExp("[^-\\d"+i+"]","g"),i=new RegExp("\\"+i,"g"),i=(i=t.replace(/\((.*)\)/,"-$1").replace(o,"").replace(i,"."))||0;else{if(o)throw Error("Invalid Input");i=0}return a||(i=(i*s).toFixed(4)),r?Math.round(i):i}var n={symbol:"$",separator:",",decimal:".",errorOnInvalid:!1,precision:2,pattern:"!#",negativePattern:"-!#",format:function(e,t){var n=t.pattern,r=t.negativePattern,i=t.symbol,o=t.separator,a=t.decimal;t=t.groups;var s=(""+e).replace(/^-/,"").split("."),u=s[0];return s=s[1],(0<=e.value?n:r).replace("!",i).replace("#",u.replace(t,"$1"+o)+(s?a+s:""))},fromCents:!1},r=/(\d)(?=(\d{3})+\b)/g,i=/(\d)(?=(\d\d)+\d\b)/g;return e.prototype={add:function(n){var r=this.s,i=this.p;return e((this.intValue+t(n,r))/(r.fromCents?1:i),r)},subtract:function(n){var r=this.s,i=this.p;return e((this.intValue-t(n,r))/(r.fromCents?1:i),r)},multiply:function(t){var n=this.s;return e(this.intValue*t/(n.fromCents?1:Math.pow(10,n.precision)),n)},divide:function(n){var r=this.s;return e(this.intValue/t(n,r,!1),r)},distribute:function(t){var n=this.intValue,r=this.p,i=this.s,o=[],a=Math[0<=n?"floor":"ceil"](n/t),s=Math.abs(n-a*t);for(r=i.fromCents?1:r;0!==t;t--){var u=e(a/r,i);0<s--&&(u=u[0<=n?"add":"subtract"](1/r)),o.push(u)}return o},dollars:function(){return~~this.value},cents:function(){return~~(this.intValue%this.p)},format:function(e){var t=this.s;return"function"==typeof e?e(this,t):t.format(this,Object.assign({},t,e))},toString:function(){var e=this.s,t=e.increment;return(Math.round(this.intValue/this.p/t)*t).toFixed(e.precision)},toJSON:function(){return this.value}},e}()},164:function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?i-1:0,d=n?-1:1,h=e[t+f];for(f+=d,o=h&(1<<-c)-1,h>>=-c,c+=s;c>0;o=256*o+e[t+f],f+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=d,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=l}return(h?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=c?(s=0,a=c):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;e[n+h]=255&a,h+=p,a/=256,l-=8);e[n+h-p]|=128*y}},997:function(e,t,n){e.exports=i;var r=n(164);function i(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,a=1/o,s="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function u(e){return e.type===i.Bytes?e.readVarint()+e.pos:e.pos+1}function l(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function c(e,t,n){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=e;i--)n.buf[i+r]=n.buf[i]}function f(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function d(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function h(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function p(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function y(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function v(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function g(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function m(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function b(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function k(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function w(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function P(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,e(i,t,this),this.pos===o&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=k(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=P(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=k(this.buf,this.pos)+k(this.buf,this.pos+4)*o;return this.pos+=8,e},readSFixed64:function(){var e=k(this.buf,this.pos)+P(this.buf,this.pos+4)*o;return this.pos+=8,e},readFloat:function(){var e=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,r=this.buf;return t=127&(n=r[this.pos++]),n<128?t:(t|=(127&(n=r[this.pos++]))<<7,n<128?t:(t|=(127&(n=r[this.pos++]))<<14,n<128?t:(t|=(127&(n=r[this.pos++]))<<21,n<128?t:function(e,t,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return l(e,r,t);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return l(e,r,t);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return l(e,r,t);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return l(e,r,t);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return l(e,r,t);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return l(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&s?function(e,t,n){return s.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){for(var r="",i=t;i<n;){var o,a,s,u=e[i],l=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c>n)break;1===c?u<128&&(l=u):2===c?128==(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)<=127&&(l=null):3===c?(o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&((l=(15&u)<<12|(63&o)<<6|63&a)<=2047||l>=55296&&l<=57343)&&(l=null)):4===c&&(o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,c=1):l>65535&&(l-=65536,r+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),r+=String.fromCharCode(l),i+=c}return r}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==i.Bytes)return e.push(this.readVarint(t));var n=u(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==i.Bytes)return e.push(this.readSVarint());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==i.Bytes)return e.push(this.readBoolean());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==i.Bytes)return e.push(this.readFloat());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==i.Bytes)return e.push(this.readDouble());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed64());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed64());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===i.Varint)for(;this.buf[this.pos++]>127;);else if(t===i.Bytes)this.pos=this.readVarint()+this.pos;else if(t===i.Fixed32)this.pos+=4;else{if(t!==i.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),w(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),w(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),w(this.buf,-1&e,this.pos),w(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),w(this.buf,-1&e,this.pos),w(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,r;if(e>=0?(n=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,r=r+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos]=127&e}(n,0,t),function(e,t){var n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var r,i,o=0;o<t.length;o++){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):i=r;continue}if(r<56320){e[n++]=239,e[n++]=191,e[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(e[n++]=239,e[n++]=191,e[n++]=189,i=null);r<128?e[n++]=r:(r<2048?e[n++]=r>>6|192:(r<65536?e[n++]=r>>12|224:(e[n++]=r>>18|240,e[n++]=r>>12&63|128),e[n++]=r>>6&63|128),e[n++]=63&r|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&c(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),r.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),r.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var r=this.pos-n;r>=128&&c(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,n){this.writeTag(e,i.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,y,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,v,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,g,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,b,t)},writeBytesField:function(e,t){this.writeTag(e,i.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,i.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,i.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,i.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},597:function(e){!function(){var t=function(e){return(e="number"==typeof e?{precision:e}:e||{}).precision=e.precision||5,e.factor=e.factor||Math.pow(10,e.precision),e.dimension=e.dimension||2,e},n={encode:function(e,n){n=t(n);for(var r=[],i=0,o=e.length;i<o;++i){var a=e[i];if(2===n.dimension)r.push(a.lat||a[0]),r.push(a.lng||a[1]);else for(var s=0;s<n.dimension;++s)r.push(a[s])}return this.encodeDeltas(r,n)},decode:function(e,n){n=t(n);for(var r=this.decodeDeltas(e,n),i=[],o=0,a=r.length;o+(n.dimension-1)<a;){for(var s=[],u=0;u<n.dimension;++u)s.push(r[o++]);i.push(s)}return i},encodeDeltas:function(e,n){n=t(n);for(var r=[],i=0,o=e.length;i<o;)for(var a=0;a<n.dimension;++a,++i){var s=e[i].toFixed(n.precision),u=s-(r[a]||0);r[a]=s,e[i]=u}return this.encodeFloats(e,n)},decodeDeltas:function(e,n){n=t(n);for(var r=[],i=this.decodeFloats(e,n),o=0,a=i.length;o<a;)for(var s=0;s<n.dimension;++s,++o)i[o]=Math.round((r[s]=i[o]+(r[s]||0))*n.factor)/n.factor;return i},encodeFloats:function(e,n){n=t(n);for(var r=0,i=e.length;r<i;++r)e[r]=Math.round(e[r]*n.factor);return this.encodeSignedIntegers(e)},decodeFloats:function(e,n){n=t(n);for(var r=this.decodeSignedIntegers(e),i=0,o=r.length;i<o;++i)r[i]/=n.factor;return r},encodeSignedIntegers:function(e){for(var t=0,n=e.length;t<n;++t){var r=e[t];e[t]=r<0?~(r<<1):r<<1}return this.encodeUnsignedIntegers(e)},decodeSignedIntegers:function(e){for(var t=this.decodeUnsignedIntegers(e),n=0,r=t.length;n<r;++n){var i=t[n];t[n]=1&i?~(i>>1):i>>1}return t},encodeUnsignedIntegers:function(e){for(var t="",n=0,r=e.length;n<r;++n)t+=this.encodeUnsignedInteger(e[n]);return t},decodeUnsignedIntegers:function(e){for(var t=[],n=0,r=0,i=0,o=e.length;i<o;++i){var a=e.charCodeAt(i)-63;n|=(31&a)<<r,a<32?(t.push(n),n=0,r=0):r+=5}return t},encodeSignedInteger:function(e){return e=e<0?~(e<<1):e<<1,this.encodeUnsignedInteger(e)},encodeUnsignedInteger:function(e){for(var t,n="";e>=32;)t=63+(32|31&e),n+=String.fromCharCode(t),e>>=5;return t=e+63,n+String.fromCharCode(t)}};if("object"==typeof e.exports&&(e.exports=n),"object"==typeof L){L.Polyline.prototype.fromEncoded||(L.Polyline.fromEncoded=function(e,t){return L.polyline(n.decode(e),t)}),L.Polygon.prototype.fromEncoded||(L.Polygon.fromEncoded=function(e,t){return L.polygon(n.decode(e),t)});var r={encodePath:function(){return n.encode(this.getLatLngs())}};L.Polyline.prototype.encodePath||L.Polyline.include(r),L.Polygon.prototype.encodePath||L.Polygon.include(r),L.PolylineUtil=n}}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return function(){n.r(r),n.d(r,{Animation:function(){return o},BaseMap:function(){return bs},BrowserUtils:function(){return i},Cache:function(){return Lr},ConfigHelper:function(){return Bs},ConfigLoader:function(){return ur},ConsoleLogger:function(){return Kn},EGMap:function(){return nl},EventTypes:function(){return fi},EventsManager:function(){return di},Geo:function(){return a},HtmlUtils:function(){return e},I18n:function(){return dr},IconUtils:function(){return s},KeyboardFeatures:function(){return go},KeyboardListeners:function(){return Io},Labels:function(){return l},Level:function(){return Un},Logger:function(){return zn},MarkerUtils:function(){return u},TilesLoader:function(){return Yu},Utils:function(){return t},debugOptions:function(){return tr},defaultConfig:function(){return Ks},defaultIcons:function(){return zs},i18nKeys:function(){return Di},icons:function(){return zs},identifyUpdates:function(){return Rs},newLogger:function(){return Vn},newMapData:function(){return ms},ttlCache:function(){return xr}});var e={};n.r(e),n.d(e,{addClass:function(){return st},addClasses:function(){return ut},addNewCssStyle:function(){return Ot},anyChildrenMatching:function(){return pe},anyChildrenWithAriaRoleDescription:function(){return fe},anyChildrenWithClasses:function(){return le},areRectPointsAndCircleIntersecting:function(){return nt},areRectsIntersecting:function(){return et},changeImgSrc:function(){return We},changeSpanTextContent:function(){return ne},changeStyles:function(){return ze},changeTextNodeContent:function(){return re},childNodesAsArray:function(){return ae},childrenAsArray:function(){return oe},clearAriaLabel:function(){return $e},clearStyle:function(){return pt},createButton:function(){return Me},createCheckbox:function(){return Fe},createDiv:function(){return we},createH1:function(){return xe},createH2:function(){return Oe},createHtml:function(){return ee},createImg:function(){return Se},createInput:function(){return ke},createLabel:function(){return Le},createLi:function(){return Ce},createSpan:function(){return _e},createTextNode:function(){return te},createUl:function(){return Pe},detachElement:function(){return me},documentIsDefined:function(){return ie},eltAsString:function(){return J},findChildIndex:function(){return he},getClasses:function(){return at},getDistanceBetweenPoints:function(){return kt},getDistanceToMoveRect:function(){return yt},getFirstChildWithAriaRoleDescription:function(){return de},getFirstChildWithClasses:function(){return ce},getIntersection:function(){return Pt},getMaxRect:function(){return gt},getMovedRect:function(){return mt},getRect:function(){return vt},getRectCenter:function(){return bt},getRectIntersectionCandidates:function(){return wt},hasAriaLabel:function(){return Ie},hasClass:function(){return Je},insertChild:function(){return Ct},intersectionBottomSide:function(){return xt},intersectionLeftSide:function(){return _t},intersectionRightSide:function(){return Lt},intersectionTopSide:function(){return Mt},inverseClass:function(){return tt},isAnHtmlElement:function(){return Y},isDisplayed:function(){return qe},isPointIntersectingCircle:function(){return rt},reattachElement:function(){return be},removeAllChildren:function(){return ye},removeAriaLabel:function(){return Ae},removeAriaLive:function(){return Be},removeChildById:function(){return ge},removeClass:function(){return lt},removeClasses:function(){return ct},removeElementById:function(){return ve},replaceClasses:function(){return ft},replaceClassesAndStyle:function(){return ht},replaceStyle:function(){return dt},setAriaHidden:function(){return De},setAriaLabel:function(){return Ee},setAriaLabelledBy:function(){return Te},setAriaLivePolite:function(){return je},setButtonRole:function(){return Ue},setDisplay:function(){return Ke},setDisplayNone:function(){return Ze},setPosition:function(){return Xe},setPositionAttributes:function(){return Ye},setPresentationRole:function(){return Ne},setRole:function(){return Re},setTabIndex:function(){return Ve},setWidthAndHeight:function(){return Qe},setZIndex:function(){return Ge},switchClass:function(){return it},switchClasses:function(){return ot},unsetDisplayNone:function(){return He}});var t={};n.r(t),n.d(t,{arrayEquals:function(){return Yt},camelCaseToKebabCase:function(){return ln},camelCaseToSnakeCase:function(){return fn},capitalizeString:function(){return Rt},chunkArray:function(){return Kt},cleanCoordinatesArray:function(){return qt},compareBounds:function(){return $t},convertToCurrency:function(){return Cn},countDecimals:function(){return Xt},fastHash:function(){return sn},firstDefinedKey:function(){return Dt},firstDefinedValue:function(){return Tt},firstDefinedValueAndKey:function(){return jt},getBalancedRate:function(){return bn},getMinPrice:function(){return en},getMultiLineLabelText:function(){return kn},getPaddedZoomAndCenter:function(){return gn},getPaddingPixels:function(){return yn},hashCode:function(){return Pn},identifyDecimalSeparatorForPrice:function(){return Jt},intToHexString:function(){return on},isArray:function(){return Ut},isObject:function(){return Nt},kebabCaseToCamelCase:function(){return un},listHashKeysSorted:function(){return tn},opacityDecimalToHex:function(){return rn},parseClientPadding:function(){return vn},randomAlphaNumeric:function(){return an},removeDuplicates:function(){return Zt},round:function(){return Gt},roundLatLng:function(){return Qt},roundLatOrLng:function(){return Wt},roundZoom:function(){return Ht},snakeCaseToCamelCase:function(){return cn},sortDeeplyObjectAndArray:function(){return zt},sortHashKeys:function(){return pn},splitLabelTextIntoLines:function(){return mn},stringify:function(){return Vt},transformHistoricalBboxOutput:function(){return dn},undefNullEmpty:function(){return Bt},verifyKeyIsLegal:function(){return wn}});var i={};n.r(i),n.d(i,{getCookieValue:function(){return Yn},promiseAllSettled:function(){return $n},timeoutFetch:function(){return Xn}});var o={};n.r(o),n.d(o,{bounce:function(){return lr}});var a={};n.r(a),n.d(a,{addMeterToLat:function(){return Hr},areBoundsCrossingDateLine:function(){return Ur},areCoordinatesCrossingDateLine:function(){return Nr},areLongitudesCrossingDateLine:function(){return Rr},computeTileDistance:function(){return Zr},computeTilesIds:function(){return Dr},computeZoomFromBBox:function(){return Ar},convertGeoJsonPolygonToPath:function(){return qr},directionFromOrigin:function(){return zr},furthestLatOrLong:function(){return Vr}});var s={};n.r(s),n.d(s,{areIconsDifferent:function(){return ti},ensureImageIsLoaded:function(){return ei},events:function(){return Qr},extractImgSourcesFromIcons:function(){return $r},flatIcons:function(){return Jr},flatSuppIcons:function(){return Yr},preloadIcons:function(){return Xr}});var u={};n.r(u),n.d(u,{bounceMarker:function(){return su},createBasicTextMarker:function(){return Ys},createCornerIcons:function(){return lu},createDoubleClickEventCanceller:function(){return gu},createImageIcon:function(){return Xs},createInnerIcons:function(){return cu},haveCornerIconsChanged:function(){return du},haveInnerIconsChanged:function(){return hu},identifyCornerIcons:function(){return yu},identifyInnerIcons:function(){return vu},identifyMarkerLabelsProperties:function(){return eu},identifyMarkerProperties:function(){return tu},refreshLabel:function(){return iu},setAccessibilityFields:function(){return ru},setMarkerIcons:function(){return ou},setMarkerZIndex:function(){return au},switchAriaLabel:function(){return nu}});var l={};n.r(l),n.d(l,{createLabels:function(){return Lu},getLabelVisibilityConfigByFeatureKeyAndZoom:function(){return _u},getRectOfMarkerLabel:function(){return Fu},hideTextLabelsForZoomLevel:function(){return Mu},isTextLabelHiddenAtZoomLevel:function(){return Cu},textLabelHiddenCssClass:function(){return ku},textSubLabelHiddenCssClass:function(){return wu}}),n(723);var c=6371008.8,f={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*c,kilometers:6371.0088,kilometres:6371.0088,meters:c,metres:c,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:c/1852,radians:1,yards:6967335.223679999};function d(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function h(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!m(e[0])||!m(e[1]))throw new Error("coordinates must contain numbers");return d({type:"Point",coordinates:e},t,n)}function p(e,t,n){void 0===n&&(n={});for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return d({type:"Polygon",coordinates:e},t,n)}function y(e,t){void 0===t&&(t="kilometers");var n=f[t];if(!n)throw new Error(t+" units is invalid");return e/n}function v(e){return e%(2*Math.PI)*180/Math.PI}function g(e){return e%360*Math.PI/180}function m(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function b(e,t,n,r){void 0===r&&(r={});var i=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(e),o=g(i[0]),a=g(i[1]),s=g(n),u=y(t,r.units),l=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(s));return h([v(o+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(l))),v(l)],r.properties)}var k=function(e,t,n){void 0===n&&(n={});for(var r=n.steps||64,i=n.properties?n.properties:!Array.isArray(e)&&"Feature"===e.type&&e.properties?e.properties:{},o=[],a=0;a<r;a++)o.push(b(e,t,-360*a/r,n).geometry.coordinates);return o.push(o[0]),p([o],i)};function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===w(i)?i:String(i)),r)}var i}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getClustersAndFeatures",value:function(e,t,n,r,i,o,a){throw new Error("method getClustersAndFeatures not implemented")}}])&&P(t.prototype,n),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function L(e,t,n,r,i,o){if(i-r<=n)return;const a=r+i>>1;M(e,t,a,r,i,o%2),L(e,t,n,r,a-1,o+1),L(e,t,n,a+1,i,o+1)}function M(e,t,n,r,i,o){for(;i>r;){if(i-r>600){const a=i-r+1,s=n-r+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1);M(e,t,n,Math.max(r,Math.floor(n-s*l/a+c)),Math.min(i,Math.floor(n+(a-s)*l/a+c)),o)}const a=t[2*n+o];let s=r,u=i;for(_(e,t,r,n),t[2*i+o]>a&&_(e,t,r,i);s<u;){for(_(e,t,s,u),s++,u--;t[2*s+o]<a;)s++;for(;t[2*u+o]>a;)u--}t[2*r+o]===a?_(e,t,r,u):(u++,_(e,t,u,i)),u<=n&&(r=u+1),n<=u&&(i=u-1)}}function _(e,t,n,r){x(e,n,r),x(t,2*n,2*r),x(t,2*n+1,2*r+1)}function x(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function O(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}const F=e=>e[0],S=e=>e[1];class E{constructor(e,t=F,n=S,r=64,i=Float64Array){this.nodeSize=r,this.points=e;const o=e.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(e.length),s=this.coords=new i(2*e.length);for(let u=0;u<e.length;u++)a[u]=u,s[2*u]=t(e[u]),s[2*u+1]=n(e[u]);L(a,s,r,0,a.length-1,0)}range(e,t,n,r){return function(e,t,n,r,i,o,a){const s=[0,e.length-1,0],u=[];let l,c;for(;s.length;){const f=s.pop(),d=s.pop(),h=s.pop();if(d-h<=a){for(let a=h;a<=d;a++)l=t[2*a],c=t[2*a+1],l>=n&&l<=i&&c>=r&&c<=o&&u.push(e[a]);continue}const p=Math.floor((h+d)/2);l=t[2*p],c=t[2*p+1],l>=n&&l<=i&&c>=r&&c<=o&&u.push(e[p]);const y=(f+1)%2;(0===f?n<=l:r<=c)&&(s.push(h),s.push(p-1),s.push(y)),(0===f?i>=l:o>=c)&&(s.push(p+1),s.push(d),s.push(y))}return u}(this.ids,this.coords,e,t,n,r,this.nodeSize)}within(e,t,n){return function(e,t,n,r,i,o){const a=[0,e.length-1,0],s=[],u=i*i;for(;a.length;){const l=a.pop(),c=a.pop(),f=a.pop();if(c-f<=o){for(let i=f;i<=c;i++)O(t[2*i],t[2*i+1],n,r)<=u&&s.push(e[i]);continue}const d=Math.floor((f+c)/2),h=t[2*d],p=t[2*d+1];O(h,p,n,r)<=u&&s.push(e[d]);const y=(l+1)%2;(0===l?n-i<=h:r-i<=p)&&(a.push(f),a.push(d-1),a.push(y)),(0===l?n+i>=h:r+i>=p)&&(a.push(d+1),a.push(c),a.push(y))}return s}(this.ids,this.coords,e,t,n,this.nodeSize)}}const I={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},A=Math.fround||(T=new Float32Array(1),e=>(T[0]=+e,T[0]));var T;class D{constructor(e){this.options=K(Object.create(I),e),this.trees=new Array(this.options.maxZoom+1)}load(e){const{log:t,minZoom:n,maxZoom:r,nodeSize:i}=this.options;t&&console.time("total time");const o=`prepare ${e.length} points`;t&&console.time(o),this.points=e;let a=[];for(let s=0;s<e.length;s++)e[s].geometry&&a.push(B(e[s],s));this.trees[r+1]=new E(a,Z,H,i,Float32Array),t&&console.timeEnd(o);for(let s=r;s>=n;s--){const e=+Date.now();a=this._cluster(a,s),this.trees[s]=new E(a,Z,H,i,Float32Array),t&&console.log("z%d: %d clusters in %dms",s,a.length,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){const e=this.getClusters([n,r,180,o],t),a=this.getClusters([-180,r,i,o],t);return e.concat(a)}const a=this.trees[this._limitZoom(t)],s=a.range(U(n),V(o),U(i),V(r)),u=[];for(const l of s){const e=a.points[l];u.push(e.numPoints?R(e):this.points[e.index])}return u}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);const o=i.points[t];if(!o)throw new Error(r);const a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),u=[];for(const l of s){const t=i.points[l];t.parentId===e&&u.push(t.numPoints?R(t):this.points[t.index])}if(0===u.length)throw new Error(r);return u}getLeaves(e,t,n){t=t||10,n=n||0;const r=[];return this._appendLeaves(r,e,t,n,0),r}getTile(e,t,n){const r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:o,radius:a}=this.options,s=a/o,u=(n-s)/i,l=(n+1+s)/i,c={features:[]};return this._addTileFeatures(r.range((t-s)/i,u,(t+1+s)/i,l),r.points,t,n,i,c),0===t&&this._addTileFeatures(r.range(1-s/i,u,1,l),r.points,i,n,i,c),t===i-1&&this._addTileFeatures(r.range(0,u,s/i,l),r.points,-1,n,i,c),c.features.length?c:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,r,i){const o=this.getChildren(t);for(const a of o){const t=a.properties;if(t&&t.cluster?i+t.point_count<=r?i+=t.point_count:i=this._appendLeaves(e,t.cluster_id,n,r,i):i<r?i++:e.push(a),e.length===n)break}return i}_addTileFeatures(e,t,n,r,i,o){for(const a of e){const e=t[a],s=e.numPoints;let u,l,c;if(s)u=N(e),l=e.x,c=e.y;else{const t=this.points[e.index];u=t.properties,l=U(t.geometry.coordinates[0]),c=V(t.geometry.coordinates[1])}const f={type:1,geometry:[[Math.round(this.options.extent*(l*i-n)),Math.round(this.options.extent*(c*i-r))]],tags:u};let d;s?d=e.id:this.options.generateId?d=e.index:this.points[e.index].id&&(d=this.points[e.index].id),void 0!==d&&(f.id=d),o.features.push(f)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const n=[],{radius:r,extent:i,reduce:o,minPoints:a}=this.options,s=r/(i*Math.pow(2,t));for(let u=0;u<e.length;u++){const r=e[u];if(r.zoom<=t)continue;r.zoom=t;const i=this.trees[t+1],l=i.within(r.x,r.y,s),c=r.numPoints||1;let f=c;for(const e of l){const n=i.points[e];n.zoom>t&&(f+=n.numPoints||1)}if(f>c&&f>=a){let e=r.x*c,a=r.y*c,s=o&&c>1?this._map(r,!0):null;const d=(u<<5)+(t+1)+this.points.length;for(const n of l){const u=i.points[n];if(u.zoom<=t)continue;u.zoom=t;const l=u.numPoints||1;e+=u.x*l,a+=u.y*l,u.parentId=d,o&&(s||(s=this._map(r,!0)),o(s,this._map(u)))}r.parentId=d,n.push(j(e/f,a/f,d,f,s))}else if(n.push(r),f>1)for(const e of l){const r=i.points[e];r.zoom<=t||(r.zoom=t,n.push(r))}}return n}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?K({},e.properties):e.properties;const n=this.points[e.index].properties,r=this.options.map(n);return t&&r===n?K({},r):r}}function j(e,t,n,r,i){return{x:A(e),y:A(t),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function B(e,t){const[n,r]=e.geometry.coordinates;return{x:A(U(n)),y:A(V(r)),zoom:1/0,index:t,parentId:-1}}function R(e){return{type:"Feature",id:e.id,properties:N(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),z(e.y)]}};var t}function N(e){const t=e.numPoints,n=t>=1e4?`${Math.round(t/1e3)}k`:t>=1e3?Math.round(t/100)/10+"k":t;return K(K({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:n})}function U(e){return e/360+.5}function V(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function z(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function K(e,t){for(const n in t)e[n]=t[n];return e}function Z(e){return e.x}function H(e){return e.y}var q=n(744),W=n.n(q);function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||$(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Y(e){return!!e&&void 0!==e.nodeName}function J(e){if(e)return e.outerHTML}function ee(e,t,n,r,i,o,a){var s=document.createElement(t);return e&&(s.id=e),i&&(s.style.cssText=i),r&&(s.className=r),a&&st(s,a),n&&n.appendChild(s),o&&o.length>0&&te(s,o),s}function te(e,t){var n=document.createTextNode(t);return e&&e.appendChild(n),n}function ne(e,t){var n=ae(e).filter((function(e){return e.nodeType===Node.TEXT_NODE}));return 1===n.length&&(re(n[0],t),!0)}function re(e,t){e&&(e.nodeValue=t)}function ie(){return void 0!==document}function oe(e){var t=[];if(null!=e&&e.children)for(var n=0;n<e.children.length;n++)t.push(e.children[n]);return t}function ae(e){var t=[];if(null!=e&&e.childNodes)for(var n=0;n<e.childNodes.length;n++)t.push(e.childNodes[n]);return t}function se(e){return e?function(t){if("string"==typeof t.className){var n,r=(null===(n=t.className)||void 0===n?void 0:n.split(" "))||[];return e.every((function(e){return r.includes(e)}))}return!1}:function(e){return!0}}function ue(e){return function(t){return(null==t?void 0:t.getAttribute("aria-roledescription"))===e}}function le(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return pe(e,se(t),n)}function ce(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null===(n=pe(e,se(t),r,!0))||void 0===n||null===(n=n[0])||void 0===n?void 0:n.element}function fe(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return pe(e,ue(t),n)}function de(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null===(n=pe(e,ue(t),r,!0))||void 0===n||null===(n=n[0])||void 0===n?void 0:n.element}function he(e){if(e){var t=e.parentNode;return Array.prototype.indexOf.call(t.children,e)}return-1}function pe(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(e&&e.children){for(var o=0;o<e.children.length;o++){var a=e.children[o];if(a&&t(a)&&(i.push({element:a,parent:e,index:o}),r))return i}for(var s=0;s<e.children.length;s++){var u=e.children[s];if(u&&n&&(pe(u,t,n,r,i),r&&i.length>0))return i}}return i}function ye(e){if(e)for(;e.lastElementChild;)e.removeChild(e.lastElementChild);return e}function ve(e){var t=document.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}function ge(e,t){if(e){var n=document.getElementById(t);n&&n.parentNode&&n.parentNode===e&&e.removeChild(n)}}function me(e){var t;e&&(null===(t=e.parentNode)||void 0===t||t.removeChild(e))}function be(e,t){var n;e&&(null===(n=e.parentNode)||void 0===n||n.removeChild(e),null==t||t.appendChild(e))}function ke(e,t,n,r,i,o,a,s){var u=ee(e,"input",n,r,i,void 0,s);return u.type=t,o&&(u.value=o),Ee(u,a),u}function we(e,t,n,r,i){return ee(e,"div",t,n,r,void 0,i)}function Pe(e,t,n,r,i){return ee(e,"ul",t,n,r,void 0,i)}function Ce(e,t,n,r,i,o){return ee(e,"li",t,n,r,i,o)}function Le(e,t,n,r,i,o){return ee(e,"label",t,n,r,i,o)}function Me(e,t,n,r,i,o){return ee(e,"button",t,n,r,i,o)}function _e(e,t,n,r,i,o){return ee(e,"span",t,n,r,i,o)}function xe(e,t,n,r,i,o){return ee(e,"h1",t,n,r,i,o)}function Oe(e,t,n,r,i,o){return ee(e,"h2",t,n,r,i,o)}function Fe(e,t,n,r,i,o,a,s){var u=ke(e,"checkbox",t,n,r,i,a,s);return o&&(u.checked=!0),u}function Se(e,t,n,r,i,o,a){var s=ee(e,"img",t,n,r,void 0,a);return i&&(s.src=i),Ee(s,o),s}function Ee(e,t){e&&t&&e.setAttribute("aria-label",t)}function Ie(e){if(e){var t=e.getAttribute("aria-label");return((null==t?void 0:t.length)||0)>0}return!1}function Ae(e){e&&e.removeAttribute("aria-label")}function Te(e,t){e&&e.setAttribute("aria-labelledby",t)}function De(e){e&&e.setAttribute("aria-hidden","true")}function je(e){e&&e.setAttribute("aria-live","polite")}function Be(e){e&&e.removeAttribute("aria-live")}function Re(e,t){e&&("presentation"===t&&e.setAttribute("aria-hidden","true"),e.setAttribute("role",t))}function Ne(e){Re(e,"presentation")}function Ue(e){Re(e,"button")}function Ve(e,t){e&&e.setAttribute("tabindex","".concat(t))}function ze(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=$(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.indexOf(":"),a=i.slice(0,o).trim(),s=i.slice(o+1).trim();e.style[a]=s}}catch(e){r.e(e)}finally{r.f()}}function Ke(e,t){e&&(e.style.display=t)}function Ze(e){Ke(e,"none")}function He(e){Ke(e,"")}function qe(e){if(e)return!e.style.display||"none"!==e.style.display}function We(e,t){e&&e.setAttribute("src",t)}function Ge(e,t){e&&(e.style.zIndex="".concat(t))}function Qe(e,t,n){e&&(void 0!==t&&(e.style.width="number"==typeof t?"".concat(t,"px"):t),void 0!==n&&(e.style.height="number"==typeof n?"".concat(n,"px"):n))}function $e(e){e&&e.removeAttribute("aria-label")}function Xe(e,t,n,r,i,o){if(e){var a=void 0!==i?2*i:e.offsetWidth,s=Math.floor(a/2),u=void 0!==o?2*o:e.offsetHeight,l=Math.floor(u/2),c=0,f=0;if(r)switch(r){case"top":c=-s,f=0;break;case"middle":c=-s,f=-l;break;case"bottom":c=-s,f=-u;break;case"left":c=0,f=-l;break;case"right":c=-a,f=-l;break;case"top-left":c=0,f=0;break;case"top-right":c=-a,f=0;break;case"bottom-left":c=0,f=-u;break;case"bottom-right":c=-a,f=-u}Ye(e,{left:"".concat(Math.round(t+c),"px"),top:"".concat(Math.round(n+f),"px")})}}function Ye(e,t){var n=t.bottom,r=t.left,i=t.right,o=t.top;e&&(n||r||i||o)&&(e.style.top=null!=o?o:"",e.style.bottom=null!=n?n:"",e.style.left=null!=r?r:"",e.style.right=null!=i?i:"")}function Je(e,t){var n;return!!e&&((null===(n=e.className)||void 0===n?void 0:n.split(" "))||[]).includes(t)}function et(e,t){return e.left<t.left+t.width&&e.left+e.width>t.left&&e.top<t.top+t.height&&e.top+e.height>t.top}function tt(e,t,n){e&&(Je(e,t)?it(e,t,n):Je(e,n)&&it(e,n,t))}function nt(e,t){return rt(e.right,e.top,t)||rt(e.left,e.top,t)||rt(e.left,e.bottom,t)||rt(e.right,e.bottom,t)||rt(e.center.x,e.center.y,t)}function rt(e,t,n){return Math.sqrt((e-n.center.x)*(e-n.center.x)+(t-n.center.y)*(t-n.center.y))<n.radius}function it(e,t,n){ot(e,[t],[n])}function ot(e,t,n){if(e){var r,i=(null===(r=e.className)||void 0===r?void 0:r.split(" "))||[];t&&t.forEach((function(e){i.indexOf(e)>=0&&i.splice(i.indexOf(e),1)})),n&&n.forEach((function(e){i.includes(e)||i.push(e)})),e.className=i.filter((function(e){return e.length>0})).join(" ")}}function at(e){var t;return(null==e||null===(t=e.className)||void 0===t?void 0:t.split(" "))||[]}function st(e,t){if(e){var n,r=(null===(n=e.className)||void 0===n?void 0:n.split(" "))||[];r.includes(t)||r.push(t),e.className=r.filter((function(e){return e.length>0})).join(" ")}}function ut(e,t){if(e){var n,r=null===(n=e.className)||void 0===n?void 0:n.split(" ");t.forEach((function(e){r.includes(e)||r.push(e)})),e.className=r.filter((function(e){return e.length>0})).join(" ")}}function lt(e,t){if(e){var n,r=(null===(n=e.className)||void 0===n?void 0:n.split(" "))||[];r.indexOf(t)>=0&&r.splice(r.indexOf(t),1),e.className=r.filter((function(e){return e.length>0})).join(" ")}}function ct(e,t){if(e){var n,r=null===(n=e.className)||void 0===n?void 0:n.split(" ");t.forEach((function(e){r.indexOf(e)>=0&&r.splice(r.indexOf(e),1)})),e.className=r.filter((function(e){return e.length>0})).join(" ")}}function ft(e,t){e&&(t?e.className=t:delete e.className)}function dt(e,t){e&&(t?e.setAttribute("style",t):pt(e))}function ht(e,t,n){ft(e,t),dt(e,n)}function pt(e){e&&e.removeAttribute("style")}function yt(e,t,n){var r=(t.center.y-e.center.y)/(t.center.x-e.center.x),i=kt(e.center,t.center),o=r!==-1/0?t.center.y-r*t.center.x:void 0,a={from:Pt(t,r,o,-i.x,-i.y),to:Pt(e,r,o,i.x,i.y)};return kt(a.from||t.center,a.to||e.center,n)}function vt(e,t,n){return{center:e,width:t,height:n,left:e.x-t/2,top:e.y-n/2,right:e.x+t/2,bottom:e.y+n/2}}function gt(e){var t={bottom:Math.max.apply(Math,Q(e.map((function(e){return e.bottom})))),left:Math.min.apply(Math,Q(e.map((function(e){return e.left})))),right:Math.max.apply(Math,Q(e.map((function(e){return e.right})))),top:Math.min.apply(Math,Q(e.map((function(e){return e.top}))))};return t.center=bt(t),t.width=t.right-t.left,t.height=t.bottom-t.top,t}function mt(e,t){var n={bottom:e.bottom+t.y,left:e.left+t.x,right:e.right+t.x,top:e.top+t.y,height:e.height,width:e.width};return n.center=bt(n),n}function bt(e){return{x:(e.right-e.left)/2+e.left,y:(e.bottom-e.top)/2+e.top}}function kt(e,t,n){var r=t.x-e.x,i=t.y-e.y;return{x:r+(n?n*Math.sign(r):0),y:i+(n?n*Math.sign(i):0)}}function wt(e,t){return e>0&&0===t?"right":0===e&&t<0?"top":e<0&&0===t?"left":0===e&&t>0?"bottom":e>0&&t<0?"topOrRight":e<0&&t<0?"topOrLeft":e<0&&t>0?"bottomOrLeft":e>0&&t>0?"bottomOrRight":void 0}function Pt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(wt(arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)){case"right":return Lt(e,t,n);case"top":return Mt(e,t,n);case"left":return _t(e,t,n);case"bottom":return xt(e,t,n);case"topOrRight":return Mt(e,t,n)?Mt(e,t,n):Lt(e,t,n);case"topOrLeft":return _t(e,t,n)?_t(e,t,n):Mt(e,t,n);case"bottomOrLeft":return xt(e,t,n)?xt(e,t,n):_t(e,t,n);case"bottomOrRight":return Lt(e,t,n)?Lt(e,t,n):xt(e,t,n)}}function Ct(e,t,n){if(e&&t)if(n>=t.children.length)t.appendChild(e);else{var r=oe(t)[n];t.insertBefore(e,r)}}function Lt(e,t,n){var r=t*e.right+n;if(r>=e.top&&r<=e.bottom)return{x:e.right,y:r}}function Mt(e,t,n){var r=t!==-1/0?(e.top-n)/t:e.center.x;if(r>=e.left&&r<=e.right)return{x:r,y:e.top}}function _t(e,t,n){var r=t*e.left+n;if(r>=e.top&&r<=e.bottom)return{x:e.left,y:r}}function xt(e,t,n){var r=t!==-1/0?(e.bottom-n)/t:e.center.x;if(r>=e.left&&r<=e.right)return{x:r,y:e.bottom}}function Ot(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.g.document;if(o){var a=G(o.getElementsByTagName("head"),1)[0];if(a){var s=o.createElement("style");s.id=e,s.setAttribute("data-meta",t),a.appendChild(s);var u,l=s.sheet;if(l)if(void 0!==l.insertRule)u=function(e,t,n){return e.insertRule(t+"{"+n+"}",e.cssRules.length)};else{if(void 0===l.addRule)throw new Error("no insertRule or addRule in sheet");u=function(e,t,n){return e.addRule(t,n)}}var c=[];Object.keys(i).forEach((function(e){var t=i[e],n=".egmaps.".concat(r," ").concat(e),o=Object.keys(t).map((function(e){return"".concat(ln(e),":").concat(t[e]||"''")})).join(";");u(l,n,o),c.push("".concat(n," {\n  ").concat(o.split(";").join(";\n  "),";\n}"))}));var f=o.createTextNode(c.join("\n\n"));s.appendChild(f)}}}function Ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||It(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e){return function(e){if(Array.isArray(e))return At(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||It(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function It(e,t){if(e){if("string"==typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(e,t):void 0}}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tt(e,t){return(jt(e,t)||{}).value}function Dt(e,t){return(jt(e,t)||{}).key}function jt(e,t){if(t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=It(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i){var o=null==e?void 0:e[i];if(void 0!==o)return{key:i,value:o}}}}catch(e){r.e(e)}finally{r.f()}}}function Bt(e){return!e||""===e}function Rt(e){return e[0].toUpperCase()+e.slice(1)}function Nt(e){return null!==e&&"object"===Et(e)&&!Y(e)&&"[object Array]"!==Object.prototype.toString.call(e)}function Ut(e){return Array.isArray(e)}function Vt(e){return JSON.stringify(e,(t=new WeakSet,function(e,n){if("object"===Et(n)&&null!==n){if(t.has(n))return;t.add(n)}return n}));var t}function zt(e){if(e){if(Ut(e))return e.sort();if(Nt(e)){var t;if("Object"===(null===(t=e.constructor)||void 0===t?void 0:t.name)){var n={};return Object.keys(e).sort().forEach((function(t){return n[t]=zt(e[t])})),n}return e}return e}return e}function Kt(e,t){if(t<=0)throw new Error("chunk size should be greater than 0");var n=0,r=e.length,i=[];for(n=0;n<r;n+=t){var o=e.slice(n,n+t);i.push(o)}return i}function Zt(e){return e&&0!==e.length?St(new Set(e)):[]}function Ht(e){return Gt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:2)}function qt(e){return e.filter((function(e){if(void 0!==e){var t=e.lat,n=e.lng;if(!t&&void 0!==e.length){var r=Ft(e,2);t=r[0],n=r[1]}if(void 0!==t&&void 0!==n)return e}})).filter((function(e){return void 0!==e}))}function Wt(e){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Gt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:5);if(t){if(n<-180)return n+360;if(n>180)return n-360}return n}function Gt(e,t){var n=Math.pow(10,t),r=e*n;return(r=Math.round(r))/n}function Qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.lat,i=e.lng;if(!r&&void 0!==e.length){var o=Ft(e,2);r=o[0],i=o[1]}return[Wt(r,t,!1),Wt(i,t,n)]}function $t(e,t){if(!e)return!t;if(!t)return!1;var n=e.sw,r=e.ne,i=e.center,o=t.sw,a=t.ne,s=t.center;return n[0]===o[0]&&n[1]===o[1]&&r[0]===a[0]&&r[1]===a[1]&&i[0]===s[0]&&i[1]===s[1]}function Xt(e){var t=Number(e);return Math.floor(t.valueOf())===t.valueOf()?0:t.toString().split(".")[1].length||0}function Yt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e,t){return e===t};if(e.length!==t.length)return!1;var i=t.slice();return e.every((function(e,t){var o=i.findIndex((function(t){return r(e,t)}));return o>=0&&(!n||t===o)}))}function Jt(e){var t=e.indexOf("."),n=e.indexOf(",");if(-1!==t||-1!==n){var r=n>t?",":".",i=n>t?n:t;if(e.length<=i+3)return r;for(var o=i+1;o<=i+3;o++){var a=e.charAt(o);if(isNaN(a)||" "===a)return r}if(e.length>=i+4){var s=e[i+4];if(!isNaN(s)&&" "!==s)return r}}}function en(e){for(var t,n,r=0;r<e.length;r++){var i=e[r];if(!t&&"string"==typeof i){var o=Jt(i);o&&(n=(t=o)&&","===t?".":",")}}var a=void 0,s=void 0;if(e.forEach((function(e){var r=t?W()(e,{decimal:t,separator:n}).value:W()(e).value;(!a||a>r)&&(a=r,s=e)})),a&&isFinite(a))return s}function tn(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=n?n.sort():[],o=[],a=function(e){for(var t=e.depth;t>=0;t--)for(var n=e[t],r=n.maxQualifiers;r>=0;r--)n[r]&&(o=o.concat(n[r]))};if(t){var s={depth:1,0:["hl"]};nn("hl#",i.slice(),e,s,1,0),a(s),e&&o.push(["hl",e].sort().join("#")),o.push("hl")}var u={depth:-1};return nn("",i.slice(),e,u,0,0),a(u),e&&o.push(e),r&&o.push("default"),o}function nn(e,t,n,r,i,o){var a=r[i];for(a||(a={maxQualifiers:o},r[i]=a,r.depth=i);t.length>0;){var s=t.splice(0,1),u=o+1;if(a[u]||(a[u]=[]),a.maxQualifiers<u&&(a.maxQualifiers=u),a[u].push("".concat(e).concat(s).split("#").sort().join("#")),n){var l=r[i+1];l||(l={maxQualifiers:u},r[i+1]=l,r.depth=i+1),l[u]||(l[u]=[]),l[u].push("".concat(e).concat(s,"#").concat(n).split("#").sort().join("#"))}t.length>0&&nn("".concat(e).concat(s,"#"),t.slice(),n,r,i+1,o+1)}}function rn(e){return on(255*e)}function on(e){var t=parseInt(e);t<0&&(t=4294967295+t);var n=t.toString(16).toUpperCase();return 1==n.length?n+"0":n.slice(-2)}function an(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(62*Math.random()));return t}function sn(e){return e.split("").reduce((function(e,t){var n=(e<<5)-e+t.charCodeAt(0);return n&n}),0)}function un(e){return e.split("-").map((function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1)})).join("")}function ln(e){var t=[];return e.split("").forEach((function(e,n){var r=e.toUpperCase();e===r&&e.toLowerCase()!==r?n>0?t.push("-",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function cn(e){return e.split("_").map((function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1)})).join("")}function fn(e){var t=[];return e.split("").forEach((function(e,n){var r=e.toUpperCase();e===r&&e.toLowerCase()!==r?n>0?t.push("_",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function dn(e){return e.substring(e.indexOf("((")+2,e.lastIndexOf("))")).split(", ").map((function(e){return e.split(" ")})).map((function(e){return{lng:Number(parseFloat(e[0]).toFixed(8)),lat:Number(parseFloat(e[1]).toFixed(8))}}))}var hn=function(e,t,n){t.has(n)&&(e.push(n),t.delete(n))},pn=function(e){var t=["available","filtered","sold_out","unknown"],n=new Set,r=new Set;e.forEach((function(e){(function(e){return["available","filtered","sold_out","unknown"].some((function(t){return-1!==e.indexOf(t)}))})(e)||-1!==e.indexOf("hl")||-1!==e.indexOf("default")||e.split("#").forEach((function(e){return r.add(e)})),n.add(e)}));var i=[];hn(i,n,"default"),t.forEach((function(e){return hn(i,n,e)}));var o=Array.from(r).sort(),a=function(e,t){for(var n=function e(t,n,r,i){if(0!=t)for(var o=0;o<n.length;o++)e(t-1,n.slice(o+1),r.concat([n[o]]),i);else r.length>0&&(i[i.length]=r)},r=[],i=1;i<e.length;i++)n(i,e,[],r);return r.push(e),r}(o).map((function(e){return e.join("#")}));if(o.length>0){for(var s=function(e){for(var r=o.length-1;r>=0;r--)hn(i,n,a[e+r]);for(var s=function(r){t.forEach((function(t){for(var s=o.length;s>=0;s--)hn(i,n,"".concat(t,"#").concat(a[e+r]))}))},u=o.length-1;u>=0;u--)s(u)},u=0;u<a.length-1;u+=o.length)s(u);hn(i,n,a[a.length-1]),t.forEach((function(e){return hn(i,n,"".concat(e,"#").concat(a[a.length-1]))}))}if(hn(i,n,"hl"),t.forEach((function(e){return hn(i,n,"".concat(e,"#hl"))})),o.length>0){for(var l=function(e){for(var r=o.length-1;r>=0;r--)hn(i,n,"hl#".concat(a[e+r]));for(var s=function(r){t.forEach((function(t){for(var s=o.length;s>=0;s--)hn(i,n,"".concat(t,"#hl#").concat(a[e+r]))}))},u=o.length-1;u>=0;u--)s(u)},c=0;c<a.length-1;c+=o.length)l(c);hn(i,n,"hl#".concat(a[a.length-1])),t.forEach((function(e){return hn(i,n,"".concat(e,"#hl#").concat(a[a.length-1]))}))}return i.reverse()};function yn(e,t,n){var r;return r="%"===t?parseFloat(e)*n/100:parseFloat(e),Number.isFinite(r)?r:void 0}function vn(e,t){var n,r;if(void 0!==e){if("string"!=typeof e)throw new Error("Client padding has to be of type string");var i=t||{},o=i.clientHeight,a=i.clientWidth;if(!Number.isFinite(o)||!Number.isFinite(a))throw new Error("Dimensions of map element have to be of type number: {height: ".concat(o,", width: ").concat(a,"}"));var s=e.match(/^(((\d+)(\.\d+)?)(px|%|))( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?$/);if(!s)throw new Error("Client padding has to follow CSS syntax and only use 'px' and '%' units");var u=Ft(s,21),l=u[2],c=u[5],f=u[7],d=u[10],h=u[12],p=u[15],y=u[17],v=u[20];return{paddingTop:yn(l,c,o),paddingRight:yn(null!=f?f:l,null!=d?d:c,a),paddingBottom:yn(null!=h?h:l,null!=p?p:c,o),paddingLeft:yn(null!==(n=null!=y?y:f)&&void 0!==n?n:l,null!==(r=null!=v?v:d)&&void 0!==r?r:c,a)}}}function gn(e,t,n){var r=Qt(t);if(n){var i=n.paddingTop,o=void 0===i?0:i,a=n.paddingRight,s=void 0===a?0:a,u=n.paddingBottom,l=void 0===u?0:u,c=n.paddingLeft,f=void 0===c?0:c,d=Math.pow(2,Ht(e+1)),h=[(o-l)/d,(s-f)/d];r=Qt(r.map((function(e){return e+h.shift()})))}return{zoom:Ht(e),center:r}}function mn(e,t,n){var r=parseInt(t),i=parseInt(n),o=String(e);if(o&&r&&i&&r>0&&i>0&&o.length>r){for(var a=o.replace(/[\u0000-\u001F\u007F-\u009F]/g," ").trim().split(/\s+/g).map((function(e){return St(e)})),s=[],u=[],l=0;a.length>0&&u.length<=i;){var c=Ft(a,1)[0];((l+=c.length)<=r||l>r&&0===s.length)&&(s.push(c.join("")),a.shift()),(l>=r||l<r&&0===a.length)&&(u.push(s.join(" ")),s=[],l=0)}return u.length>i&&(u.pop(),u.push(u.pop()+"...")),u.join("\n")}return o}function bn(e){var t=e.split("\n").map((function(e){return St(e).length}));if(1===t.length)return 0;var n=Math.max.apply(Math,St(t));return Math.min.apply(Math,St(t))/n}function kn(e,t,n){for(var r=String(e),i=0,o=Math.min(Math.floor(r.length/n),t),a=t;a>=o;){var s=mn(e,a,n),u=bn(s);if(!u||0===u||u>=.5)return s;u>i&&(r=s,i=u),a--}return r}function wn(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e}function Pn(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n}function Cn(e,t,n,r){if(!e||isNaN(e))return e;var i=t||Xt(e),o={style:"currency",currency:n,minimumFractionDigits:i,maximumFractionDigits:i};return new Intl.NumberFormat(r,o).format(e)}function Ln(e){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ln(e)}function Mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||_n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _n(e,t){if(e){if("string"==typeof e)return xn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xn(e,t):void 0}}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Ln(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===Ln(i)?i:String(i)),r)}var i}function Fn(e,t){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fn(e,t)}function Sn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=En(e);if(t){var i=En(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Ln(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function En(e){return En=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},En(e)}var In=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fn(e,t)}(o,e);var t,n,r,i=Sn(o);function o(e,t,n,r,a){var s,u,l,c,f,d,h;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(h=i.call(this)).createClusterLabel=t,h.logger=e("SuperCluster"),h._config=n,h._defaultConfig=r,h.labelKey=null!==(s=h._config.labelKey)&&void 0!==s?s:r.labelKey||"unknown",h._radius=null!==(u=null!==(l=null===(c=h._config.superclusterSettings)||void 0===c?void 0:c.radius)&&void 0!==l?l:null===(f=r.superclusterSettings)||void 0===f?void 0:f.radius)&&void 0!==u?u:0,h._previousMapSize=void 0,h._mapSize=void 0,h._tileDim=void 0,h._supercluster=void 0,h.qualifier=a,h.excludedQualifiers=null!==(d=h._config.excludedQualifiers)&&void 0!==d?d:r.excludedQualifiers,h}return t=o,n=[{key:"radius",get:function(){if(!this._tileDim||!this._mapSize)return 0;var e=this._tileDim,t=e.width,n=e.height,r=this._mapSize,i=75*r.clientWidth/t,o=75*r.clientHeight/n;return Math.min(this._radius,i,o)}},{key:"supercluster",get:function(){var e,t,n,r=this._previousMapSize||{},i=r.clientWidth,o=r.clientHeight,a=this._mapSize||{},s=a.clientWidth,u=a.clientHeight;return this._supercluster&&i===s&&o===u||(this._supercluster=new D({minPoints:null!==(e=this._config.minPoints)&&void 0!==e?e:this._defaultConfig.minPoints,minZoom:null!==(t=this._config.minZoom)&&void 0!==t?t:this._defaultConfig.minZoom,maxZoom:null!==(n=this._config.maxZoom)&&void 0!==n?n:this._defaultConfig.maxZoom,radius:this.radius})),this._supercluster}},{key:"getClustersAndFeatures",value:function(e,t,n,r,i,o,a){this._previousMapSize=this._mapSize,this._mapSize=o,this._tileDim=a;var s=e.remainingFeatures,u=e.clusters,l=this._getExcludedFeatures(s,n),c=l.map((function(e){return e.id})),f=s.filter((function(e){return!c.includes(e.id)})),d=this._loadFeaturesForClustering(f);return this._clusterFeatures(d,f,u,t,l,r,i)}},{key:"_loadFeaturesForClustering",value:function(e){var t=this,n=e.map((function(e){return t._makeGeoJsonFeature(e)}));return this.supercluster.load(n)}},{key:"_clusterFeatures",value:function(e,t,n,r,i,o,a){var s=this._convertBoundsToBbox(o),u=e.getClusters(s,Math.floor(a));return this._getAllFeaturesAndClusters(e,t,n,r,i,u)}},{key:"_convertBoundsToBbox",value:function(e){return[e.sw[1],e.sw[0],e.ne[1],e.ne[0]]}},{key:"_makeGeoJsonFeature",value:function(e){var t=[e.latLng[1],e.latLng[0]];return{id:e.id,type:"Feature",geometry:{type:"Point",coordinates:t},properties:e}}},{key:"_getAllFeaturesAndClusters",value:function(e,t,n,r,i,o){var a,s=this,u={clusters:n,remainingFeatures:i},l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_n(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(o);try{var c=function(){var n=a.value;if(n.properties.cluster){var i=n.properties.cluster_id,o=e.getLeaves(i,1/0),l=en(o.map((function(e){return e.properties.price})))||0,c=Mn(n.geometry.coordinates,2),f=c[0],d=c[1],h={id:i,children:t.filter((function(e){return!o.every((function(t){return t.properties.id!==e.id||t.properties.type!==e.type}))})),minPrice:l,lat:d,lng:f,type:"cluster",radius:s.radius,text:s.createClusterLabel(o.length,l,s.labelKey),featureType:r,qualifier:s.qualifier};u.clusters.push(h)}else u.remainingFeatures.push(n.properties)};for(l.s();!(a=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}return u}},{key:"_getExcludedFeatures",value:function(e,t){var n=this;return e.filter((function(e){var r;return(e.qualifiers||[]).some((function(e){return(n.excludedQualifiers||[]).includes(e)}))||!(null!==(r=e.hashKeys)&&void 0!==r&&r.includes(t))}))}}],n&&On(t.prototype,n),r&&On(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(C);function An(e,t){return An=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},An(e,t)}function Tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dn(e);if(t){var i=Dn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Dn(e){return Dn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dn(e)}function jn(e){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jn(e)}function Bn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==jn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===jn(i)?i:String(i)),r)}var i}function Nn(e,t,n){return t&&Rn(e.prototype,t),n&&Rn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Un={OFF:"OFF",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR"};function Vn(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n?new Kn:null!=t?t:new Kn;return{debug:function(t,i){return r.debug({loggerName:e,message:t,stack:i,debugMode:n})},info:function(t,i){return r.info({loggerName:e,message:t,stack:i,debugMode:n})},warn:function(t,i){return r.warn({loggerName:e,message:t,stack:i,debugMode:n})},error:function(t,i){return r.error({loggerName:e,message:t,stack:i,debugMode:n})},debugEnabled:function(){return r.debugEnabled()},infoEnabled:function(){return r.infoEnabled()},warnEnabled:function(){return r.warnEnabled()},errorEnabled:function(){return r.errorEnabled()}}}var zn=function(){function e(){Bn(this,e)}return Nn(e,[{key:"log",value:function(e,t,n,r,i){throw new Error("method log not implemented")}},{key:"enabled",value:function(e){throw new Error("method enabled not implemented")}},{key:"debug",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Un.DEBUG,n,r,i)}},{key:"info",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Un.INFO,n,r,i)}},{key:"warn",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Un.WARN,n,r,i)}},{key:"error",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Un.ERROR,n,r,i)}},{key:"debugEnabled",value:function(){return this.enabled(Un.DEBUG)}},{key:"infoEnabled",value:function(){return this.enabled(Un.INFO)}},{key:"warnEnabled",value:function(){return this.enabled(Un.WARN)}},{key:"errorEnabled",value:function(){return this.enabled(Un.ERROR)}}]),e}(),Kn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&An(e,t)}(n,e);var t=Tn(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Un.WARN,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t,n){return"".concat((new Date).toISOString()," EGMAPS-").concat("8.0.0"," ").concat(e||"undefined"," ").concat(t," ").concat(n)};return Bn(this,n),(e=t.call(this)).formatter=i,e.level=r,e}return Nn(n,[{key:"enabled",value:function(e){if(this.level!==Un.OFF)switch(e){case Un.DEBUG:return this.level===Un.DEBUG;case Un.INFO:return this.level===Un.DEBUG||this.level===Un.INFO;case Un.WARN:return this.level===Un.DEBUG||this.level===Un.INFO||this.level===Un.WARN;case Un.ERROR:return this.level===Un.DEBUG||this.level===Un.INFO||this.level===Un.WARN||this.level===Un.ERROR;default:throw new Error("level not implemented: ".concat(e))}return!1}},{key:"log",value:function(e,t,n,r,i){var o,a,s,u;if(this.enabled(t||Un.INFO)||i){var l=[this.formatter(e,t||Un.INFO,n)];switch(r&&l.push(r),t){case Un.DEBUG:(o=console).debug.apply(o,l);break;case Un.INFO:default:(a=console).info.apply(a,l);break;case Un.WARN:(s=console).warn.apply(s,l);break;case Un.ERROR:(u=console).error.apply(u,l)}return!0}}}]),n}(zn);function Zn(e){return Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zn(e)}function Hn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(n),!0).forEach((function(t){Qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Zn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Zn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Zn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $n(e){return Promise.allSettled?Promise.allSettled(e):Promise.all(e.map((function(e){return e.then((function(e){return{status:"fulfilled",value:e}})).catch((function(e){return{status:"rejected",reason:e}}))})))}function Xn(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("undefined"!=typeof AbortController){var i=new AbortController;return setTimeout((function(){return i.abort()}),t),fetch(e,Gn(Gn({},r),{},{signal:i.signal})).catch((function(r){if(null!=r&&r.toString().includes("The user aborted a request"))return{clone:function(){return n},redirected:!1,type:"basic",url:e,ok:!1,success:!1,status:504,headers:[],statusText:"timeout occurs after ".concat(t,"ms when fetching ").concat(e),arrayBuffer:function(){return Promise.reject(new Error("timeout occurs"))},body:null,bodyUsed:!1,blob:function(){return Promise.reject(new Error("timeout occurs"))},formData:function(){return Promise.reject(new Error("timeout occurs"))},json:function(){return Promise.reject(new Error("timeout occurs"))},text:function(){return Promise.reject(new Error("timeout occurs"))}};throw r}))}return fetch(e,r)}function Yn(e){var t,n,r=Hn(null===(t=document.cookie)||void 0===t?void 0:t.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if((null==i?void 0:i.substring(0,i.indexOf("=")).trim())===e){if(i.indexOf("=")+1>i.length)return;return i.substring(i.indexOf("=")+1)}}}catch(e){r.e(e)}finally{r.f()}}function Jn(e){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jn(e)}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Jn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===Jn(i)?i:String(i)),r)}var i}var tr=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"_loadOptionsFromCookie",value:function(){var e=Yn("EGMAPS_DEBUG_OPTIONS");this._debugOptions=new Set(null==e?void 0:e.split(","))}},{key:"_getOptionEnabled",value:function(e){var t;return this._debugOptions||this._loadOptionsFromCookie(),!(null===(t=this._debugOptions)||void 0===t||!t.has(e))}},{key:"getDebugLoggingEnabled",value:function(){return this._getOptionEnabled("logging")}},{key:"getDebugTilesIdEnabled",value:function(){return this._getOptionEnabled("tilesId")}},{key:"getDebugMarkersPositionEnabled",value:function(){return this._getOptionEnabled("markersPosition")}},{key:"getDebugConfigEnabled",value:function(){return this._getOptionEnabled("config")}}])&&er(t.prototype,n),r&&er(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}());function nr(e){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(e)}function rr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||or(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ir(e){return function(e){if(Array.isArray(e))return ar(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||or(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(e,t){if(e){if("string"==typeof e)return ar(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ar(e,t):void 0}}function ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==nr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===nr(i)?i:String(i)),r)}var i}var ur=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultConfig=t,this.config=n,this.overwriteConfig={},this.configurations=[n,t].filter(Boolean),this.externalConfig=void 0,this.cache=new Map,this.configLoaderLogger=this.logger("config-loader"),this.externalConfigLoaded=r?new Promise((function(e){i.externalConfig=r,i.configurations=[r].concat(ir(i.configurations)),e(void 0)})):this._loadExternalConfig(null==n?void 0:n.externalConfigEndpoint,5e3).then((function(e){i.configLoaderLogger.debug("Loaded external config from ".concat(null==n?void 0:n.externalConfigEndpoint)),e&&(i.externalConfig=e,i.configurations=[e].concat(ir(i.configurations)))}))}var t,n,r;return t=e,n=[{key:"ready",value:function(){var e=this;return this.externalConfigLoaded.then((function(){return e}))}},{key:"getConfigurations",value:function(){return{default:this.defaultConfig,external:this.externalConfig,overwrite:this.overwriteConfig,parameter:this.config}}},{key:"_loadExternalConfig",value:function(e,t){var n=this;return e?(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xn)(e,t).then((function(e){return e.ok?e.json().then((function(e){return n.externalConfig=e})):(e.text().then((function(e){return n.configLoaderLogger.error("Failed to load external configuration. Will continue without this config",e)})),null)})).catch((function(t){return n.configLoaderLogger.error("failed to load external config from ".concat(e),t),null})):Promise.resolve(null)}},{key:"logger",value:function(e){return Vn(e,this.readParam("logging,logger"),tr.getDebugLoggingEnabled())}},{key:"clearCache",value:function(){this.cache.clear()}},{key:"writeParam",value:function(e,t){this._writeParamAux(e.split(","),t,this.overwriteConfig),this.cache.set(e,t)}},{key:"removeOverrideParam",value:function(e){this._removeParamAux(e.split(","),this.overwriteConfig),this.cache.delete(e)}},{key:"removeParam",value:function(e){this.writeParam(e,null)}},{key:"_writeParamAux",value:function(e,t,n){var r=rr(e,1)[0];if(wn(r))if(1===e.length)n[r]=t;else{n[r]||(n[r]={});var i=n[r];e.shift(),this._writeParamAux(e,t,i)}}},{key:"_removeParamAux",value:function(e,t){var n=rr(e,1)[0];if(wn(n))if(1===e.length)delete t[n];else{t[n]||(t[n]={});var r=t[n];e.shift(),this._removeParamAux(e,r)}}},{key:"readParam",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return null===t?void 0:t}var n=e.split(","),r=this._readParamAux(n,this.overwriteConfig,this.configurations);return this.cache.set(e,r),r}},{key:"_readParamAux",value:function(e,t,n){var r=rr(e,1)[0],i=t?t[r]:void 0;if(null!==i){for(var o=n.map((function(e){return e[r]})).filter((function(e){return void 0!==e})),a=0;a<o.length;a++)if(null===o[a]){o=o.splice(0,a);break}return 1===e.length?zt(i||(o.length>0?o[0]:void 0)):(e.shift(),this._readParamAux(e,i,o))}}},{key:"listStringKeys",value:function(e){var t=this,n=[],r=[];return[this.overwriteConfig].concat(ir(this.configurations)).forEach((function(i){return t._listKeysAux(n,r,(null==e?void 0:e.split(","))||[],[],i)})),n}},{key:"listKeys",value:function(e){return ir(this.listStringKeys(e).map((function(e){return e.split(",")})))}},{key:"listKeysShallow",value:function(e){return this.listStringKeys(e).map((function(t){return t.split(",").slice(0,e.split(",").length+1).join(",")})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return e.split(",")}))}},{key:"subConfig",value:function(e){var t=this,n={};return(e?[e]:Object.keys(this.defaultConfig)).map((function(e){var r={};return t.listStringKeys(e).map((function(n){var i=t.readParam(n);void 0!==i&&t._writeParamAux(n.substring(e.length+1).split(","),i,r)})),n[e]=r,r})),e?n[e]:n}},{key:"_listKeysAux",value:function(e,t,n,r,i){var o=[],a=i;if(n.length>0){var s=rr(n,1)[0];a=i[s],o.push.apply(o,ir(r).concat([s]))}void 0!==a&&(n.length<=1?this._listKeysAuxDeep(e,t,o,a):(n.shift(),this._listKeysAux(e,t,n,o,a)))}},{key:"_listKeysAuxDeep",value:function(e,t,n,r){if(Nt(r)&&!Y(r))for(var i in r){var o=[];o.push.apply(o,ir(n).concat([i])),t.includes(o.join(","))||this._listKeysAuxDeep(e,t,o,r[i])}else n&&(t.includes(n.join(","))||(null===r?t.push(n.join(",")):this._checkIfParentPathAlreadyPresent(e,n)||e.push(n.join(","))))}},{key:"_checkIfParentPathAlreadyPresent",value:function(e,t){var n=[];t.forEach((function(t){if(n.push(t),e.includes(n.join(",")))return!0}));var r=t.join(",")+",";return e.some((function(e){return e===t.join(",")||e.startsWith(r)}))}},{key:"_fillObjectWithLeafName",value:function(e,t){var n=this;this.listKeysShallow(e).map((function(e){var r=e[e.length-1];t(r,n.readParam(e.join(",")))}))}},{key:"propertyValues",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},o={};return n.map((function(n){o[n]={};var a=[e,n,t].filter((function(e){return void 0!==e})).join(",");r._fillObjectWithLeafName(a,(function(e,t){var r=e.split("#").sort().join("#");wn(n)&&wn(r)&&(o[n][r]=i(t))}))})),o}}],n&&sr(t.prototype,n),r&&sr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function lr(e){var t=["animate__animated","animate__bounce"];e.addEventListener("animationend",(function n(r){ct(e,t),e.removeEventListener("animationend",n)})),ut(e,t)}function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(e)}function fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==cr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===cr(i)?i:String(i)),r)}var i}var dr=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=r.readParam,o=r.writeParam;this.locale=n,this.messages=t||{},this.readParam=i,this.writeParam=o,this.variants=[],this.locale&&(this.variants.push(this.locale),n.length>2&&this.variants.push(this.locale.slice(0,2))),this.variants.push("default"),this._registerMessages(),this.hookForFormat=this.readParam("i18n,formatFunction")}var t,n,r;return t=e,n=[{key:"_registerMessages",value:function(){var e=this,t=this;this.variants.forEach((function(n){var r=e.messages[n];if(r)for(var i in r){var o="i18n,messages,".concat(i);void 0===t.readParam(o)&&t.writeParam(o,r[i])}}))}},{key:"format",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this._externalFormat.apply(this,[e].concat(r)))||(t=this._internalFormat.apply(this,[e].concat(r))),t}},{key:"_externalFormat",value:function(e){if(this.hookForFormat){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.hookForFormat(e,n)}}},{key:"_internalFormat",value:function(e){var t=this.readParam("i18n,messages,".concat(e));if(t){for(var n=t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(i)for(var a=0;a<i.length;a++){var s=i[a];n=n.replace("{".concat(a,"}"),void 0!==s?s:"")}return n}return"".concat(e," ").concat(this.locale?this.locale:"default"," NOT FOUND")}}],n&&fr(t.prototype,n),r&&fr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function hr(){return hr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gr(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},hr.apply(this,arguments)}function pr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yr(e,t)}function yr(e,t){return yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yr(e,t)}function vr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gr(e);if(t){var i=gr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===kr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function gr(e){return gr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gr(e)}function mr(e){return function(e){if(Array.isArray(e))return br(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return br(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?br(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kr(e){return kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kr(e)}function wr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==kr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===kr(i)?i:String(i)),r)}var i}function Cr(e,t,n){return t&&Pr(e.prototype,t),n&&Pr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Lr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return"object"!==kr(e)},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!1};wr(this,e),this.isLeaf=t,this.hasExpired=n,this.cache=Object.create(null),this.listeners=new Set}return Cr(e,[{key:"get",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=this.cache[n[0]],o=1;o<n.length&&i;o++)i=i[n[o]];return i&&this.hasExpired(i,n)?(this.listeners.forEach((function(t){return t(e.EVENTS.EXPIRE,i,n)})),void this.set.apply(this,[void 0].concat(n))):i}},{key:"keys",value:function(){for(var e=this.cache,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<(null==n?void 0:n.length)&&e;i++)e=e[n[i]];return e?this._keysAux(n,e):[]}},{key:"_keysAux",value:function(e,t){var n=this;return this.isLeaf(t,e)?this.hasExpired(t,e)?[]:[e]:Object.keys(t).flatMap((function(r){return n._keysAux([].concat(mr(e),[r]),t[r])}))}},{key:"set",value:function(e){for(var t=[],n=this.cache,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var a=0;a<i.length-1;a++){if(!n[i[a]]){if(!e)return;n[i[a]]={}}t.push(n),n=n[i[a]]}if(e)n[i[i.length-1]]=e;else{delete n[i[i.length-1]];for(var s=t.length-1;s>=0&&0===Object.keys(t[s][i[s]]).length;s--)delete t[s][i[s]]}}},{key:"addListener",value:function(e){this.listeners.add(e)}},{key:"removeListener",value:function(e){this.listeners.delete(e)}}]),e}();Lr.EVENTS={EXPIRE:"expire"};var Mr=function(e){pr(n,e);var t=vr(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return null==e?void 0:e.leaf},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return wr(this,n),t.call(this,r,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return i(t.time+e<Date.now(),t.content,r)}))}return Cr(n,[{key:"set",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=hr(gr(n.prototype),"set",this)).call.apply(t,[this,{leaf:!0,time:Date.now(),content:e}].concat(i))}},{key:"get",value:function(){for(var e,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return null===(e=(t=hr(gr(n.prototype),"get",this)).call.apply(t,[this].concat(i)))||void 0===e?void 0:e.content}},{key:"keys",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=hr(gr(n.prototype),"keys",this)).call.apply(e,[this].concat(r))}}]),n}(Lr),_r=function(e){pr(n,e);var t=vr(n);function n(){return wr(this,n),t.apply(this,arguments)}return Cr(n,[{key:"set",value:function(){}},{key:"get",value:function(){}}]),n}(Lr);function xr(e,t,n){return!e||e<=0?new _r:new Mr(e,t,n)}function Or(e){return function(e){if(Array.isArray(e))return Er(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Sr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Sr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sr(e,t){if(e){if("string"==typeof e)return Er(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Er(e,t):void 0}}function Er(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ir=6378137;function Ar(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=o.zoomMax,s=void 0===a?21:a,u=o.padding,l=void 0===u?0:u,c=o.worldDimensions,f=void 0===c?{height:256,width:256}:c,d=o.parsedClientPadding,h=(jr(r)-jr(t))/Math.PI,p=i-n,y=(p<0?p+360:p)/360,v=e.offsetWidth,g=e.offsetHeight,m=d||{},b=m.paddingTop,k=void 0===b?0:b,w=m.paddingRight,P=void 0===w?0:w,C=m.paddingBottom,L=void 0===C?0:C,M=m.paddingLeft,_=void 0===M?0:M,x=Br(g-2*l-k-L,f.height,h),O=Br(v-2*l-P-_,f.width,y);return isFinite(x)?isFinite(O)?Math.min(x,O,s):x:O}function Tr(e,t,n,r,i){var o=Math.sin(e*Math.PI/180);o=Math.min(Math.max(o,-.9999),.9999);var a=1<<n;return[Math.floor(r*(.5+t/360)*a/r),Math.floor(i*(.5-Math.log((1+o)/(1-o))/(4*Math.PI))*a/i)]}function Dr(e,t,n,r,i,o,a){for(var s=Fr(Tr(n,t,i,o,a),2),u=s[0],l=s[1],c=Fr(Tr(e,r,i,o,a),2),f=c[0],d=c[1],h=[],p=0;p<=f-u;p++)for(var y=0;y<=d-l;y++)h.push({x:u+p,y:l+y});return h}function jr(e){var t=Math.sin(e*Math.PI/180),n=Math.log((1+t)/(1-t))/2;return Math.max(Math.min(n,Math.PI),-Math.PI)/2}function Br(e,t,n){return Math.floor(Math.log(e/t/n)/Math.LN2*1e3)/1e3}function Rr(e){var t=Fr(e,1)[0],n=Fr(e,1)[0];return e.forEach((function(e){t>e?t=e:n<e&&(n=e)})),e.length>1&&n-t>t+360-n}function Nr(e){return Rr(e.map((function(e){var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})))}function Ur(e,t){var n,r;return(null!==(n=t.lng)&&void 0!==n?n:t[1])<(null!==(r=e.lng)&&void 0!==r?r:e[1])}function Vr(e,t,n){var r=Rr(t)&&n,i=r?Kr(e):e,o=r?t.map(Kr):t,a=i;return o.forEach((function(e){var t=Math.abs(i-a);Math.abs(i-e)>t&&(a=e)})),Wt(a,void 0,n)}function zr(e,t){var n,r,i,o,a=Nr([e,t]),s=null!==(n=e.lat)&&void 0!==n?n:e[0],u=null!==(r=e.lng)&&void 0!==r?r:e[1],l=a?Kr(u):u,c=null!==(i=t.lat)&&void 0!==i?i:t[0],f=null!==(o=t.lng)&&void 0!==o?o:t[1],d=a?Kr(f):f;return c>s?d<l?"nw":"ne":d>l?"se":"sw"}function Kr(e){return e<0?e+360:e}function Zr(e,t,n,r,i,o){var a;if(n===o)a=Math.pow(r-e,2)+Math.pow(i-t,2);else if(n>o){var s=1<<n-o;a=Math.pow(r-e/s,2)+Math.pow(i-t/s,2)}else{var u=1<<o-n;a=Math.pow(r/u-e,2)+Math.pow(i/u-t,2)}return Math.sqrt(a)}function Hr(e,t){var n=e+t/Ir*(180/Math.PI);return n<-180?n+360:n>180?n-360:n}function qr(e){var t=null==e?void 0:e.type;if(["Polygon","MultiPolygon"].includes(t)){var n=[];"Polygon"===t?n.push(e.coordinates):n.push.apply(n,Or(e.coordinates));var r=[];return n.forEach((function(e){var t=[];e.forEach((function(e){var n=[];e.forEach((function(e){var t=Fr(e,2),r=t[0],i=t[1];return n.push({lat:i,lng:r})})),t.push(n)})),r.push(t)})),r}throw new Error("Geometry ".concat(t," not supported"))}function Wr(e){return function(e){if(Array.isArray(e))return Gr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Gr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qr={imageLoaded:"load",imageLoadingError:"error"};function $r(e){var t=new RegExp(/(.*?)[\w,\s-]+\.(gif|jpe?g|tiff?|png|webp|bmp|svg)$/),n=new Set;return e.forEach((function(e){Y(e)?pe(e,(function(e){var t;return"IMG"===(null===(t=e.tagName)||void 0===t?void 0:t.toUpperCase())}),!0).forEach((function(e){var r=e.element.src;r&&t.test(r)&&n.add(r)})):t.test(e)&&n.add(e)})),Wr(n)}function Xr(e,t,n){var r=[];return e.forEach((function(e){var i=new Image;i.src=e,r.push(ei(i,t,n))})),$n(r).then((function(){return Promise.resolve()}))}function Yr(e){var t=new Set;return Object.keys(e).forEach((function(n){var r=e[n];Object.keys(r).forEach((function(e){var n=r[e];Object.keys(n).forEach((function(e){var r=n[e];r&&"none"!==r&&t.add(r)}))}))})),Wr(t)}function Jr(e){var t=new Set;return Object.keys(e).forEach((function(n){var r=e[n];Object.keys(r).forEach((function(e){var n=r[e];n&&"none"!==n&&t.add(n)}))})),Wr(t)}function ei(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(i,o){t(e,Qr.imageLoaded,i),t(e,Qr.imageLoadingError,(function(t){r?(n.debug("failed to load image ".concat(e.src),null==t?void 0:t.stack),i()):o(new Error("failed to load image ".concat(e.src,". ").concat(t)))}))}))}function ti(e,t,n){return Y(t)&&(!Y(e)||J(t)!==J(e))||!Y(t)&&(Y(e)||n&&t!==e)}function ni(e){return ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ni(e)}function ri(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==ni(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ni(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===ni(i)?i:String(i)),r)}var i}var ii=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"_buildClusterService",value:function(e,t,n,r,i,o,a){var s=i.type;if(s)switch(s){case"supercluster":return new In(e,this._createClusterLabelMethod(t,n,r),i,o,a);case"none":return;default:throw new Error("Unknown cluster type ".concat(s))}}},{key:"createClusterers",value:function(e,t,n,r,i,o){var a=this,s={};return Object.keys(o).forEach((function(u){s[u]=[];var l=i[u],c=o[u];pn(Object.keys(l)).forEach((function(i){var o=l[i],f=a._buildClusterService(e,t,n,r,o,c,i);f&&s[u].push({qualifier:i,clusterer:f})}))})),s}},{key:"_createClusterLabelMethod",value:function(e,t,n){return function(r,i,o){var a=void 0!==i,s=e(o,r);if(a&&-1!==s.indexOf("{1}")){var u=Cn(i,void 0,t,n);return e(o,r,u)}return s}}}])&&ri(t.prototype,n),r&&ri(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),oi=n(597),ai=n.n(oi);function si(e){return si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},si(e)}function ui(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return li(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?li(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function li(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ci(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==si(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==si(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===si(i)?i:String(i)),r)}var i}var fi={boundsChanged:"boundsChanged",markersChanged:"markersChanged",selectionChanged:"selectionChanged",hoverChanged:"hoverChanged",keyPressed:"keyPressed",featureContentLoaded:"featureContentLoaded",idle:"idle",routeChanged:"routeChanged",tilesLoaded:"tilesLoaded",tilesContentLoaded:"tilesContentLoaded",mapTypeChanged:"mapTypeChanged"},di=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registeredListeners=[],this.logger=t}var t,n,r;return t=e,(n=[{key:"pushEvent",value:function(e,t){this.logger.debug("pushing event: ".concat(e));var n,r=ui(this.registeredListeners);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.eventType===e&&i.callback(t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_registerInternalListener",value:function(e,t,n){var r,i;if(t&&(n?(null!==(i=r=this._findInternalListener(e,void 0,n))&&void 0!==i&&i.id&&this._unregisterInternalListener(e,void 0,n),r=void 0):r=this._findInternalListener(e,t,void 0),!r)){var o={id:n,eventType:e,callback:t};return this.registeredListeners.push(o),o}}},{key:"_identifyListener",value:function(e,t,n,r){return!(e.eventType!==t||r&&e.id!==r||n&&e.callback!==n)}},{key:"_findInternalListener",value:function(e,t,n){var r=this;if(!n&&!t)throw new Error("Can't find a listener with no id and no callback provided");return this.registeredListeners.find((function(i){return r._identifyListener(i,e,t,n)}))}},{key:"_unregisterInternalListener",value:function(e,t,n){var r=this,i=this._findInternalListener(e,t,n);return i&&(this.registeredListeners=this.registeredListeners.filter((function(i){return!r._identifyListener(i,e,t,n)}))),i}},{key:"addBoundChangeListener",value:function(e,t){return!!this._registerInternalListener(fi.boundsChanged,e,t)}},{key:"removeBoundChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.boundsChanged,e)}},{key:"deregisterBoundChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.boundsChanged,void 0,e)}},{key:"addMarkerChangeListener",value:function(e,t){return!!this._registerInternalListener(fi.markersChanged,e,t)}},{key:"removeMarkerChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.markersChanged,e)}},{key:"deregisterMarkerChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.markersChanged,void 0,e)}},{key:"addSelectionChangeListener",value:function(e,t){return!!this._registerInternalListener(fi.selectionChanged,e,t)}},{key:"removeSelectionChangeListener",value:function(e,t){return!!this._unregisterInternalListener(fi.selectionChanged,e,t)}},{key:"deregisterSelectionChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.selectionChanged,void 0,e)}},{key:"addKeyPressListener",value:function(e,t){return!!this._registerInternalListener(fi.keyPressed,e,t)}},{key:"removeKeyPressListener",value:function(e){return!!this._unregisterInternalListener(fi.keyPressed,e)}},{key:"deregisterKeyPressListener",value:function(e){return!!this._unregisterInternalListener(fi.keyPressed,void 0,e)}},{key:"addHoverChangeListener",value:function(e,t){return!!this._registerInternalListener(fi.hoverChanged,e,t)}},{key:"removeHoverChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.hoverChanged,e)}},{key:"deregisterHoverChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.hoverChanged,void 0,e)}},{key:"addFeatureContentLoadedListener",value:function(e,t){return!!this._registerInternalListener(fi.featureContentLoaded,e,t)}},{key:"removeFeatureContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(fi.featureContentLoaded,e)}},{key:"deregisterFeatureContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(fi.featureContentLoaded,void 0,e)}},{key:"addIdleListener",value:function(e,t){return!!this._registerInternalListener(fi.idle,e,t)}},{key:"removeIdleListener",value:function(e){return!!this._unregisterInternalListener(fi.idle,e)}},{key:"deregisterIdleListener",value:function(e){return!!this._unregisterInternalListener(fi.idle,void 0,e)}},{key:"addRouteChangeListener",value:function(e,t){return!!this._registerInternalListener(fi.routeChanged,e,t)}},{key:"removeRouteChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.routeChanged,e)}},{key:"deregisterRouteChangeListener",value:function(e){return!!this._unregisterInternalListener(fi.routeChanged,void 0,e)}},{key:"addTilesLoadedListener",value:function(e,t){return!!this._registerInternalListener(fi.tilesLoaded,e,t)}},{key:"removeTilesLoadedListener",value:function(e){return!!this._unregisterInternalListener(fi.tilesLoaded,e)}},{key:"deregisterTilesLoadedListener",value:function(e){return!!this._unregisterInternalListener(fi.tilesLoaded,void 0,e)}},{key:"addTilesContentLoadedListener",value:function(e,t){return!!this._registerInternalListener(fi.tilesContentLoaded,e,t)}},{key:"removeTilesContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(fi.tilesContentLoaded,e)}},{key:"deregisterTilesContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(fi.tilesContentLoaded,void 0,e)}},{key:"addMapTypeChangedListener",value:function(e,t){return!!this._registerInternalListener(fi.mapTypeChanged,e,t)}},{key:"deregisterMapTypeChangedListener",value:function(e){return!!this._unregisterInternalListener(fi.mapTypeChanged,void 0,e)}}])&&ci(t.prototype,n),r&&ci(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function hi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||yi(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pi(e){return function(e){if(Array.isArray(e))return vi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||yi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yi(e,t){if(e){if("string"==typeof e)return vi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vi(e,t):void 0}}function vi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gi(e){return gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gi(e)}function mi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==gi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==gi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===gi(i)?i:String(i)),r)}var i}function ki(e,t,n){return t&&bi(e.prototype,t),n&&bi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var wi=function(){function e(t,n,r){mi(this,e),this.id=an(),this.origin=t,this.destination=n,this.mode=r,this.distance=void 0}return ki(e,[{key:"toString",value:function(){var e;return"Route: {origin:'".concat(this.origin.id,"',destination:").concat(null===(e=this.destination)||void 0===e?void 0:e.id,",mode:").concat(this.mode,"}")}},{key:"originLatLng",value:function(){return{lat:this.origin.latLng[0],lng:this.origin.latLng[1]}}},{key:"destinationLatLng",value:function(){return this.destination?{lat:this.destination.latLng[0],lng:this.destination.latLng[1]}:void 0}}]),e}(),Pi=function(){function e(t,n,r){var i=t.logger,o=t.egDistances,a=t.routeLineStyleByDistanceMode,s=t.routeCacheInMs,u=t.findFeature,l=t.eventsManager,c=t.addRouteOnMap,f=t.removeRouteOnMap,d=t.asKey;mi(this,e),this.routes=n,this.routeDestinations=r,this.logger=i,this.egDistances=o,this.routeLineStyleByDistanceMode=a,this.findFeature=u,this.eventsManager=l,this.addRouteOnMap=c,this.removeRouteOnMap=f,this.asKey=d,this.routeCache=xr(s,void 0,(function(e,t,n){return"polyline"!==n[0]&&e}))}return ki(e,[{key:"_asRoute",value:function(e,t){var n,r,i={origin:(null===(n=this.findFeature(e.origin.id,e.origin.type))||void 0===n?void 0:n.toData())||{id:e.origin.id,type:e.origin.type},destination:e.destination?(null===(r=this.findFeature(e.destination.id,e.destination.type))||void 0===r?void 0:r.toData())||{id:e.destination.id,type:e.destination.type}:void 0,transportMode:e.mode};return t&&(i.distance=e.distance),i}},{key:"_asRouteDestinationFeature",value:function(e){var t=e.idAndType,n=t.id,r=t.type;return{destination:n&&r?this.findFeature(n,r):void 0,transportMode:e.transportMode}}},{key:"_asRouteDestination",value:function(e){return{idAndType:{id:e.destination.id,type:e.destination.type},transportMode:e.mode}}},{key:"_routeDestinationAsKey",value:function(e){var t=e.idAndType,n=t.id,r=t.type,i=e.transportMode;return"".concat(n,"|").concat(r,"|").concat(i)}},{key:"_buildCacheKeys",value:function(e,t,n,r){var i=[];return i.push(e),t&&i.push("".concat(t.id,"|").concat(t.type)),n&&i.push("".concat(n.id,"|").concat(n.type)),r&&i.push(r),i}},{key:"_sameRoute",value:function(e,t){var n,r,i,o;return e.origin.id===t.origin.id&&e.origin.type===t.origin.type&&(null===(n=e.destination)||void 0===n?void 0:n.id)===(null===(r=t.destination)||void 0===r?void 0:r.id)&&(null===(i=e.destination)||void 0===i?void 0:i.type)===(null===(o=t.destination)||void 0===o?void 0:o.type)&&e.mode===t.mode}},{key:"_sameFeature",value:function(e,t){return e.id===t.id&&e.type===t.type}},{key:"_sameRouteDestination",value:function(e,t){return e.idAndType.id===t.idAndType.id&&e.idAndType.type===t.idAndType.type&&e.transportMode===t.transportMode}},{key:"showRoutes",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._asRouteDestinationFeature.bind(this);return $n((t&&t.length>0?t.map(i):[].concat(pi(this.listRegisteredRoutes(e).map((function(e){var t=e.destination;return{destination:t.idAndType,transportMode:t.transportMode}}))),pi(this.routeDestinations))).map((function(t){return new wi(e,t.destination,t.transportMode)})).filter((function(e){return!n.routes.some((function(t){return n._sameRoute(t,e)}))&&!n._sameFeature(e.origin,e.destination)})).map((function(t){return new Promise((function(r,i){var o,a,s=t.destination,u=t.mode,l="none"===n.routeLineStyleByDistanceMode[t.mode].lineStyle,c=l?void 0:(o=n.routeCache).get.apply(o,pi(n._buildCacheKeys("polyline",e,s,u)));if(c)a=Promise.resolve(c);else{var f,d=n._buildCacheKeys(l?"distance":"route",e,s,u),h=(f=n.routeCache).get.apply(f,pi(d));if(h)a=Promise.resolve(h);else{if(!n.egDistances)return Promise.reject("EGDistances is not enabled: routes or distances can't be computed on demand");a=l?n.fetchDistance(t,d):n.fetchRoute(t,d)}}a.then((function(e){var t=e.route,i=e.egDistanceRoute,o=e.routeResult;t&&(n.routes.push(t),i?n.addRouteOnMap(t,i).then((function(e){return r(t)})):o?n.addRouteOnMap(t,o).then((function(e){return r(t)})):r(t))})).catch((function(e){return i({error:e,route:t})}))}))}))).then((function(e){var t=e.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})).filter((function(e){return void 0!==e}));e.filter((function(e){return"rejected"===e.status})).forEach(n._handleReject.bind(n));var i=t.map((function(e){return n._asRoute(e,!0)}));return r&&i.length>0&&n._handleRouteChanged(!0,i),i}))}},{key:"fetchDistance",value:function(e,t){var n=this;return this.egDistances.getDistances(e.originLatLng(),e.destinationLatLng(),e.mode).then((function(r){if("SUCCESS"===r.status){var i;e.distance=r.matrix[0][0].modes[e.mode];var o={route:e};return(i=n.routeCache).set.apply(i,[o].concat(pi(t))),o}throw new Error(r.errors.join(", "))}))}},{key:"handleFlight",value:function(e){var t=e.originLatLng(),n=e.destinationLatLng(),r=e;return r.copyrights="",r.warnings="",r.status="SUCCESS",r.route={path:[t,n],mode:r.mode},Promise.resolve(r)}},{key:"fetchRoute",value:function(e,t){var n=this;return("flying"==e.mode?this.handleFlight(e):this.egDistances.getRoute(e.originLatLng(),e.destinationLatLng(),e.mode)).then((function(r){if("SUCCESS"===r.status){var i;e.distance=r.route.distance;var o={route:e,egDistanceRoute:r};return(i=n.routeCache).set.apply(i,[o].concat(pi(t))),o}throw new Error(r.error)}))}},{key:"registerRoute",value:function(e,t,n){var r=t.idAndType,i=t.transportMode,o=this._buildCacheKeys("polyline",e,r,i);if(!this._sameFeature(e,r)){var a=this.findFeature(e.id,e.type),s=this.findFeature(r.id,r.type);if(a&&s){var u,l=new wi(a,s,i),c={route:{path:ai().decode(n).map((function(e){var t=hi(e,2);return{lat:t[0],lng:t[1]}}))}};return(u=this.routeCache).set.apply(u,[{route:l,routeResult:c}].concat(pi(o))),!0}}return!1}},{key:"updateRoutesOnViewport",value:function(){var e=this,t=pi(this.routes);return this.hideRoutes().then((function(){return Promise.all(t.map((function(t){return e.showRoutes(t.origin,[e._asRouteDestination(t)],!1)})))})).then((function(){}))}},{key:"listRegisteredRoutes",value:function(e){var t,n=this,r=this._buildCacheKeys("polyline",e);return(t=this.routeCache).keys.apply(t,pi(r)).flatMap((function(e){var t,r=(t=n.routeCache).get.apply(t,pi(e));if(r){var i=r.route,o=r.routeResult;return[{origin:{id:i.origin.id,type:i.origin.type},destination:{idAndType:{id:i.destination.id,type:i.destination.type},transportMode:i.mode},polyline:ai().encode(o.route.path)}]}return[]}))}},{key:"deregisterRoute",value:function(e,t){var n=this,r=this.listRegisteredRoutes(e).filter((function(e){var r=e.destination;return!t||n._sameRouteDestination(r,t)})).map((function(e){var t,r=e.origin,i=e.destination,o=n._buildCacheKeys("polyline",r,i.idAndType,i.transportMode);return(t=n.routeCache).set.apply(t,[void 0].concat(pi(o))),e}));if(r){var i=this.findFeature(e.id,e.type);this.hideRoutes(i,r.map((function(e){return e.destination})))}return r}},{key:"_handleReject",value:function(e){var t=e.reason,n=t.message,r=t.stack,i=t.error,o=t.route;i?/OVER_QUERY_LIMIT/.test(null==i?void 0:i.message)?this.logger.info("Error when showing route ".concat(o,": ").concat(i.message),i.stack):this.logger.warn("Error when showing route ".concat(o,": ").concat(i.message),i.stack):n&&this.logger.error("Error when showing route ".concat(n),r)}},{key:"hideRoutes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._asRoute.bind(this),o=this.asKey,a=n.length>0?n.map((function(e){return"".concat(t.asKey(e.idAndType),"-").concat(e.transportMode)})):void 0;return Promise.all(this.routes.filter((function(t){return(!e||t.origin.id===e.id&&t.origin.type===e.type)&&(!a||a.includes("".concat(o(t.destination),"-").concat(t.mode)))})).map((function(e){return t.removeRouteOnMap(e).then((function(){return t.routes.splice(t.routes.findIndex((function(t){return e===t})),1),e}))}))).then((function(e){return r&&e.length>0&&t._handleRouteChanged(!1,e),e.map((function(e){return i(e)}))}))}},{key:"listRoutesDisplayed",value:function(){var e=this;return this.routes.map((function(t){return e._asRoute(t,!0)}))}},{key:"_handleRouteChanged",value:function(e,t){var n={routes:t,action:e?"show":"hide"};this.eventsManager.pushEvent(fi.routeChanged,n)}},{key:"registerRouteDestination",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n;if(null===(n=e.listRegisteredRouteDestinations())||void 0===n||!n.map(e._routeDestinationAsKey).includes(e._routeDestinationAsKey(t))){var r=t.idAndType,i=r.id,o=r.type,a=t.transportMode,s=e.findFeature(i,o);s&&e.routeDestinations.push({destination:s,transportMode:a})}}))}},{key:"listRegisteredRouteDestinations",value:function(){return this.routeDestinations.flatMap((function(e){var t=e.destination,n=e.transportMode;return t?[{idAndType:{id:t.id,type:t.type},transportMode:n}]:[]}))}},{key:"deregisterRouteDestination",value:function(){for(var e=this,t=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){var r=n.idAndType,i=r.id,o=r.type,a=n.transportMode,s=e.routeDestinations.findIndex((function(e){return e.destination&&e.destination.id===i&&e.destination.type===o&&e.transportMode===a}));s>=0&&(e.routeDestinations.splice(s,1),t.push(n))})),this.hideRoutes(void 0,t),t}}]),e}();function Ci(e){return Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ci(e)}function Li(e){return function(e){if(Array.isArray(e))return Mi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mi(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Ci(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ci(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===Ci(i)?i:String(i)),r)}var i}var xi=Tt,Oi=Zt,Fi=function(){function e(t){var n=t.logger,r=t.findFeature,i=t.addPolygonsOnMap,o=t.removePolygonsOnMap,a=t.asKey,s=t.polygons,u=t.polygonStyles;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=n,this.findFeature=r,this.addPolygonsOnMap=i,this.removePolygonsOnMap=o,this.asKey=a,this.polygons=s,this.polygonStyles=u,this.polygons.length>0&&this.showPolygons.apply(this,Li(this.polygons))}var t,n,r;return t=e,n=[{key:"_isPolygonDisplayed",value:function(e){var t=this;return this.polygons.some((function(n){return t.asKey(n)===t.asKey(e)}))}},{key:"_isPolygonNotDisplayed",value:function(e){return!this._isPolygonDisplayed(e)}},{key:"showPolygons",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Oi(n.filter(this._isPolygonNotDisplayed.bind(this))),o=this._findPolygonToDisplay(i);return this.addPolygonsOnMap(o).then((function(t){var n;return(n=e.polygons).push.apply(n,Li(t)),t}))}},{key:"hidePolygons",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.length>0?n.filter(this._isPolygonDisplayed.bind(this)):Li(this.polygons);return this.removePolygonsOnMap(i).then((function(t){return t.forEach((function(t){e.polygons.splice(e.polygons.indexOf(t),1)})),t}))}},{key:"_findPolygonToDisplay",value:function(e){var t=this;return e.map((function(e){var n=e.id,r=e.type,i=t.findFeature(n,r);if(i&&i.polygon){var o=xi(t.polygonStyles[r],i.hashKeys);return{polygonDisplayed:{id:n,type:r,polygon:i.polygon},style:o}}})).filter((function(e){return void 0!==e}))}},{key:"listPolygonsDisplayed",value:function(){return this._findPolygonToDisplay(this.polygons).map((function(e){return e.polygonDisplayed}))}},{key:"updatePolygonsOnViewport",value:function(){var e=this,t=Li(this.polygons);return this.hidePolygons().then((function(){return e.showPolygons.apply(e,Li(t))})).then((function(){}))}}],n&&_i(t.prototype,n),r&&_i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Si(e,t){return!!t&&e.from===t.from&&e.to===t.to&&Yt(e.roomOccupancies,t.roomOccupancies,!1,(function(e,t){return function(e,t){return(e.nbAdults||0)===(t.nbAdults||0)&&Yt(e.childrenAges||[],t.childrenAges||[])}(e,t)}))}function Ei(e){return Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(e)}function Ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Ei(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ei(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===Ei(i)?i:String(i)),r)}var i}var Ai,Ti=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.availabilityProvider=n,this.logger=t("AvailabilityCheck"),this.availabilityProvider=void 0,this.featureComputationInProgress=new Map,this.stay=void 0}var t,n,r;return t=e,n=[{key:"saveStay",value:function(e){return!(!e||this.stay&&Si(e,this.stay)||(this.stay=e,this.featureComputationInProgress.clear(),0))}},{key:"isAvailabilityCheckActive",value:function(){return void 0!==this.availabilityProvider&&void 0!==this.stay}},{key:"updateAvailability",value:function(e){var t=this;if(!this.isAvailabilityCheckActive())return Promise.resolve([]);for(var n=this.stay,r=[],i=Date.now(),o=e.length,a=new Map,s=0;s<o;s++){var u=e[s],l=u.id;!this.featureComputationInProgress.has(l)&&u.hasTileData()&&"unknown"===u.toTileData().status&&(r.push(l),a.set(l,s),this.featureComputationInProgress.set(l,i))}if(0===r.length)return Promise.resolve([]);for(var c=[],f=Kt(r,300),d=f.length,h=0;h<d;h++)c.push(this.availabilityProvider.checkAvailability(n,f[h]));return $n(c).then((function(r){return r.filter((function(e){return"rejected"===e.status})).forEach((function(e){t.logger.error("Check availability failed with result ".concat(e.reason))})),r.filter((function(e){return"fulfilled"===e.status})).map((function(r){return r.value.map((function(r){var i=a.get(r.id);if(i>=0&&t.stay===n){var o=e[i];return o.mergeTileData(r),o}})).filter((function(e){return void 0!==e}))})).flat()})).finally((function(){r.forEach((function(e){return t.featureComputationInProgress.delete(e)}))}))}}],n&&Ii(t.prototype,n),r&&Ii(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Di={variant:"var",defaultClusterProductLabel:"prodClusterLbl",defaultClusterPropertyLabel:"propClusterLbl",defaultClusterPlaceLabel:"placeClusterLbl",keyboardFeaturesNoData:"keybFeatNoData",keyboardFeaturesPreviousPage:"keybFeatPrev",keyboardFeaturesNextPage:"keybFeatNext",filterBoxLegend:"fboxLegend",ariaFilterBoxToggleLegend:"ariaFboxTglLegend",ariaFilterBoxImgProductAvailable:"ariaFboxImgProdAvailable",ariaFilterBoxImgProductFiltered:"ariaFboxImgProdFiltered",ariaFilterBoxImgProductSoldOut:"ariaFboxImgProdSoldOut",ariaFilterBoxImgProductUnknown:"ariaFboxImgProdUnknown",ariaFilterBoxImgPropertyAvailable:"ariaFboxImgPropAvailable",ariaFilterBoxImgPropertyFiltered:"ariaFboxImgPropFiltered",ariaFilterBoxImgPropertySoldOut:"ariaFboxImgPropSoldOut",ariaFilterBoxImgPropertyUnknown:"ariaFboxImgPropUnknown",ariaFilterBoxCheckBoxProductAvailable:"ariaFboxCbProdAvailable",ariaFilterBoxCheckBoxProductFiltered:"ariaFboxCbProdFiltered",ariaFilterBoxCheckBoxProductSoldOut:"ariaFboxCbProdSoldOut",ariaFilterBoxCheckBoxProductUnknown:"ariaFboxCbProdUnknown",ariaFilterBoxCheckBoxPropertyAvailable:"ariaFboxCbPropAvailable",ariaFilterBoxCheckBoxPropertyFiltered:"ariaFboxCbPropFiltered",ariaFilterBoxCheckBoxPropertySoldOut:"ariaFboxCbPropSoldOut",ariaFilterBoxCheckBoxPropertyUnknown:"ariaFboxCbPropUnknown",filterBoxProductAvailable:"fboxProductAvailable",filterBoxProductFiltered:"fboxProductFiltered",filterBoxProductSoldOut:"fboxProductSoldOut",filterBoxProductUnknown:"fboxProductUnknown",filterBoxPropertyAvailable:"fboxPropertyAvailable",filterBoxPropertyFiltered:"fboxPropertyFiltered",filterBoxPropertySoldOut:"fboxPropertySoldOut",filterBoxPropertyUnknown:"fboxPropertyUnknown",filterBoxPlaceUnknown:"fboxPlaceUnknown",ariaFilterBoxImgPlaceUnknown:"ariaFboxImgPlaceUnknown",ariaFilterBoxCheckBoxPlaceUnknown:"ariaFboxCbPlaceUnknown"};function ji(e){return ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ji(e)}function Bi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ji(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ji(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ji(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ri=(Bi(Ai={},Di.variant,"default"),Bi(Ai,Di.defaultClusterProductLabel,"{0} products"),Bi(Ai,Di.defaultClusterPropertyLabel,"{0} properties"),Bi(Ai,Di.defaultClusterPlaceLabel,"{0} places"),Bi(Ai,Di.keyboardFeaturesNoData,"no data"),Bi(Ai,Di.keyboardFeaturesPreviousPage,"Show previous..."),Bi(Ai,Di.keyboardFeaturesNextPage,"Show next..."),Bi(Ai,Di.filterBoxLegend,"Legend"),Bi(Ai,Di.ariaFilterBoxToggleLegend,"Toggle legend"),Bi(Ai,Di.ariaFilterBoxImgProductAvailable,"icon used for products matching dates and criteria"),Bi(Ai,Di.ariaFilterBoxImgProductFiltered,"icon used for products matching dates but not your criteria"),Bi(Ai,Di.ariaFilterBoxImgProductSoldOut,"icon used for products not available for these dates"),Bi(Ai,Di.ariaFilterBoxImgProductUnknown,"icon used for products with no availability information for these dates"),Bi(Ai,Di.ariaFilterBoxImgPropertyAvailable,"icon used for properties matching dates and criteria"),Bi(Ai,Di.ariaFilterBoxImgPropertyFiltered,"icon used for properties matching dates but not your criteria"),Bi(Ai,Di.ariaFilterBoxImgPropertySoldOut,"icon used for properties not available for these dates"),Bi(Ai,Di.ariaFilterBoxImgPropertyUnknown,"icon used for properties with no availability information for these dates"),Bi(Ai,Di.ariaFilterBoxCheckBoxProductAvailable,"filter products matching dates and criteria"),Bi(Ai,Di.ariaFilterBoxCheckBoxProductFiltered,"filter products matching dates but not your criteria"),Bi(Ai,Di.ariaFilterBoxCheckBoxProductSoldOut,"filter products sold out for these dates"),Bi(Ai,Di.ariaFilterBoxCheckBoxProductUnknown,"filter products with no availability information for these dates"),Bi(Ai,Di.ariaFilterBoxCheckBoxPropertyAvailable,"filter properties matching dates and criteria"),Bi(Ai,Di.ariaFilterBoxCheckBoxPropertyFiltered,"filter properties matching dates but not your criteria"),Bi(Ai,Di.ariaFilterBoxCheckBoxPropertySoldOut,"filter properties sold out for these dates"),Bi(Ai,Di.ariaFilterBoxCheckBoxPropertyUnknown,"filter properties with no availability information for these dates"),Bi(Ai,Di.filterBoxProductAvailable,"Matches dates and criteria"),Bi(Ai,Di.filterBoxProductFiltered,"Doesnt match your criteria"),Bi(Ai,Di.filterBoxProductSoldOut,"Sold out for these dates"),Bi(Ai,Di.filterBoxProductUnknown,"Availability unknown"),Bi(Ai,Di.filterBoxPropertyAvailable,"Matches dates and criteria"),Bi(Ai,Di.filterBoxPropertyFiltered,"Doesnt match your criteria"),Bi(Ai,Di.filterBoxPropertySoldOut,"Sold out for these dates"),Bi(Ai,Di.filterBoxPropertyUnknown,"Availability unknown"),Bi(Ai,Di.filterBoxPlaceUnknown,"Places"),Bi(Ai,Di.ariaFilterBoxImgPlaceUnknown,"icon used for places"),Bi(Ai,Di.ariaFilterBoxCheckBoxPlaceUnknown,"filter places"),Ai);function Ni(e){return Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ni(e)}var Ui,Vi,zi,Ki=(Ui={},zi="en-US",(Vi=function(e){var t=function(e,t){if("object"!==Ni(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ni(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ni(t)?t:String(t)}(Vi=Di.variant))in Ui?Object.defineProperty(Ui,Vi,{value:zi,enumerable:!0,configurable:!0,writable:!0}):Ui[Vi]=zi,Ui);function Zi(e){return Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zi(e)}var Hi,qi=function(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Zi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Zi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Zi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},Di.variant,"en");function Wi(e){return Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wi(e)}function Gi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Wi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Wi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Wi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qi={default:Ri,"en-US":Ki,en:qi,fr:(Gi(Hi={},Di.variant,"fr"),Gi(Hi,Di.defaultClusterProductLabel,"{0} tablissements"),Gi(Hi,Di.defaultClusterPropertyLabel,"{0} tablissements"),Gi(Hi,Di.defaultClusterPlaceLabel,"{0} points d'intrt"),Gi(Hi,Di.keyboardFeaturesNoData,"Pas de donnes"),Gi(Hi,Di.keyboardFeaturesPreviousPage,"Afficher les prcdents..."),Gi(Hi,Di.keyboardFeaturesNextPage,"Afficher les suivants..."),Gi(Hi,Di.filterBoxLegend,"Lgende"),Gi(Hi,Di.ariaFilterBoxToggleLegend,"Afficher la lgende"),Gi(Hi,Di.ariaFilterBoxImgProductAvailable,"icne pour les tablissements disponibles et vrifiant les critres"),Gi(Hi,Di.ariaFilterBoxImgProductFiltered,"icne pour les tablissements disponibles mais ne vrifiant pas les critres"),Gi(Hi,Di.ariaFilterBoxImgProductSoldOut,"icne pour les tablissements non disponibles pour les dates"),Gi(Hi,Di.ariaFilterBoxImgProductUnknown,"icne pour les tablissements sans information de disponibilit"),Gi(Hi,Di.ariaFilterBoxImgPropertyAvailable,"icne pour les tablissements disponibles et vrifiant les critres"),Gi(Hi,Di.ariaFilterBoxImgPropertyFiltered,"icne pour les tablissements disponibles mais ne vrifiant pas les critres"),Gi(Hi,Di.ariaFilterBoxImgPropertySoldOut,"icne pour les tablissements non disponibles pour les dates"),Gi(Hi,Di.ariaFilterBoxImgPropertyUnknown,"icne pour les tablissements sans information de disponibilit"),Gi(Hi,Di.ariaFilterBoxCheckBoxProductAvailable,"filtre pour les tablissements disponibles et vrifiant les critres"),Gi(Hi,Di.ariaFilterBoxCheckBoxProductFiltered,"filtre pour les tablissements disponibles mais ne vrifiant pas les critres"),Gi(Hi,Di.ariaFilterBoxCheckBoxProductSoldOut,"filtre pour les tablissements non disponibles pour les dates"),Gi(Hi,Di.ariaFilterBoxCheckBoxProductUnknown,"filtre pour les tablissements sans information de disponibilit"),Gi(Hi,Di.ariaFilterBoxCheckBoxPropertyAvailable,"filtre pour les tablissements disponibles et vrifiant les critres"),Gi(Hi,Di.ariaFilterBoxCheckBoxPropertyFiltered,"filtre pour les tablissements disponibles mais ne vrifiant pas les critres"),Gi(Hi,Di.ariaFilterBoxCheckBoxPropertySoldOut,"filtre pour les tablissements non disponibles pour les dates"),Gi(Hi,Di.ariaFilterBoxCheckBoxPropertyUnknown,"filtre pour les tablissements sans information de disponibilit"),Gi(Hi,Di.filterBoxProductAvailable,"Disponibles"),Gi(Hi,Di.filterBoxProductFiltered,"Disponibles mais filtrs"),Gi(Hi,Di.filterBoxProductSoldOut,"Indisponible"),Gi(Hi,Di.filterBoxProductUnknown,"Disponibilit inconnue"),Gi(Hi,Di.filterBoxPropertyAvailable,"Disponibles"),Gi(Hi,Di.filterBoxPropertyFiltered,"Disponibles mais filtrs"),Gi(Hi,Di.filterBoxPropertySoldOut,"Indisponible"),Gi(Hi,Di.filterBoxPropertyUnknown,"Disponibilit inconnue"),Gi(Hi,Di.filterBoxPlaceUnknown,"Points d'intrt"),Gi(Hi,Di.ariaFilterBoxImgPlaceUnknown,"icne pour les point d'intrts"),Gi(Hi,Di.ariaFilterBoxCheckBoxPlaceUnknown,"filtre pour les point d'intrts"),Hi)};function $i(e){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$i(e)}function Xi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ji(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eo(r.key),r)}}function eo(e){var t=function(e,t){if("object"!==$i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==$i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===$i(t)?t:String(t)}var to,no=["1","2","3","4","5","6","7","8","9"],ro={cluster:{available:9,filtered:7,sold_out:3,unknown:1},product:{available:10,filtered:8,sold_out:4,unknown:2},property:{available:10,filtered:8,sold_out:4,unknown:2},place:{unknown:5}},io="keydown",oo="keypress",ao="no-data",so="keyboard-features-enabled",uo="keyboard-features-list",lo="keyboard-features-list-element",co="keyboard-features-list-element-info",fo="keyboard-features-list-element-number",ho="keyboard-features-list-element-div",po="keyboard-features-list-nav",yo="keyboard-features-not-in-list-marker",vo="kbc-button",go=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyboardFeaturesIcon=t,this.getI18N=n,this.keyboardNavigationMode=!1,this.keyPressZero=48,this.keyDownBackspace=8,this.pageIndex=0,this.pageCount=0,this.uiElementIds=[]}var t,n,r;return t=e,n=[{key:"init",value:function(e){var t=e.node,n=e.uniqId,r=e.containerBounds,i=e.listFeatures,o=e.cloneMarker,a=e.zIndexes,s=e.maxZIndex,u=e.getMapNavFocusElement,l=e.registerListenerOnMapFocusElement,c=e.handleClick,f=e.actionsOnClick,d=e.isFeatureSelected,h=e.clearSelectedFeature;this.node=t,this.containerBounds=r,this.listFeatures=i,this.cloneMarker=o,this.zIndexes=a,this.maxZIndex=s,this.getMapNavFocusElement=u,this.registerListenerOnMapFocusElement=l,this.handleClick=c,this.actionsOnClick=f,this.isFeatureSelected=d,this.clearSelectedFeature=h;var p=n("keyboard-features");this._createKeyboardFeaturesIcon(p),this._createKeyboardFeaturesSquare(p),this._createKeyboardFeaturesList(p),this._initializeListeners()}},{key:"removeAllUIElements",value:function(){var e=this;this.uiElementIds.forEach((function(t){return ge(e.node,t)}))}},{key:"_createKeyboardFeaturesIcon",value:function(e){var t="".concat(e,"-icon");this.keyboardIcon=we(t,this.node,"keyboard-features-icon",void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ze(this.keyboardIcon);var n=this.keyboardFeaturesIcon;Ne(Se("".concat(e,"-img"),this.keyboardIcon,"keyboard-features-icon-img",void 0,n,"icon to show that keyboard features is enabled")),Ge(this.keyboardIcon,this.maxZIndex+1)}},{key:"_createKeyboardFeaturesSquare",value:function(e){var t="".concat(e,"-focus");this.focusArea=we(t,this.node,"".concat("keyboard-features-focus-area"),void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ze(this.focusArea),Ge(this.focusArea,this.maxZIndex+1)}},{key:"_createKeyboardFeaturesList",value:function(e){var t="".concat(e,"-features");this.keybNavFeatures=we(t,this.node,"keyboard-features-dialog",void 0),this.uiElementIds.push(t),this.keybNavFeaturesList=Pe("".concat(e,"-list"),this.keybNavFeatures,"".concat(uo," ").concat(ao),void 0),this.keybNavFeaturesElements=[];for(var n=0;n<7;n++){var r=Ce("".concat(e,"-elt-").concat(n+1),this.keybNavFeaturesList,"".concat(lo," ").concat(ao),void 0);_e("".concat(r.id,"-info"),r,co,void 0,"-"),this.keybNavFeaturesElements.push(r)}var i=this.getI18N(Di.keyboardFeaturesNoData);this.keybNavNoFeatures=_e("".concat(e,"-nodata"),this.keybNavFeatures,"".concat(uo,"-no-feature-message"),void 0,i),this.keyboardNavigationMode||Ze(this.keybNavFeatures),Ge(this.keybNavFeatures,this.maxZIndex+1);var o="".concat(lo," ").concat(po," ").concat(po,"-previous ").concat(ao),a=Ce("".concat(e,"-elt-prev"),this.keybNavFeaturesList,o,void 0),s=this.getI18N(Di.keyboardFeaturesPreviousPage),u=we("".concat(a.id,"-container"),a,ho,void 0);_e("".concat(a.id,"-number"),u,"".concat(fo," ").concat(vo),void 0,no[7]),_e("".concat(a.id,"-info"),u,co,void 0,s),this.keybNavFeaturesElements.push(a);var l="".concat(lo," ").concat(po," ").concat(po,"-next ").concat(ao),c=Ce("".concat(e,"-elt-next"),this.keybNavFeaturesList,l,void 0),f=this.getI18N(Di.keyboardFeaturesNextPage),d=we("".concat(c.id,"-container"),c,ho,void 0);_e("".concat(c.id,"-number"),d,"".concat(fo," ").concat(vo),void 0,no[8]),_e("".concat(c.id,"-info"),d,co,void 0,f),this.keybNavFeaturesElements.push(c)}},{key:"_clickFeatureAtIndex",value:function(e){var t=this.features[7*this.pageIndex+e];if(t)return this.isFeatureSelected(t)?this.clearSelectedFeature():(this.handleClick(t,!0,this.actionsOnClick,"dialog-keyboard-pressed"),"cluster"!==t.type&&su(t.marker)),!0}},{key:"_paginateFeaturePage",value:function(e){return e&&this.pageIndex<this.pageCount-1?(this.pageIndex+=1,!0):!e&&this.pageIndex>0&&(this.pageIndex-=1,!0)}},{key:"_clearSelectedFeature",value:function(){return this.clearSelectedFeature(),!0}},{key:"_initializeListeners",value:function(){var e=this;this.registerListenerOnMapFocusElement(oo,(function(t){var n=(t.which||t.keyCode||t.key)-e.keyPressZero,r=!1;n>=0&&n<=9&&(t.preventDefault(),0===n?e._clearSelectedFeature():n<=7?e._clickFeatureAtIndex(n-1):r=8===n?e._paginateFeaturePage(!1):e._paginateFeaturePage(!0),r&&e._updateKeyboardFeaturesDialog())})),this.registerListenerOnMapFocusElement(io,(function(t){Number(t.which||t.keyCode||t.key)===e.keyDownBackspace&&(t.preventDefault(),e.clearSelectedFeature(),e._updateKeyboardFeaturesDialog())}))}},{key:"refreshKeyboardNavIconVisibility",value:function(e){(void 0!==e?e:this.keyboardNavigationMode)?He(this.keyboardIcon):Ze(this.keyboardIcon)}},{key:"_resetFeatures",value:function(e){var t=this._resetMarker.bind(this);e&&e.forEach(t)}},{key:"_resetMarker",value:function(e){e&&e.marker&&Je(e.marker.cssElement,yo)&&(lt(e.marker.cssElement,yo),au(e.marker,Tt(this.zIndexes[e.type],e.hashKeys)))}},{key:"_updateFeatureMarkersAsNotInList",value:function(e){e&&e.forEach((function(e){au(e.marker,1),st(e.marker.cssElement,yo)}))}},{key:"_clear",value:function(){this._resetFeatures(this.features)}},{key:"turnKeyboardFeaturesMode",value:function(e){if(!this.node)throw new Error("You need to have the map initialized to turn on the keyboard navigation");this.keyboardNavigationMode=e,e?st(this.node,so):lt(this.node,so),this.keyboardNavigationMode&&document.activeElement===this.getMapNavFocusElement()?He(this.keyboardIcon):Ze(this.keyboardIcon),this.keyboardNavigationMode?(He(this.focusArea),He(this.keybNavFeatures)):(Ze(this.focusArea),Ze(this.keybNavFeatures)),this.keyboardNavigationMode||this._clear()}},{key:"isKeyboardFeaturesModeEnabled",value:function(){return this.keyboardNavigationMode}},{key:"_computeScore",value:function(e){return ro[e.type][e.status||("cluster"===e.type?"available":"unknown")]+(e.score||0)*(e.score<1?1:Math.pow(10,-(""+e.score).split(".")[0].length))+Math.pow(10,-5)*(e.children||[]).length}},{key:"_prioritizeFeaturesForKeyboardNav",value:function(e,t){var n=this._computeScore(e),r=this._computeScore(t);return n===r?(""+e.name).localeCompare(t.name):r-n}},{key:"updateKeyboardFeatures",value:function(){if(this.keyboardNavigationMode){var e=this.containerBounds(this.focusArea);e&&(this._resetFeatures(this.features),this.features=this.listFeatures((function(e){return e.visible}),e).sort(this._prioritizeFeaturesForKeyboardNav.bind(this)),this.pageCount=0===this.features.length?0:Math.floor((this.features.length-1)/7+1),this.pageIndex>=this.pageCount&&(this.pageIndex=0),this._updateKeyboardFeaturesDialog())}}},{key:"_updateKeyboardFeaturesDialog",value:function(){0===this.pageCount?st(this.keybNavFeaturesList,ao):lt(this.keybNavFeaturesList,ao);for(var e=[],t=0;t<7;t++){var n,r=null===(n=this.keybNavFeaturesElements)||void 0===n?void 0:n[t];if(r){ye(r);var i=this.features[7*this.pageIndex+t];if(i){lt(r,ao);var o=we("".concat(r.id,"-container"),r,ho,void 0);if(_e("".concat(r.id,"-number"),o,"".concat(fo," ").concat(vo),void 0,no[t]),i.marker){this._resetMarker(i);var a,s=this.cloneMarker(i.marker);if(s&&(s.style=null==s||null===(a=s.dataset)||void 0===a?void 0:a.cloneStyles,le(s,void 0,!0).map((function(e){return e.element})).forEach((function(e){return pt(e)}))),st(s,"keyboard-features-list-element-icon"),"cluster"===i.type){var u=Xi(le(s,["cluster-label-content"],!0).map((function(e){return e.element})),1)[0];st(u,"no-text-overflow"),u.innerHTML=u.innerHTML.replace(/\s/g," ")}o.appendChild(s)}e.push(i),"cluster"!==i.type&&_e("".concat(r.id,"-info-").concat(i.id),o,co,void 0,i.name||"".concat(i.type," ").concat(i.id))}else st(r,ao)}}this._updateFeatureMarkersAsNotInList((this.features||[]).filter((function(t){return!e.includes(t)&&t.marker})));var l=Xi(this.keybNavFeaturesElements||[],9),c=l[7],f=l[8];this._updateNavButton(c,this.pageCount<=1,0===this.pageIndex),this._updateNavButton(f,this.pageCount<=1,this.pageIndex===this.pageCount-1)}},{key:"_updateNavButton",value:function(e,t,n){var r="disabled";t?(st(e,ao),lt(e,r)):(lt(e,ao),n?st(e,r):lt(e,r))}}],n&&Ji(t.prototype,n),r&&Ji(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function mo(e){return mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mo(e)}function bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wo(r.key),r)}}function ko(e,t,n){return(t=wo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wo(e){var t=function(e,t){if("object"!==mo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==mo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===mo(t)?t:String(t)}var Po="ArrowUp",Co="ArrowDown",Lo="ArrowRight",Mo="ArrowLeft",_o="+",xo="-",Oo="moveKeyboard",Fo="zoomInKeyboard",So="zoomOutKeyboard",Eo=(ko(to={},Oo,"center_changed"),ko(to,Fo,"zoom_changed"),ko(to,So,"zoom_changed"),to),Io=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.panBy=t,this.zoomIn=n,this.zoomOut=r,this.events=[],this.deltaX=5,this.deltaY=5,this.keyDownListenerCallback=this._keyDownListenerCallback.bind(this),this.keyUpListenerCallback=this._keyUpListenerCallback.bind(this),this.keyPressListenerCallback=this._keyPressListenerCallback.bind(this)}var t,n,r;return t=e,n=[{key:"_panUntil",value:function(e,t,n){var r=this;this.panBy(e),setTimeout((function(){if(t()){var e=n();r._panUntil(e,t,n)}}),40)}},{key:"_keyDownListenerCallback",value:function(e){var t=this,n=e.key;if([Po,Co,Mo,Lo].includes(n))switch(e.preventDefault(),n){case Po:this.keyUpPressed||(this.keyUpPressed=!0,this._panUntil([0,-this.deltaY],(function(){return t.keyUpPressed}),(function(){return t.deltaY<100&&(t.deltaY+=7),[0,-t.deltaY]})));break;case Co:this.keyDownPressed||(this.keyDownPressed=!0,this._panUntil([0,this.deltaY],(function(){return t.keyDownPressed}),(function(){return t.deltaY<100&&(t.deltaY+=7),[0,t.deltaY]})));break;case Mo:this.keyLeftPressed||(this.keyLeftPressed=!0,this._panUntil([-this.deltaX,0],(function(){return t.keyLeftPressed}),(function(){return t.deltaX<100&&(t.deltaX+=7),[-t.deltaX,0]})));break;case Lo:this.keyRightPressed||(this.keyRightPressed=!0,this._panUntil([this.deltaX,0],(function(){return t.keyRightPressed}),(function(){return t.deltaX<100&&(t.deltaX+=7),[t.deltaX,0]})))}}},{key:"_keyUpListenerCallback",value:function(e){var t=e.key;if([Po,Co,Mo,Lo].includes(t)){switch(e.preventDefault(),t){case Po:this.keyUpPressed=!1,this.deltaY=5;break;case Co:this.keyDownPressed=!1,this.deltaY=5;break;case Mo:this.keyLeftPressed=!1,this.deltaX=5;break;case Lo:this.keyRightPressed=!1,this.deltaX=5}this.events.splice(0,0,Oo)}}},{key:"_keyPressListenerCallback",value:function(e){var t=e.key;if([_o,xo].includes(t))switch(e.preventDefault(),t){case _o:this.events.splice(0,0,Fo),this.zoomIn();break;case xo:this.events.splice(0,0,So),this.zoomOut()}}},{key:"extractKeyboardEvent",value:function(e){var t=this.events.filter((function(t){return Eo[t]===e}));return this.events=this.events.filter((function(t){return Eo[t]!==e})),Zt(t)}}],n&&bo(t.prototype,n),r&&bo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ao(e){return Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ao(e)}function To(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Do(r.key),r)}}function Do(e){var t=function(e,t){if("object"!==Ao(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ao(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ao(t)?t:String(t)}var jo=function(){function e(t,n,r,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureTypeProviders={},n.forEach((function(e){var n={};r[e].forEach((function(e){var r=i[e],o=i[r.type];if(!o)throw new Error("Content provider ".concat(r.type," not supported"));if(!o.checkPackageIsLoaded())throw new Error("You need to load the package supporting the content provider service ".concat(r.type));n[e]=o.newInstance(t,r)})),o.featureTypeProviders[e]=n}))}var t,n,r;return t=e,(n=[{key:"getFeatureProviders",value:function(){return this.featureTypeProviders}}])&&To(t.prototype,n),r&&To(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Bo(e){return function(e){if(Array.isArray(e))return Ro(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ro(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ro(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ro(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function No(e){return No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},No(e)}function Uo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vo(r.key),r)}}function Vo(e){var t=function(e,t){if("object"!==No(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==No(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===No(t)?t:String(t)}var zo=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),[t,n,r,i].some((function(e){return"object"===No(e)&&e.lng&&e.lat}))?(this.x1=r.lng,this.x2=n.lng,this.y1=t.lat,this.y2=n.lat):(this.x1=t,this.x2=r,this.y1=n,this.y2=i),this.coordinates=[{lng:this.x2,lat:this.y1},{lng:this.x2,lat:this.y2},{lng:this.x1,lat:this.y2},{lng:this.x1,lat:this.y1},{lng:this.x2,lat:this.y1}]}var t,n,r;return t=e,(n=[{key:"getCoordinates",value:function(){return this.coordinates}},{key:"getOriginPoints",value:function(){return[this.x1,this.y1,this.x2,this.y2]}},{key:"containsPoint",value:function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2}},{key:"containsBoundingBox",value:function(e){var t=e.getOriginPoints();return this.containsPoint(t[0],t[1])&&this.containsPoint(t[2],t[3])}}])&&Uo(t.prototype,n),r&&Uo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ko(e,t,n,r){return[{lng:n,lat:t},{lng:n,lat:r},{lng:e,lat:r},{lng:e,lat:t},{lng:n,lat:t}]}function Zo(e,t){var n,r,i,o,a=e.lowerQuantile,s=void 0===a?.1:a,u=e.upperQuantile,l=void 0===u?.9:u,c=e.marginMultiplier,f=void 0===c?.2:c,d=e.minMargin,h=void 0===d?.01:d,p=t.map((function(e){return e.lat||e[0]})),y=t.map((function(e){return e.lng||e[1]}));if(y.length>10)n=Ho(y,s),r=Ho(y,l),i=Ho(p,s),o=Ho(p,l);else{var v=function(e,t){return{lowerLongitude:Math.min.apply(Math,Bo(e)),upperLongitude:Math.max.apply(Math,Bo(e)),lowerLatitude:Math.min.apply(Math,Bo(t)),upperLatitude:Math.max.apply(Math,Bo(t))}}(y,p);n=v.lowerLongitude,r=v.upperLongitude,i=v.lowerLatitude,o=v.upperLatitude}var g=Math.max(f*(r-n),h),m=Math.max(f*(o-i),h);return new zo(n-g,i-m,r+g,o+m)}function Ho(e,t){var n=e.sort((function(e,t){return e-t})),r=(n.length-1)*t,i=Math.floor(r),o=r-i;return void 0!==n[i+1]?n[i]+o*(n[i+1]-n[i]):n[i]}function qo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||$o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wo(e,t,n){return Wo=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Go(i,n.prototype),i},Wo.apply(null,arguments)}function Go(e,t){return Go=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Go(e,t)}function Qo(e){return function(e){if(Array.isArray(e))return Xo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $o(e,t){if(e){if("string"==typeof e)return Xo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xo(e,t):void 0}}function Xo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ea(e,t){var n=Yo(e.getOriginPoints(),4),r=n[0],i=n[1],o=n[2],a=n[3],s=o-r,u=a-i,l=(i+a)/2,c=1/Math.cos(l*Math.PI/180),f=c*(u/s);if(f>t){var d=(c*u/t-s)/2;return Ko(r-d,i,o+d,a)}if(f<t){var h=(s*t/c-u)/2;return Ko(r,i-h,o,a+h)}return e.getCoordinates()}function ta(e){return ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ta(e)}function na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ra(r.key),r)}}function ra(e){var t=function(e,t){if("object"!==ta(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ta(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ta(t)?t:String(t)}var ia=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"computeBoundingBox",value:function(e,t,n,r,i){if(!e||0===e.length)throw new Error("Cannot calculate bounds. No valid coordinate values given.");if(!t)return e[0].lat?e:e.map((function(e){return{lat:e[0],lng:e[1]}}));var o=null!=n?n:{},a=function(e,t,n,r){var i=e.minimumPins,o=void 0===i?50:i,a=e.interpolationRatio,s=void 0===a?.75:a;if(n<=o){if(r){var u=Wo(zo,Qo(r));if(u.containsBoundingBox(t)){var l=qo(u.getOriginPoints(),4),c=l[0],f=l[1],d=l[2],h=l[3],p=qo(t.getOriginPoints(),4),y=p[0],v=p[1],g=p[2],m=p[3];return new zo(y+(c-y)*s,v+(f-v)*s,g+(d-g)*s,m+(h-m)*s)}return t}return t}return t}(o,Zo(o,e),e.length,r);return ea(a,i)}},{key:"computeCenteredBoundingBox",value:function(e,t,n){if(!e||0===e.length)throw new Error("Cannot calculate bounds. No valid coordinate values given.");return ea(function(e,t){var n,r,i=null!==(n=e.lat)&&void 0!==n?n:e[0],o=null!==(r=e.lng)&&void 0!==r?r:e[1],a=Vr(i,t.map((function(e){var t;return null!==(t=e.lat)&&void 0!==t?t:e[0]})),!1),s=Vr(o,t.map((function(e){var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})),!0),u=o-s,l=Wt(i+(i-a),void 0,!1),c=Wt(o+u,void 0,!0);switch(zr([i,o],[a,s])){case"sw":return new zo(s,a,c,l);case"ne":return new zo(c,l,s,a);case"se":return new zo(c,a,s,l);default:return new zo(s,l,c,a)}}(t.centeredOn,e),n)}}])&&na(t.prototype,n),r&&na(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function oa(){return oa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=da(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},oa.apply(this,arguments)}function aa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||sa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sa(e,t){if(e){if("string"==typeof e)return ua(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ua(e,t):void 0}}function ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function la(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ca(e,t)}function ca(e,t){return ca=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ca(e,t)}function fa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=da(e);if(t){var i=da(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ha(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function da(e){return da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},da(e)}function ha(e){return ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ha(e)}function pa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ya(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ga(r.key),r)}}function va(e,t,n){return t&&ya(e.prototype,t),n&&ya(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ga(e){var t=function(e,t){if("object"!==ha(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ha(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ha(t)?t:String(t)}var ma=Qt,ba=tn,ka=Yt,wa=Bt,Pa="qualifiers",Ca={default:void 0,onSelect:void 0},La="product",Ma="property",_a="place",xa="cluster",Oa=[La,Ma],Fa=[La,Ma,_a],Sa="unknown",Ea=["available","filtered","sold_out",Sa],Ia=Ea,Aa=[].concat(Fa,[xa]),Ta=function(){function e(t,n,r){pa(this,e),this.id=t,this.type=n,this.configHelper=r,this.data=[void 0,void 0],this.visible=!1,this._intersectingFeatureIds=[],this._clean()}return va(e,[{key:"_clean",value:function(){this.marker=void 0,this.markerType=void 0,this.popupContent=void 0,this.visible=!1,this._highlighted=!1,this.clearHashkeys(),this._intersectingFeatureIds=[]}},{key:"updateConfigHelper",value:function(e){this.configHelper=e}},{key:"clearHashkeys",value:function(){this._hashKeys=void 0}},{key:"_importData",value:function(e,t){e&&(void 0===this.data[t]&&(this.data[t]={}),this._hashKeys=void 0)}},{key:"_removeData",value:function(e){delete this.data[e],this._clean()}},{key:"hashKeys",get:function(){return void 0===this._hashKeys&&(this._hashKeys=ba(void 0,this._highlighted,[])),this._hashKeys}},{key:"importUserData",value:function(e){this._importData(e,0)}},{key:"importTileData",value:function(e){this._importData(e,1)}},{key:"removeTileData",value:function(){this._removeData(1)}},{key:"removeUserData",value:function(){this._removeData(0)}},{key:"mergeUserData",value:function(e){this._mergeData(e,0)}},{key:"mergeTileData",value:function(e){this._mergeData(e,1)}},{key:"_mergeData",value:function(e,t){e&&Object.assign(this.data[t],e),this._hashKeys=void 0}},{key:"_toData",value:function(e){if(this.data[e])return{id:this.id,type:this.type}}},{key:"toUserData",value:function(){return this._toData(0)}},{key:"toTileData",value:function(){return this._toData(1)}},{key:"toData",value:function(){return Object.assign(Object.assign({},this.toTileData()),this.toUserData())}},{key:"hasUserData",value:function(){return this._hasData(0)}},{key:"hasTileData",value:function(){return this._hasData(1)}},{key:"_hasData",value:function(e){var t=this.data[e];return void 0!==t&&Object.keys(t).length>0}},{key:"defined",get:function(){return!!this.data.find((function(e){return e}))}},{key:"userData",get:function(){return this.data[0]},set:function(e){this.data[0]=e}},{key:"tileData",get:function(){return this.data[1]},set:function(e){this.data[1]=e}},{key:"latLng",get:function(){return this._getLatLngFromData(this._getFirstDefined.bind(this))}},{key:"userLatLng",get:function(){return this._getLatLngFromData(this._getUserProp.bind(this))}},{key:"_getLatLngFromData",value:function(e){return e("latLng")}},{key:"highlighted",get:function(){return!0===this._highlighted},set:function(e){this._highlighted=e,this._hashKeys=void 0}},{key:"_getFirstDefined",value:function(e){return(this.data.find((function(t){return(t||{})[e]}))||{})[e]}},{key:"_getUserProp",value:function(e){return(this.data[0]||{})[e]}},{key:"intersectingFeatureIds",get:function(){return this._intersectingFeatureIds},set:function(e){void 0!==e&&(this._intersectingFeatureIds=e)}}]),e}(),Da=function(e){la(n,e);var t=fa(n);function n(e,r,i){return pa(this,n),t.call(this,e,r,i)}return va(n,[{key:"hashKeys",get:function(){return void 0===this._hashKeys&&this.refreshHashkeys(),this._hashKeys}},{key:"addQualifier",value:function(){for(var e=!1,t=this._getFirstDefined(Pa),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){t.includes(n)||(t.push(n),e=!0)})),e&&(this._hashKeys=void 0),e}},{key:"refreshHashkeys",value:function(){var e=this.qualifiers&&this.configHelper?this.configHelper.filterQualifiersUsed(this.type,this.qualifiers):this.qualifiers,t=ba(this.status,this._highlighted||!1,e);this._hashKeys=this.configHelper?this.configHelper.filterHashkeysUsed(this.type,t):t}},{key:"removeQualifier",value:function(){for(var e=!1,t=this._getFirstDefined(Pa),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){var r=t.indexOf(n);-1!==r&&(t.splice(r,1),e=!0)})),e&&(this._hashKeys=void 0),e}},{key:"_assign",value:function(e,t,n){void 0!==n?e[t]=n:void 0!==e[t]&&delete e[t]}},{key:"_importData",value:function(e,t){e&&(void 0===this.data[t]&&(this.data[t]={}),this._assign(this.data[t],"status",e.status),this._assign(this.data[t],"name",e.name),this._assign(this.data[t],Pa,e.qualifiers||[]),this._assign(this.data[t],"textLabel",e.textLabel),this._assign(this.data[t],"price",e.price),this._assign(this.data[t],"polygon",e.polygon),this._assign(this.data[t],"text",e.text),this._assign(this.data[t],"latLng",void 0!==e.lat&&void 0!==e.lng?ma([e.lat,e.lng]):void 0),this._assign(this.data[t],"score",e.score),this._assign(this.data[t],"thumbnail",e.thumbnail),this._assign(this.data[t],"description",e.description),this._assign(this.data[t],"tile",e.tile),this._assign(this.data[t],"ariaLabels",e.ariaLabels),this._hashKeys=void 0)}},{key:"_toData",value:function(e){var t=this.data[e];if(t)return{id:this.id,type:this.type,status:t.status||Sa,qualifiers:t.qualifiers||[],name:t.name,price:t.price,polygon:t.polygon,text:t.text,lat:t.latLng?t.latLng[0]:void 0,lng:t.latLng?t.latLng[1]:void 0,score:t.score,thumbnail:t.thumbnail,description:t.description,ariaLabels:t.ariaLabels}}},{key:"hasLatLngChanged",value:function(e,t,n){if(void 0===e&&void 0!==t&&void 0!==n)return!0;if(void 0===e||void 0!==t&&void 0!==n){var r=aa(ma([t,n]),2),i=r[0],o=r[1];return Math.abs(e[0]-i)>1e-5||Math.abs(e[1]-o)>1e-5}return!0}},{key:"isUserDataChanged",value:function(e){return!!e&&(!this._same(this.userStatus||Sa,e.status||Sa)||!this._same(this.userPrice,e.price)||!this._same(this.userPolygon,e.polygon)||!this._same(this.userText,e.text)||!this._same(this.userName,e.name)||!this._same(this.userDescription,e.description)||!ka(this.userQualifiers,e.qualifiers,!1)||this.hasLatLngChanged(this.userLatLng,e.lat,e.lng))}},{key:"_same",value:function(e,t){return e===t||wa(e)&&wa(t)}},{key:"status",get:function(){return this._getStatusFromData(this._getFirstDefined.bind(this))}},{key:"userStatus",get:function(){return this._getStatusFromData(this._getUserProp.bind(this))}},{key:"_getStatusFromData",value:function(e){return e("status")||Sa}},{key:"qualifiers",get:function(){return this._getQualifiersFromData(this._getFirstDefined.bind(this))}},{key:"userQualifiers",get:function(){return this._getQualifiersFromData(this._getUserProp.bind(this))}},{key:"_getQualifiersFromData",value:function(e){return e("qualifiers")}},{key:"name",get:function(){return this._getFirstDefined("name")}},{key:"userName",get:function(){return this._getNameFromData(this._getUserProp.bind(this))}},{key:"_getNameFromData",value:function(e){return e("name")}},{key:"description",get:function(){return this._getFirstDefined("description")}},{key:"userDescription",get:function(){return this._getDescriptionFromData(this._getUserProp.bind(this))}},{key:"_getDescriptionFromData",value:function(e){return e("description")}},{key:"price",get:function(){return this._getPriceFromData(this._getFirstDefined.bind(this))}},{key:"ariaLabels",get:function(){return this._getFirstDefined("ariaLabels")||Ca}},{key:"userPrice",get:function(){return this._getPriceFromData(this._getUserProp.bind(this))}},{key:"_getPriceFromData",value:function(e){return e("price")}},{key:"polygon",get:function(){return this._getPolygonFromData(this._getFirstDefined.bind(this))}},{key:"userPolygon",get:function(){return this._getPolygonFromData(this._getUserProp.bind(this))}},{key:"_getPolygonFromData",value:function(e){return e("polygon")}},{key:"text",get:function(){return this._getFirstDefined("text")}},{key:"userText",get:function(){return this._getTextFromData(this._getUserProp.bind(this))}},{key:"_getTextFromData",value:function(e){return e("text")}},{key:"score",get:function(){return this._getFirstDefined("score")}}]),n}(Ta),ja=function(e){la(n,e);var t=fa(n);function n(e){var r;return pa(this,n),(r=t.call(this,e,xa))._computedLatLng=[],r}return va(n,[{key:"_clean",value:function(){oa(da(n.prototype),"_clean",this).call(this),this.visible=!0}},{key:"_importData",value:function(e,t){e&&(this.data[t]={children:e.children,radius:e.radius,minPrice:e.minPrice,text:e.text,originalLatLng:ma([e.lat,e.lng]),featureType:e.featureType,qualifier:e.qualifier},this._hashKeys=void 0)}},{key:"_toData",value:function(e){var t=this.data[e];if(t)return{id:this.id,type:this.type,radius:t.radius,children:t.children,minPrice:t.minPrice,lat:t.originalLatLng[0],lng:t.originalLatLng[1],text:t.text,featureType:t.featureType,qualifier:t.qualifier}}},{key:"toData",value:function(){var e=oa(da(n.prototype),"toData",this).call(this);return e.children=e.children.map((function(e){return e.toData()})),e}},{key:"computedLatLng",get:function(){return this._computedLatLng},set:function(e){e&&e.length>0?this._computedLatLng=ma([e[0],e[1]]):this._computedLatLng=[]}},{key:"latLng",get:function(){return this._getFirstDefined("originalLatLng")}},{key:"children",get:function(){return this._getFirstDefined("children")}},{key:"radius",get:function(){return this._getFirstDefined("radius")}},{key:"minPrice",get:function(){return this._getFirstDefined("minPrice")}},{key:"text",get:function(){return this._getFirstDefined("text")}},{key:"featureType",get:function(){return this._getFirstDefined("featureType")}},{key:"qualifier",get:function(){return this._getFirstDefined("qualifier")}}]),n}(Ta),Ba=function(){function e(t,n){pa(this,e),this.type=t,this.newInstance=n,this.index=new Map,this._data=[]}return va(e,[{key:"data",get:function(){return this._data.filter((function(e){return e&&e.defined}))}},{key:"contains",value:function(e){return!!this.find(e)}},{key:"find",value:function(e){var t,n,r=null!==(t=this.index.get(e))&&void 0!==t?t:-1;if(r>-1)return this._data[r]&&null!==(n=this._data[r])&&void 0!==n&&n.defined?this._data[r]:void 0}},{key:"save",value:function(e){if(e.type===this.type){var t,n=null!==(t=this.index.get(e.id))&&void 0!==t?t:-1;n>-1?this._data[n]=e:(this.index.set(e.id,this._data.length),this._data.push(e))}}},{key:"delete",value:function(e){if(e.type===this.type){var t,n=null!==(t=this.index.get(e.id))&&void 0!==t?t:-1;n>-1&&(this._data[n]=void 0)}}},{key:"clearAll",value:function(){this._data=[],this.index=new Map}}]),e}(),Ra=function(){function e(){pa(this,e),this._repositories={product:new Ba(La,(function(e,t){return new Da(e.id,La,t)})),property:new Ba(Ma,(function(e,t){return new Da(e.id,Ma,t)})),place:new Ba(_a,(function(e,t){return new Da(e.id,_a,t)})),cluster:new Ba(xa,(function(e,t){return new ja(e.id)}))}}return va(e,[{key:"allProducts",value:function(){return this.all((function(e){return e===La}))}},{key:"allProductsWithCoordinates",value:function(){return this.allProducts().filter((function(e){return void 0!==e.latLng}))}},{key:"allProperties",value:function(){return this.all((function(e){return e===Ma}))}},{key:"allPropertiesWithCoordinates",value:function(){return this.allProperties().filter((function(e){return void 0!==e.latLng}))}},{key:"allPlaces",value:function(){return this.all((function(e){return e===_a}))}},{key:"allPlacesWithCoordinates",value:function(){return this.allPlaces().filter((function(e){return void 0!==e.latLng}))}},{key:"allWithCoordinates",value:function(e){return this.all().filter((function(t){return void 0!==t.latLng&&(!e||t.type===e)}))}},{key:"allExceptClusters",value:function(){return this.all((function(e){return e!==xa}))}},{key:"allClusters",value:function(){return this.all((function(e){return e===xa}))}},{key:"find",value:function(e,t){return this.repository(t).find(e)}},{key:"delete",value:function(e,t){this.repository(t).delete({id:e,type:t})}},{key:"repository",value:function(e){return this._repositories[e]}},{key:"all",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},n=[];return Object.keys(this._repositories).filter((function(e){return t(e)})).forEach((function(t){n=n.concat(e._repositories[t].data)})),n}},{key:"upsertUserData",value:function(e,t){return this._upsert(e,"importUserData",t)}},{key:"upsertTileData",value:function(e,t){return this._upsert(e,"importTileData",t)}},{key:"insertTileData",value:function(e,t){if(!this.repository(e.type).find(e.id))return this._upsert(e,"importTileData",t)}},{key:"insertTileDataWithLowestZoom",value:function(e,t){var n=this.repository(e.type).find(e.id);if(!n)return this._upsert(e,"importTileData",t);var r=n.tileData&&n.tileData.tile,i=e.tile&&e.tile[2],o=r&&r[2];return void 0!==i&&(void 0===o||i<o)?this._upsert(e,"importTileData",t):void 0}},{key:"_upsert",value:function(e,t,n){var r=this.repository(e.type).find(e.id);return r||(r=this.repository(e.type).newInstance(e,n)),r[t](e),this.repository(r.type).save(r),r}},{key:"deleteTileData",value:function(e){return this._delete(e,"removeTileData")}},{key:"_delete",value:function(e,t){var n=this.repository(e.type).find(e.id);return n&&(n[t](e),n.defined||this.repository(e.type).delete(e)),n}}]),e}();function Na(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{score:"DESC"},{id:"ASC"}];return e.sort((function(e,n){var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=sa(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(i.s();!(r=i.n()).done;)for(var o=r.value,a=0,s=Object.keys(o);a<s.length;a++){var u=s[a],l=e[u],c=n[u],f=0;if(void 0===l&&void 0!==c?f=-1:void 0!==l&&void 0===c?f=1:void 0!==l&&void 0!==c&&(l<c&&(f=-1),l>c&&(f=1)),"DESC"===o[u]&&(f*=-1),0!==f)return f}}catch(e){i.e(e)}finally{i.f()}return 0}))}function Ua(e){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ua(e)}function Va(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Ka(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function za(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Ka(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ka(e,t){if(e){if("string"==typeof e)return Za(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Za(e,t):void 0}}function Za(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ha(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qa(r.key),r)}}function qa(e){var t=function(e,t){if("object"!==Ua(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ua(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ua(t)?t:String(t)}var Wa=Tt,Ga="marker-hidden",Qa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"init",value:function(e){var t=e.asKey,n=e.getMarkerComponent,r=e.getRectOfMarker,i=e.moveMarkerPosition,o=e.makeMarkerVisible,a=e.settings;this.asKey=t,this.getMarkerComponent=n,this.getRectOfMarker=r,this.moveMarkerPosition=i,this.makeMarkerVisible=o,this.settings=a;var s=a.collision;this.textLabelVisibility=s.labelVisibility,this.textLabelDynamicPlacement=s.dynamicPlacement,this.collisionBufferVariation=s.collisionBufferVariation,this.collisionBuffers=s.collisionBuffers,this.tagCollidingMarkersConfig=s.tagCollidingMarkers,this.clusterMarkerCollisionBuffer=s.clusterMarkerCollisionBufferInPixels,this.shouldMoveCollidingClusterMarkers=s.shouldMoveCollidingClusterMarkers}},{key:"_isMarkerCollidingOtherMarkerOrLabel",value:function(e,t){var n,r=e.markerBBox,i=za(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=o.textLabelBBox,s=o.markerBBox,u=o.labelVisibility;if(r&&(s&&et(r,s)||u&&a&&et(r,a)))return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"_isLabelCollidingOtherMarkerOrLabel",value:function(e,t){var n,r=e.textLabelBBox,i=e.labelVisibility,o=za(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=a.textLabelBBox,u=a.markerBBox,l=a.labelVisibility;if(i&&r&&(l&&s&&et(r,s)||u&&et(r,u)))return!0}}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"_sortCandidateBBoxes",value:function(e){return e.sort((function(e,t){return e.popularity===t.popularity?e.feature.id<t.feature.id?-1:1:e.popularity>t.popularity?-1:1}))}},{key:"_splitFeaturesBoundingBoxes",value:function(e){var t=[],n=[];return e.forEach((function(e){"always"===e.labelVisibility||!1===e.isDynamicLabel?t.push(e):n.push(e)})),{safeFeaturesBBoxes:t,candidateBBoxes:n}}},{key:"_updateMarkerLabelPosition",value:function(e,t){var n=this._splitFeaturesBoundingBoxes(e),r=n.safeFeaturesBBoxes,i=n.candidateBBoxes;for(this._sortCandidateBBoxes(i);i.length>0;){var o=Va(i,1)[0],a=o.feature,s=o.labelVisibility,u=o.availableLabelPositions,l=o.currentLabelPosition,c=a.marker;if(this._isMarkerCollidingOtherMarkerOrLabel(o,r))st(this.getMarkerComponent(a),Ga),i.shift();else{var f=s&&this._isLabelCollidingOtherMarkerOrLabel(o,r);if(f){u[l]=!1;for(var d=!1,h=0,p=Object.entries(u);h<p.length;h++){var y=Va(p[h],2),v=y[0];if(y[1]){d=!0,l=v;break}}d&&a.name?(c.labels.updateTextLabelPosition(l,t),o.textLabelBBox=Fu(a,this.getMarkerComponent(a),this.settings,l,this.getRectOfMarker),o.currentLabelPosition=l):(c.labels.hideTextLabel(f),o.labelVisibility=!1,r.push(o),i.shift())}else r.push(o),i.shift()}}}},{key:"getPopularity",value:function(e){var t,n=null!==(t=null==e?void 0:e.score)&&void 0!==t?t:0;return"number"!=typeof n?0:n}},{key:"_calculateFeaturesBoundingBoxes",value:function(e,t,n){var r=this,i=e.map((function(e){var i=r.asKey(e),o=t[i],a=e.marker.textLabelPosition;return{labelVisibility:o,availableLabelPositions:{right:!0,left:!0,above:!0,below:!0},currentLabelPosition:a,isDynamicLabel:n[i],markerBBox:r.getRectOfMarker(e),textLabelBBox:o&&e.name?Fu(e,r.getMarkerComponent(e),r.settings,a,r.getRectOfMarker):void 0,popularity:r.getPopularity(e),feature:e}}));return i}},{key:"_resetMarkersAndLabels",value:function(e,t){var n=this;return e.forEach((function(e){lt(n.getMarkerComponent(e),Ga),Mu(t,n.settings,e,e.marker)})),_u(e,t,this.settings,this.asKey)}},{key:"_getLabelDynamicPlacementConfigByFeatureKey",value:function(e){var t=this,n={};return e.forEach((function(e){var r=Wa(t.textLabelDynamicPlacement[e.type],e.hashKeys),i=t.asKey(e);n[i]=r})),n}},{key:"handleMarkerLabelCollision",value:function(e,t){var n=this,r=e.filter((function(e){return n.getMarkerComponent(e)})),i=this._getLabelDynamicPlacementConfigByFeatureKey(r);if(Object.values(i).includes(!0)){var o=this._resetMarkersAndLabels(r,t),a=this._calculateFeaturesBoundingBoxes(r,o,i);this._updateMarkerLabelPosition(a,t)}}},{key:"moveCollidingClusterMarkers",value:function(e){var t=this;e.filter((function(e){return"cluster"===e.feature.type&&t.getMarkerComponent(e.feature)})).forEach((function(n){var r=n.feature,i=r.radius;if(lt(t.getMarkerComponent(r),"cluster-marker-moved"),lt(t.getMarkerComponent(r),"cluster-marker-failed-to-move"),r._intersectingFeatureIds.length>0){var o=e.filter((function(e){return r._intersectingFeatureIds.includes(e.feature.id)})),a=t.getMaxRectOfMarkers(o),s=n.markerRect,u=yt(a,s,t.clusterMarkerCollisionBuffer),l=mt(s,u),c=vt(l.center,l.width+2*n.markerCollisionBuffer,l.height+2*n.markerCollisionBuffer),f=e.filter((function(e){return e.feature.id!==r.id&&t.getMarkerComponent(e.feature)}));t.withinClusterRadius(s.center,l,i)&&t.noNewClusterCollision(c,f)?(t.moveMarkerPosition(r,u),st(t.getMarkerComponent(r),"cluster-marker-moved"),t.updateIntersectingFeatureIdsAfterMovingClusterMarkerPosition(r,l,f),n.markerRect=l,n.markerRectWithBuffer=c):st(t.getMarkerComponent(r),"cluster-marker-failed-to-move")}}),this)}},{key:"updateIntersectingFeatureIdsAfterMovingClusterMarkerPosition",value:function(e,t,n){var r=e.id;e._intersectingFeatureIds=[],n.forEach((function(e){var n=e.feature._intersectingFeatureIds.indexOf(r);et(e.markerRectWithBuffer,t)?n<0&&e.feature._intersectingFeatureIds.push(r):n>-1&&e.feature._intersectingFeatureIds.splice(n,1)}))}},{key:"withinClusterRadius",value:function(e,t,n){return nt(t,this.getClusterCircle(e,n))}},{key:"noNewClusterCollision",value:function(e,t){return!t.some((function(t){return et(e,t.markerRect)}))}},{key:"getClusterCircle",value:function(e,t){return{radius:t,center:{x:e.x,y:e.y}}}},{key:"getMaxRectOfMarkers",value:function(e){return gt(e.map((function(e){return e.markerRect})))}},{key:"hideCollidingMarkers",value:function(e,t){var n=this,r=e.filter((function(e){return n.getMarkerComponent(e)})),i=[],o=[];r.forEach((function(e){"none"===t[n.asKey(e)]?i.push(e):o.push(e)}));for(var a=Na(o,[{type:"ASC"},{score:"DESC"},{id:"ASC"}]);a.length>0;){var s,u=a.shift(),l=!1,c=za(i);try{for(c.s();!(s=c.n()).done;){var f=s.value;if(u&&f&&u.type===f.type&&u._intersectingFeatureIds.includes(f.id)){this.makeMarkerVisible(u,!1),this.updateIntersectingFeatureIdsAfterHidingMarker(r,u.id),l=!0;break}}}catch(e){c.e(e)}finally{c.f()}l||i.push(u)}}},{key:"updateIntersectingFeatureIdsAfterHidingMarker",value:function(e,t){e.forEach((function(e){var n=e._intersectingFeatureIds.indexOf(t);n>-1&&e._intersectingFeatureIds.splice(n,1)}))}},{key:"tagCollidingMarkers",value:function(e,t){var n=this,r=e.filter((function(e){return n.getMarkerComponent(e)}));r.forEach((function(e){lt(n.getMarkerComponent(e),"marker-collision")})),r.filter((function(e){return e._intersectingFeatureIds.length>0&&t[n.asKey(e)]})).forEach((function(e){var t,i=za(r);try{for(i.s();!(t=i.n()).done;){var o=t.value.id;if(e.id!==o&&e._intersectingFeatureIds.includes(o)){st(n.getMarkerComponent(e),"marker-collision");break}}}catch(e){i.e(e)}finally{i.f()}}))}},{key:"updateMarkerPosition",value:function(e){var t=this,n=e.filter((function(e){return t.getMarkerComponent(e)})),r=this.getCollisionBufferVariationByFeatureKey(n),i=this.getFeaturesWithMarkerRects(n,r);this.updateIntersectingFeatureIds(i),this.shouldMoveCollidingClusterMarkers&&this.moveCollidingClusterMarkers(i),Object.values(r).some((function(e){return"none"!==e}))&&this.hideCollidingMarkers(n,r);var o=this.getTagCollidingMarkersConfigByFeatureKey(n);Object.values(o).includes(!0)&&this.tagCollidingMarkers(n,o)}},{key:"getTagCollidingMarkersConfigByFeatureKey",value:function(e){var t=this,n={};return e.forEach((function(e){var r=Wa(t.tagCollidingMarkersConfig[e.type],e.hashKeys),i=t.asKey(e);n[i]=r})),n}},{key:"getCollisionBufferVariationByFeatureKey",value:function(e){var t=this,n={};return e.forEach((function(e){var r=Wa(t.collisionBufferVariation[e.type],e.hashKeys),i=t.asKey(e);n[i]=r})),n}},{key:"updateIntersectingFeatureIds",value:function(e){e.forEach((function(t){var n;(null===(n=t.feature._intersectingFeatureIds)||void 0===n?void 0:n.length)>0&&(t.feature._intersectingFeatureIds=[]),"cluster"===t.feature.type&&(t.feature.computedLatLng=[]),e.forEach((function(e){t.feature.id!==e.feature.id&&et(t.markerRectWithBuffer,e.markerRect)&&t.feature._intersectingFeatureIds.push(e.feature.id)}))}))}},{key:"getFeaturesWithMarkerRects",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.filter((function(e){return t.getMarkerComponent(e)})).map((function(e){var r=n[t.asKey(e)],i=t.collisionBuffers[r]||0;return{feature:e,markerRectWithBuffer:t.getRectOfMarker(e,i),markerRect:t.getRectOfMarker(e),markerCollisionBuffer:i}}))}}],n&&Ha(t.prototype,n),r&&Ha(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function $a(e){return $a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$a(e)}function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ya(r.key),r)}}function Ya(e){var t=function(e,t){if("object"!==$a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==$a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===$a(t)?t:String(t)}function Ja(e){return Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ja(e)}var es=["id","type"];function ts(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ns(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(n),!0).forEach((function(t){rs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rs(e,t,n){return(t=fs(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function is(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function os(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=us(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function as(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||us(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ss(e){return function(e){if(Array.isArray(e))return ls(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||us(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function us(e,t){if(e){if("string"==typeof e)return ls(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ls(e,t):void 0}}function ls(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fs(r.key),r)}}function fs(e){var t=function(e,t){if("object"!==Ja(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ja(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ja(t)?t:String(t)}function ds(e,t){return ds=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ds(e,t)}function hs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ps(e);if(t){var i=ps(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Ja(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function ps(e){return ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ps(e)}var ys=Tt,vs=tn,gs="click";function ms(){return{highlightedFeatures:[],selectedFeature:void 0,featuresOver:new Set,product:{withMarkers:[]},property:{withMarkers:[]},place:{withMarkers:[]},routes:[],routeDestinations:[],polygons:[]}}var bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ds(e,t)}(o,e);var t,n,r,i=hs(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).eventsManager=t,a.features=n,a.mapData=r,a.boundsComputation=new ia,a.listenersToDeregister=[],a.copyrightsDiv=a.createCopyrightsDiv(),a.copyrights=new Map,a.popup=void 0,a.ignoreMapClickEvent=!1,a.configHelper=e,a.settings=a.configHelper.loadMapSettings(),a.logger=a.configHelper.logger("BaseMap"),a.logger.debug("BaseMap constructor"),a.featureTypes=a.settings.featureTypes,a.clusterFactory=new ii,a._newKeyboardFeatures(!1),a._newRouteManager(),a._newClusterers(),a._newAvailabilityCheck(),a._newContentProviders(),a._newCollisionManagement(!1),a.tilesLoader=void 0,a}return t=o,n=[{key:"_newKeyboardFeatures",value:function(e){this.keyboardFeatures&&this.keyboardFeatures.removeAllUIElements(),this.settings.isKeyboardFeaturesDefined?(this.keyboardFeatures=new go(this.settings.keyboardFeaturesIcon,this.settings.getI18N),e&&this._initializeKeyboardFeatures(this.keyboardFeatures)):this.keyboardFeatures=void 0}},{key:"_initializeKeyboardFeatures",value:function(e){var t=this;e.init({node:this.node,uniqId:this.uniqId.bind(this),containerBounds:this.containerBounds.bind(this),listFeatures:this._listFeatures.bind(this),cloneMarker:this.cloneMarker.bind(this),zIndexes:this.settings.zIndexes,maxZIndex:this.settings.maxZIndex,getMapNavFocusElement:function(){return t.mapNavFocusElement},registerListenerOnMapFocusElement:this.registerListenerOnMapFocusElement.bind(this),handleClick:this.handleClick.bind(this),actionsOnClick:this.settings.actionsOnMarkerClick,isFeatureSelected:this.isFeatureSelected.bind(this),clearSelectedFeature:this.clearSelectedFeature.bind(this)}),this.settings.isKeyboardFeaturesEnabled&&(this.turnKeyboardFeaturesMode(!0),e.updateKeyboardFeatures())}},{key:"_updateMarkerPosition",value:function(){var e;null===(e=this.collisionManagement)||void 0===e||e.updateMarkerPosition(this.features.all())}},{key:"_newAvailabilityCheck",value:function(){this.availabilityCheck=new Ti(this.settings.loggerFactory,this.settings.availabilityProvider)}},{key:"_newContentProviders",value:function(){this.settings.isAnyContentProviderExists?this.contentProvider=new jo(this.settings.loggerFactory,this.featureTypes,this.settings.contentProvidersByFeatureType,this.settings.contentProvidersConfigs):this.contentProvider=void 0}},{key:"_newRouteManager",value:function(){this.routes=new Pi({logger:this.settings.loggerFactory("RoutesRepository"),egDistances:this.configHelper.egDistances(),routeLineStyleByDistanceMode:this.settings.routeLineStyleByDistanceMode,routeCacheInMs:this.settings.routeCacheInMs,findFeature:this._findFeature.bind(this),eventsManager:this.eventsManager,addRouteOnMap:this.addRouteOnMap.bind(this),removeRouteOnMap:this.removeRouteOnMap.bind(this),asKey:this.asKey},this.mapData.routes,this.mapData.routeDestinations)}},{key:"_newPolygonManager",value:function(){this.polygonsManager=new Fi({logger:this.settings.loggerFactory("PolygonRepository"),findFeature:this._findFeature.bind(this),addPolygonsOnMap:this.addPolygonsOnMap.bind(this),removePolygonsOnMap:this.removePolygonsOnMap.bind(this),asKey:this.asKey,polygons:this.mapData.polygons,polygonStyles:this.settings.polygonStyles})}},{key:"_updateTilesConfig",value:function(){var e,t=this;this.features.allExceptClusters().forEach((function(e){e.hasUserData()?e.hasTileData()&&e.removeTileData():t.features.delete(e.id,e.type)}));var n=this.getBounds(),r=n.sw,i=n.ne,o=this.getTileDim(),a=o.width,s=o.height,u=this.getZoom(),l=Dr(r[0],r[1],i[0],i[1],u,a,s);null===(e=this.tilesLoader)||void 0===e||e.instantiateTilesProvider(this.settings),l.forEach((function(e){var n=e.x,r=e.y;return setTimeout((function(){var e;return null===(e=t.tilesLoader)||void 0===e?void 0:e.loadTile(n,r,Math.floor(u))}),10)}))}},{key:"_newCollisionManagement",value:function(e){this.collisionManagement=new Qa,e&&this._initializeCollisionManagement(this.collisionManagement)}},{key:"_initializeCollisionManagement",value:function(e){e.init({asKey:this.asKey.bind(this),getMarkerComponent:this.getMarkerComponent.bind(this),getRectOfMarker:this.getRectOfMarker.bind(this),moveMarkerPosition:this.moveMarkerPosition.bind(this),makeMarkerVisible:this._makeMarkerVisible.bind(this),settings:this.settings})}},{key:"_newClusterers",value:function(){this.clusterers=this.clusterFactory.createClusterers(this.settings.loggerFactory,this.settings.getI18N,this.settings.iso4217CurrencyCode,this.settings.locale,this.settings.clusterConfigurationByType,this.settings.clusterDefaultConfigurationByType)}},{key:"updateConfiguration",value:function(e,t,n){this.configHelper=e,this.settings=t;var r=n.clearHashkeys,i=n.updateMarkers,o=n.updateViewport,a=n.updateMapProviderConfig,s=n.updateKeyboardA11yUI,u=n.updateStyling,l=n.updateTiles,c=n.resetAvailabilityCheck,f=n.resetClusterers,d=n.resetCollisionManagement,h=n.resetContentProviders,p=n.resetRouteManagement,y=n.resetPolygonManagement;if(a&&this.updateMapProviderConfig(),l&&this._updateTilesConfig(),r&&this.clearHashkeys(),c&&this._newAvailabilityCheck(),f&&this._newClusterers(),p){var v,g=null===(v=this.routes)||void 0===v?void 0:v.listRegisteredRoutes();this.resetRouteStyle(),this._newRouteManager(),this.syncRegisteredRoutes(g),this.updateRoutesOnViewport()}return y&&(this.resetRouteStyle(),this._newPolygonManager(),this.updateRoutesOnViewport()),h&&this._newContentProviders(),d&&this._newCollisionManagement(!0),s&&this._newKeyboardFeatures(!0),u&&this._addCssStyleFromConfig(this.settings.styling),tr.getDebugConfigEnabled()&&console.debug("Configurations updated",this.configHelper.getEGMapConfigurations()),i&&this.clearMarkers(),o?this._updateViewport():Promise.resolve()}},{key:"updateRoutesOnViewport",value:function(){var e;null===(e=this.routes)||void 0===e||e.updateRoutesOnViewport()}},{key:"syncRegisteredRoutes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t&&t.forEach((function(t){var n;return null===(n=e.routes)||void 0===n?void 0:n.registerRoute(t.origin,t.destination,t.polyline)}))}},{key:"initMap",value:function(e,t,n,r){var i=this;this.logger.debug("map is initializing");var o=Date.now();this.node=e,this.cssClassId=t,this.idPrefix="".concat(this.node.id,"_"),this._addCssStyleFromConfig(this.settings.styling),this.collisionManagement&&this._initializeCollisionManagement(this.collisionManagement);var a=null==n?void 0:n.options,s=null==a?void 0:a.gaiaId;return tr.getDebugConfigEnabled()&&console.debug("Configurations used",this.configHelper.getEGMapConfigurations()),this._loadHistoricalBoundingBox(s).then((function(){return i.init(n,r)})).then((function(){return i._lateInit()})).then((function(){i.logger.debug("map initialized in ".concat(Date.now()-o,"ms"))}))}},{key:"_lateInit",value:function(){var e=this,t=new Set([].concat(ss(Jr(this.settings.icons)),ss(Yr(this.settings.cornerIcons)),ss(Yr(this.settings.innerIcons)))),n=$r(ss(t));return this._newPolygonManager(),Xr(n,this.addEventListener.bind(this),this.logger).then((function(){e.keyboardFeatures&&e._initializeKeyboardFeatures(e.keyboardFeatures)}))}},{key:"createCopyrightsDiv",value:function(){var e=we(this.uniqId("copyrights-div"),this.node,"copyrights");return Ze(this.copyrightsDiv),e}},{key:"uniqId",value:function(e){return this.idPrefix+e}},{key:"cloneObfuscatedPolygon",value:function(e,t){var n,r,i,o,a,s=ys(this.settings.obfuscateStyle[e.type],e.hashKeys),u=rn(null==s||null===(n=s.line)||void 0===n?void 0:n.opacity),l=rn(null==s||null===(r=s.fill)||void 0===r?void 0:r.opacity),c=t.cloneNode(!0);st(c,"markerClone");var f="".concat(null==s||null===(i=s.fill)||void 0===i?void 0:i.color).concat(l),d="".concat(null==s||null===(o=s.line)||void 0===o?void 0:o.weight,"px"),h="".concat(null==s||null===(a=s.line)||void 0===a?void 0:a.color).concat(u);return c.dataset.cloneStyles="--fillcolor:".concat(f,"; --linewidth:").concat(d,"; --linecolor:").concat(h,";"),c}},{key:"_loadHistoricalBoundingBox",value:function(e){var t=this;return e?Xn(this.settings.historicalBoundingBoxDataEndpoint,5e3).then((function(n){return n.ok?n.json().then((function(n){if(n.errors)return t.logger.error("Failed to fetch historical bounding box data for gaia Id: ".concat(e," - ").concat(n.errors)),Promise.resolve();var r=n.find((function(t){return t.gaia_id===e.toString()}));return null!=r&&r.historical_polygon_wkt&&(t.historicalBoundingBox=dn(r.historical_polygon_wkt)),Promise.resolve()})):Promise.resolve()})):Promise.resolve()}},{key:"_computeNativeBounds",value:function(e,t,n){var r,i=this.node&&0!==(null===(r=this.node)||void 0===r?void 0:r.clientWidth)?this.node.clientHeight/this.node.clientWidth:1,o=(null==n?void 0:n.centeredOn)?this.boundsComputation.computeCenteredBoundingBox(e,n,i):this.boundsComputation.computeBoundingBox(e,t,n,this.historicalBoundingBox,i);return this.computeNativeBoundsFromLatLongs(o)}},{key:"_parseClientPadding",value:function(e){try{if(this.node)return vn(e,this.node)}catch(e){this.logger.error(e.message,e.stack)}}},{key:"boundsContaining",value:function(e,t,n){var r=this,i=null==n?void 0:n.gaiaId,o=qt(e);return i?this._loadHistoricalBoundingBox(i).then((function(){return r.asBounds(r._computeNativeBounds(o,t,n))})):Promise.resolve(this.asBounds(this._computeNativeBounds(o,t,n)))}},{key:"boundsContainingPolygon",value:function(e){var t=qt(qr(e).flat(2));return this.asBounds(this._computeNativeBounds(t,!1))}},{key:"_computeStrictBounds",value:function(e){return this.asBounds(this.computeNativeBoundsFromLatLongs(qt(e)))}},{key:"handleBoundsChanged",value:function(e){var t=this;if(this.logger.debug("bounds changed",e),this.boundChangedDisabled)this.boundChangedDisabled=!1;else{var n=this.getBounds();if(n)return this._updateViewport().then((function(){var r={bounds:n,zoom:t.getZoom(),originalEvent:e};t.eventsManager.pushEvent(fi.boundsChanged,r)}))}return Promise.resolve()}},{key:"getCirclePolygonData",value:function(e){var t=ys(this.settings.obfuscatePrecision[e.type],e.hashKeys),n=ys(this.settings.obfuscateRadiusInMeters[e.type],e.hashKeys);return k([e.latLng[1],e.latLng[0]],n/1e3,{units:"kilometers",steps:t}).geometry.coordinates[0].map((function(e){return{lat:e[1],lng:e[0]}}))}},{key:"setStay",value:function(e){var t;if(!function(e){return void 0!==e.from&&void 0!==e.to&&e.roomOccupancies.length>0&&e.roomOccupancies.every((function(e){return function(e){return e.nbAdults>0}(e)}))}(e))throw new Error("stay is not valid");null!==(t=this.availabilityCheck)&&void 0!==t&&t.saveStay(e)&&(this.cleanAvailabilityTileData(this.features.allProperties()),this._updateViewport())}},{key:"_addCssStyleFromConfig",value:function(e){this.currentStyleId&&ve(this.currentStyleId),e&&Object.keys(e).length>0&&this.cssClassId?(this.currentStyleId=this.uniqId("style"),Ot(this.currentStyleId,"EgMapsStyling",this.cssClassId,e)):this.currentStyleId=void 0}},{key:"cleanAvailabilityTileData",value:function(e){e.forEach((function(e){e.hasTileData()&&(e.tileData.status="unknown",e.tileData.price=void 0)}))}},{key:"refresh",value:function(){return this._updateViewport()}},{key:"updateAvailability",value:function(e){var t,n=this;return null===(t=this.availabilityCheck)||void 0===t?void 0:t.updateAvailability(e).then((function(e){return e.forEach((function(e){return n._fixMarkerToUse(e)}))}))}},{key:"getBounds",value:function(){var e=this.nativeBounds();return this.asBounds(e)}},{key:"_actionOnPreviousMarker",value:function(e){return function(t){return{hideRoute:ys(e[t.type],t.hashKeys).some((function(e){return"showRoutes"===e})),dehighlight:ys(e[t.type],t.hashKeys).some((function(e){return"highlight"===e})),removeAriaLive:ys(e[t.type],t.hashKeys).some((function(e){return"addAriaLive"===e}))}}}},{key:"handleMapClick",value:function(){var e=this;this.logger.debug("map click"),!0!==this.ignoreMapClickEvent?(this.settings.actionsOnMapClick.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapClick.forEach((function(t){var n;switch(t){case"clearHighlight":e.dehighlightFeatures();break;case"clearSelection":e.setSelectedFeature(void 0,e._actionOnPreviousMarker(e.settings.actionsOnMarkerClick),!0);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(n=e.routes)||void 0===n||n.hideRoutes()}}))):this.ignoreMapClickEvent=!1}},{key:"_updateAriaLiveOnFeature",value:function(e,t){var n;e&&(t?e.marker&&Ie(e.marker.ariaElement)&&je(e.marker.ariaElement):Be(null===(n=e.marker)||void 0===n?void 0:n.ariaElement))}},{key:"handleClick",value:function(e,t,n,r){var i=this,o=e;if(o||t||!this.popup||(o=this.popup.feature),o&&o.visible&&o.type){var a=this.isFeatureSelected(o),s=this._isFeatureHighlighted(o),u=ys(n[o.type],o.hashKeys);if(u.forEach((function(e){var t;switch(e){case"highlight":s||i._setHighlightedFeature(o);break;case"select":i.setSelectedFeature(o,i._actionOnPreviousMarker(i.settings.actionsOnMarkerClick),!0);break;case"toggleSelect":i.setSelectedFeature(a?void 0:o,i._actionOnPreviousMarker(i.settings.actionsOnMarkerClick),!0);break;case"openPopup":i._openPopup(o);break;case"closePopup":i._closePopup();break;case"zoomToExtent":i._zoomToExtent(o);break;case"showRoutes":null===(t=i.routes)||void 0===t||t.showRoutes(o);break;case"loadFeatureContent":a||i.loadFeatureContent(o.id,o.type)}})),u.includes("addAriaLive")){var l=o;a?u.includes("toggleSelect")&&this._updateAriaLiveOnFeature(l,!1):this._updateAriaLiveOnFeature(l,!0)}u.includes("bounce")&&su(o.marker)}}},{key:"bounceMarker",value:function(e,t){var n=this._findFeature(e,t);null!=n&&n.marker&&su(n.marker)}},{key:"asKey",value:function(e){var t=e.id,n=e.type;return"".concat(n,"-").concat(t)}},{key:"_setPopupVisible",value:function(e){var t,n;e?He(null===(t=this.popup)||void 0===t?void 0:t.visibleElement):Ze(null===(n=this.popup)||void 0===n?void 0:n.visibleElement)}},{key:"_findFeature",value:function(e,t){return this.features.find(e,t)}},{key:"_findClusterContainingFeature",value:function(e,t){return this.features.allClusters().find((function(n){return n.children.some((function(n){return n.id===e&&n.type===t}))}))}},{key:"setPopupContent",value:function(e,t,n){var r=this._findFeature(e,t);r&&(r.popupContent=n)}},{key:"_openPopup",value:function(e){if(this.popup){var t,n=(e||{}).name;if(e&&void 0===e.popupContent&&n){var r=we(this.uniqId("popup-div"),void 0,"default-popup-content");_e(this.uniqId("popup-span"),r,void 0,void 0,n),e.popupContent=r}if(void 0!==this.popup.feature&&this.popup.feature===e||(this.popup.feature=e),null!==(t=this.popup.feature)&&void 0!==t&&t.popupContent){this._fillPopupContent(this.popup.feature),this._setPopupVisible(!0),this.updatePopupPositionOnLayer();var i=this.configHelper.popupVisibilities()[this.popup.feature.type];ys(i,this.popup.feature.hashKeys)&&this.ensurePopupVisibility()}else this._fillPopupContent(),this._setPopupVisible(!1)}}},{key:"_calculatePopupVisibilityOffsetValues",value:function(e,t,n,r,i,o,a,s){var u=0,l=0;return e.x<-0+t?u=e.x+0-t:e.x+o+0+t>r&&(u=e.x+o+0+t-r),s?e.y<-2+n+a?l=e.y+2-n-a:e.y+2+n>i&&(l=e.y+2+n-i):e.y<-2+n?l=e.y+2-n:e.y+a+2+n>i&&(l=e.y+a+2+n-i),[u,l]}},{key:"_closePopup",value:function(){this.popup&&(delete this.popup.feature,this._fillPopupContent(),this._setPopupVisible(!1))}},{key:"_fillPopupContent",value:function(e){if(this.popup)if(ye(this.popup.content),e&&e.popupContent){this.popup.content.appendChild(e.popupContent);var t=this.popup.backupStyleClass,n=ys(this.settings.popupPositions[e.type],e.hashKeys),r=[e.type,e.status,n];e.qualifiers&&r.push.apply(r,ss(e.qualifiers)),this.popup.backupStyleClass=r,ot(this.popup.cssElement,t,this.popup.backupStyleClass)}else{var i=this.popup.backupStyleClass;this.popup.backupStyleClass=void 0,ot(this.popup.cssElement,i,this.popup.backupStyleClass)}}},{key:"fillPopupExternally",value:function(e,t){e.popupContent=t,this._openPopup(e)}},{key:"isFeatureSelected",value:function(e){var t,n;return void 0!==e&&(null===(t=this.mapData.selectedFeature)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)&&(null===(n=this.mapData.selectedFeature)||void 0===n?void 0:n.type)===(null==e?void 0:e.type)}},{key:"getFeatureSelected",value:function(){var e;return null===(e=this._getFeatureSelected())||void 0===e?void 0:e.toData()}},{key:"_getFeatureSelected",value:function(){if(this.mapData.selectedFeature){var e=this.mapData.selectedFeature,t=e.id,n=e.type;return this._findFeature(t,n)}}},{key:"setSelectedFeature",value:function(e,t,n){if(!this.isFeatureSelected(e)){var r=this._getFeatureSelected();if(e){var i=e.id,o=e.type;this.mapData.selectedFeature={id:i,type:o}}else this.mapData.selectedFeature=void 0;if(null!=r&&r.marker){var a=r.status,s=r.qualifiers,u=vs(a,!1,s),l=ys(this.settings.zIndexes[r.type],u);au(r.marker,l)}if(e&&e.marker){var c=e.status,f=e.qualifiers,d=vs(c,!0,f),h=ys(this.settings.zIndexes[e.type],d);au(e.marker,h)}if(r){var p,y=t(r),v=y.hideRoute,g=void 0!==v&&v,m=y.dehighlight,b=void 0!==m&&m,k=y.removeAriaLive,w=void 0!==k&&k;g&&(null===(p=this.routes)||void 0===p||p.hideRoutes(r)),b&&this._dehighlightFeature(r),w&&this._updateAriaLiveOnFeature(r,!1)}if((e||r)&&n){var P,C=this.fillPopupExternally.bind(this,e);if(e?P={action:"select",feature:e.toData(),setPopupContent:C,previousSelectedFeature:null==r?void 0:r.toData()}:r&&(P={action:"clearSelection",feature:r.toData(),setPopupContent:C}),this.keyboardFeatures){var L=this.keyboardFeatures;setTimeout((function(){return L.updateKeyboardFeatures()}),50)}P&&this.eventsManager.pushEvent(fi.selectionChanged,P)}}}},{key:"_zoomToFeature",value:function(e,t){var n=this,r=e.id,i=e.type,o=t||this._findClusterContainingFeature(r,i);return o?this._zoomToExtent(o).then((function(){var t=n._findClusterContainingFeature(null==e?void 0:e.id,null==e?void 0:e.type);return t?n._zoomToFeature(e,t):(n.handleBoundsChanged("clusterExtent"),Promise.resolve())})):Promise.resolve()}},{key:"_zoomToExtent",value:function(e){var t=this,n=e.children;if(n&&n.length>0){this._clearClusters();var r=n.map((function(e){return e.latLng}));return this.boundsContaining(r,!1).then((function(e){return t.fitBounds(e.sw,e.ne).then((function(){return t.handleBoundsChanged("clusterExtent")}))}))}return Promise.resolve()}},{key:"handleKeyPress",value:function(e,t,n){var r=this,i=e;i&&i.visible&&i.type&&ys(t[i.type],i.hashKeys).forEach((function(e){if(e===n.toLowerCase()){var t={keyCode:n,feature:i.toData()};r.eventsManager.pushEvent(fi.keyPressed,t)}}))}},{key:"mouseHoveringAsKey",value:function(e,t){var n=e.id,r=e.type;return"".concat(r,"-").concat(n,"-mouse-").concat(t?"over":"out")}},{key:"handleMouseOver",value:function(e,t,n,r){var i=this,o=e;if(o||t||!this.popup||(o=this.popup.feature),o&&o.visible&&o.type){var a=this.asKey(o),s=this.mapData.featuresOver.has(a);this.mapData.featuresOver.add(a),s||ys(n[o.type],o.hashKeys).forEach((function(e){switch(e){case"highlight":i._setHighlightedFeature(o);break;case"openPopup":i._openPopup(o);break;case"sendEvent":var t={action:"mouseEnter",feature:o.toData(),setPopupContent:i.fillPopupExternally.bind(i,o)};i.eventsManager.pushEvent(fi.hoverChanged,t)}}))}}},{key:"handleMouseOut",value:function(e,t,n,r){var i=this,o=e;if(o||t||!this.popup||(o=this.popup.feature),o&&o.visible&&o.type){var a=this.asKey(e);this.mapData.featuresOver.has(a)&&(this.mapData.featuresOver.delete(a),ys(n[o.type],o.hashKeys).forEach((function(e){switch(e){case"dehighlight":i._dehighlightFeature(o);break;case"dehighlightIfNotSelected":i.isFeatureSelected(o)||i._dehighlightFeature(o);break;case"sendEvent":var t={action:"mouseLeave",feature:o.toData(),setPopupContent:i.fillPopupExternally.bind(i,o)};i.eventsManager.pushEvent(fi.hoverChanged,t);break;case"closePopup":i._closePopup()}})))}}},{key:"handleDragStart",value:function(){var e=this;this.settings.actionsOnMapDrag.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapDrag.forEach((function(t){var n;switch(t){case"clearHighlight":e.dehighlightFeatures();break;case"clearSelection":e.setSelectedFeature(void 0,e._actionOnPreviousMarker(e.settings.actionsOnMarkerClick),!0);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(n=e.routes)||void 0===n||n.hideRoutes()}}))}},{key:"selectFeature",value:function(e,t,n){var r=this,i=this._findFeature(e,t);if(i){var o=ys(this.settings.actionsOnFeatureSelect[i.type],i.hashKeys),a=o.includes("zoomToExtentCluster")?this._zoomToFeature(i):Promise.resolve();if(i&&!this.isFeatureSelected(i))return a.then((function(){r.setSelectedFeature(i,r._actionOnPreviousMarker(r.settings.actionsOnFeatureSelect),!1),n&&r.setPopupContent(i.id,i.type,n),o.includes("addAriaLive")&&r._updateAriaLiveOnFeature(i,!0),o.forEach((function(e){var t;switch(e){case"highlight":r._setHighlightedFeature(i);break;case"openPopup":r._openPopup(i);break;case"closePopup":r._closePopup();break;case"showRoutes":null===(t=r.routes)||void 0===t||t.showRoutes(i);break;case"showLinkedFeatures":r.loadFeatureContent(i.id,i.type)}})),o.includes("bounce")&&su(i.marker)}))}return Promise.resolve()}},{key:"registerRouteDestination",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null===(e=this.routes)||void 0===e?void 0:e.registerRouteDestination.apply(e,n)}},{key:"registerRoute",value:function(e,t,n){var r;return!0===(null===(r=this.routes)||void 0===r?void 0:r.registerRoute(e,t,n))}},{key:"listRegisteredRouteDestinations",value:function(){var e;return(null===(e=this.routes)||void 0===e?void 0:e.listRegisteredRouteDestinations())||[]}},{key:"listRegisteredRoutes",value:function(e){var t;return(null===(t=this.routes)||void 0===t?void 0:t.listRegisteredRoutes(e))||[]}},{key:"deregisterRouteDestination",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(null===(e=this.routes)||void 0===e?void 0:e.deregisterRouteDestination.apply(e,n))||[]}},{key:"deregisterRoute",value:function(e,t){var n;return(null===(n=this.routes)||void 0===n?void 0:n.deregisterRoute(e,t))||[]}},{key:"showRoutes",value:function(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));var n=this._findFeature(e,t);if(n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return this.routes.showRoutes(n,i,!1)}return Promise.reject(new Error("feature ".concat(t,"-").concat(e," is not found")))}},{key:"showPolygons",value:function(){var e;return(e=this.polygonsManager).showPolygons.apply(e,arguments)}},{key:"hidePolygons",value:function(){var e;return(e=this.polygonsManager).hidePolygons.apply(e,arguments)}},{key:"listPolygonsDisplayed",value:function(){return this.polygonsManager.listPolygonsDisplayed()}},{key:"addQualifierToFeature",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._updateQualifierFromFeatures.apply(this,[[{id:e,type:t}],function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.addQualifier.apply(e,n)}].concat(r))}},{key:"addQualifierToFeatures",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this._updateQualifierFromFeatures.apply(this,[e,function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.addQualifier.apply(e,n)}].concat(n))}},{key:"removeQualifierFromFeature",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._updateQualifierFromFeatures.apply(this,[[{id:e,type:t}],function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.removeQualifier.apply(e,n)}].concat(r))}},{key:"removeQualifierFromFeatures",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this._updateQualifierFromFeatures.apply(this,[e,function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.removeQualifier.apply(e,n)}].concat(n))}},{key:"_updateQualifierFromFeatures",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var a=!1;return e.forEach((function(e){var r=e.id,o=e.type,s=n._findFeature(r,o);s&&t.apply(void 0,[s].concat(i))&&(n._fixMarkerToUse(s),a=!0)})),a?this._updateViewport().then((function(){return!0})):Promise.resolve(!1)}},{key:"loadFeatureContent",value:function(e,t){var n,r=this,i=null===(n=this.contentProvider)||void 0===n?void 0:n.getFeatureProviders()[t];if(i){var o=[];return Object.keys(i).forEach((function(n){var a=new Promise((function(o,a){i[n].loadFeatureContent(e,t).then((function(n){var i=n.linkedFeatures,a=r.features.allExceptClusters().filter((function(e){var t;return null===(t=e.qualifiers)||void 0===t?void 0:t.some((function(e){return-1!==e.toString().indexOf("linked-features")}))})),s=null==i?void 0:i.filter((function(e){return!a.find((function(t){return e.id===t.id}))}));null==s||s.forEach((function(e){return r.createTileFeature(e)}));var u=null==i?void 0:i.filter((function(e){return a.find((function(t){return t.id===e.id}))}));null==u||u.forEach((function(n){n.qualifiers.includes("linked-features-".concat(e,"-").concat(t))||n.qualifiers.push("linked-features-".concat(e,"-").concat(t))})),null==u||u.forEach((function(e){return r.features.upsertTileData(e,r.configHelper)})),r.features.all().filter((function(e){return e.type===t})).map((function(e){return e.id})).forEach((function(e){r.configHelper.removeParam("markers,place,show,linked-features-".concat(e,"-").concat(t))})),r.configHelper.writeParam("markers,place,show,linked-features-".concat(e,"-").concat(t),!0),r._updateViewport().then((function(){var i={success:!0,id:e,type:t,content:n};r.eventsManager.pushEvent(fi.featureContentLoaded,i),o(void 0)}))})).catch((function(e){var t={success:!1,error:e};r.eventsManager.pushEvent(fi.featureContentLoaded,t),a(e)}))}));o.push(a)})),$n(o)}return Promise.reject(new Error("content provider is not enabled"))}},{key:"hideRoutes",value:function(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));var n=this._findFeature(e,t);if(n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return this.routes.hideRoutes(n,i,!1)}return Promise.reject(new Error("feature ".concat(t,"-").concat(e," is not found")))}},{key:"listRoutesDisplayed",value:function(){var e;return(null===(e=this.routes)||void 0===e?void 0:e.listRoutesDisplayed())||[]}},{key:"handleTilesLoaded",value:function(e,t,n){this.logger.debug("".concat(e," tiles loaded - ").concat(t," - ").concat(n));var r={origin:e,contentType:t,tileIds:n};this.eventsManager.pushEvent(fi.tilesLoaded,r)}},{key:"handleTilesContentLoaded",value:function(e){this.eventsManager.pushEvent(fi.tilesContentLoaded,e)}},{key:"addCopyright",value:function(e,t){var n=qe(this.copyrightsDiv),r=ss(this.copyrights.entries()).filter((function(e){var n=as(e,2);return n[0],n[1].content===t}));if(r.length>0)r[0][1].ownerIds.push(e);else{var i=an(),o=this.uniqId("copyright-div-".concat(i));this.copyrights.set(o,{content:t,ownerIds:[e]}),_e(void 0,we(o,this.copyrightsDiv,"copyright"),"copyright-text",void 0,t),n||He(this.copyrightsDiv)}}},{key:"removeCopyrightForOwner",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){ss(e.copyrights.entries()).forEach((function(n){var r=as(n,2),i=r[0],o=r[1].ownerIds,a=o.findIndex((function(e){return e===t}));a>=0&&(o.splice(a,1),0==o.length&&(ge(e.copyrightsDiv,i),e.copyrights.delete(i)))}))}))}},{key:"clearSelectedFeature",value:function(){var e=this,t=this._getFeatureSelected();if(t){this.setSelectedFeature(void 0,this._actionOnPreviousMarker(this.settings.actionsOnFeatureSelect),!1);var n=ys(this.settings.actionsOnFeatureDeselect[t.type],t.hashKeys);if(n.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(t,!1),n.forEach((function(n){var r;switch(n){case"dehighlight":e._dehighlightFeature(t);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(r=e.routes)||void 0===r||r.hideRoutes(t)}})),this.keyboardFeatures){var r=this.keyboardFeatures;setTimeout((function(){return r.updateKeyboardFeatures()}),50)}}}},{key:"listHighlightedFeatures",value:function(){var e=this;return this.mapData.highlightedFeatures.flatMap((function(t){var n=t.id,r=t.type,i=e._findFeature(n,r);if(i)return i.toData()}))}},{key:"markFeatureOver",value:function(e,t){var n=this,r=this._findFeature(e,t);if(r){var i="cluster"!==r.type?this._findClusterContainingFeature(e,t):void 0;ys(this.settings.actionsOnFeatureOver[r.type],r.hashKeys).forEach((function(e){switch(e){case"highlight":n._setHighlightedFeature(i||r);break;case"openPopup":n._openPopup(r)}}))}}},{key:"markFeatureOut",value:function(e,t){var n=this,r=this._findFeature(e,t);if(r){var i="cluster"!==r.type?this._findClusterContainingFeature(e,t):null;ys(this.settings.actionsOnFeatureOut[r.type],r.hashKeys).forEach((function(e){switch(e){case"dehighlight":n._dehighlightFeature(i||r);break;case"dehighlightIfNotSelected":n.isFeatureSelected(i||r)||n._dehighlightFeature(i||r);break;case"closePopup":n._closePopup()}}))}}},{key:"_highlightMarker",value:function(e,t){e.highlighted=t,e.marker&&this._fixMarkerToUse(e)}},{key:"_setHighlightedFeature",value:function(e){if(!this._isFeatureHighlighted(e)){var t=e.id,n=e.type;this.mapData.highlightedFeatures.push({id:t,type:n}),this._highlightMarker(e,!0)}}},{key:"_dehighlightFeature",value:function(e){var t=this._getFeatureHighlightIndex(e);t>=0&&(this.mapData.highlightedFeatures.splice(t,1),this._highlightMarker(e,!1))}},{key:"_getFeatureHighlightIndex",value:function(e){var t=e.id,n=e.type;return this.mapData.highlightedFeatures.findIndex((function(e){var r=e.id,i=e.type;return t===r&&n===i}))}},{key:"_isFeatureHighlighted",value:function(e){return this._getFeatureHighlightIndex(e)>=0}},{key:"dehighlightFeatures",value:function(){var e=this,t=[];this.mapData.highlightedFeatures.forEach((function(n){var r=n.id,i=n.type,o=e._findFeature(r,i);!o||e.isFeatureSelected(o)&&ys(e.settings.actionsOnFeatureOut[o.type],o.hashKeys).includes("dehighlightIfNotSelected")?t.push({id:r,type:i}):e._highlightMarker(o,!1)})),this.mapData.highlightedFeatures=t}},{key:"turnFeaturesVisible",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;this.configHelper.overrideMarkerShowConfig(e,t,n,r),i&&this._updateViewport()}},{key:"_createGenericPopup",value:function(e){var t=this,n=we(this.uniqId("popup"),e,"popup","visibility:false"),r=we(void 0,n,"popup-close-button close-button");we(void 0,r,"leftright"),we(void 0,r,"rightleft"),we(void 0,r,"close");var i=this._closePopup.bind(this);n.content=we(void 0,n,"popup-content");var o=this.updatePopupPositionOnLayer.bind(this);return new ResizeObserver(o).observe(n.content),n.clean=[this.addEventListener(r,gs,(function(e){var n;e.stopPropagation(),null!==(n=t.popup)&&void 0!==n&&n.feature&&t.mapData.featuresOver.delete(t.asKey(t.popup.feature)),i()}))],n.visibleElement=void 0,n.cssElement=void 0,n}},{key:"_createHtmlClusterMarker",value:function(e,t,n,r,i){var o=we(this.uniqId("marker-".concat(n,"-cluster-").concat(t.id)),e,"cluster-marker cluster-".concat(n,"-marker ").concat(null==r?void 0:r.split("#").join(" ")),"position:absolute;visibility:false;".concat(i||"")),a=_e(void 0,o,"cluster-label");return _e(void 0,a,"cluster-label-content",void 0,t.text),o.cssElement=o,{main:o,span:a}}},{key:"_createClusterMarker",value:function(e,t,n,r,i){var o=this._createHtmlClusterMarker(e,t,n,r,i),a=o.main,s=o.span;return a.bounceElement=s,a.cssElement=a,a}},{key:"_clearClusters",value:function(e){var t=this;this.features.allClusters().filter((function(t){var n;return void 0===e||(null===(n=t.marker)||void 0===n||null===(n=n.cssElement)||void 0===n||null===(n=n.classList)||void 0===n?void 0:n.contains("cluster-".concat(e,"-marker")))})).forEach((function(e){t._deleteFeatureMarker(e),t.features.delete(e.id,e.type)}))}},{key:"_pushClusterData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=os(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n?this.features.upsertUserData(i,this.configHelper):this.features.upsertTileData(i,this.configHelper)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_notifyStatusUsageForType",value:function(e,t){this.configHelper.loadQualifiersAndHashkeysUsed(e),this.features.repository(e).data.forEach((function(e){e.refreshHashkeys()}))}},{key:"_updateViewport",value:function(e){var t,n=e;return n||(n=this.nativeBounds()),null!==(t=this.availabilityCheck)&&void 0!==t&&t.isAvailabilityCheckActive()?this._updateViewportWithAvailabilityCheck(n):this._updateViewportAux(n)}},{key:"_updateViewportAux",value:function(e){var t=this;this.boundsToRefresh=this.asBounds(e);var n=this.configHelper.markersShow(),r=this.configHelper.markersKeepOutOfViewport(),i=Fa.map((function(i){return new Promise((function(o){t._changeMarkersVisibility(e,i,n[i],r[i]),o(void 0)}))}));return Promise.all(i).then((function(){var n=t.getBounds();return n&&t.boundsToRefresh&&$t(n,t.boundsToRefresh)&&(t.keyboardFeatures&&setTimeout((function(){var e;return null===(e=t.keyboardFeatures)||void 0===e?void 0:e.updateKeyboardFeatures()}),100),t.collisionManagement&&t.collisionManagement.handleMarkerLabelCollision(t.features.all(),t.getZoom())),e}))}},{key:"_updateViewportWithAvailabilityCheck",value:function(e){var t=this;this.boundsToRefresh=this.asBounds(e);var n=[],r=this.configHelper.markersShow(),i=this.configHelper.markersKeepOutOfViewport();return n.push(this._updateViewportAux(e)),Oa.forEach((function(o){var a=t.features.allWithCoordinates(o).filter((function(n){return t.isFeatureInRealBound(e,n)}));n.push(t.updateAvailability(a).then((function(){var n=t.getBounds();if(n&&t.boundsToRefresh&&$t(n,t.boundsToRefresh))return t._changeMarkersVisibility(e,o,r[o],i[o]),Promise.resolve()})).catch((function(e){t.logger.error("Failed to update availabilities: ".concat(e.message),e.stack)})))})),Promise.all(n).then((function(){var n=t.getBounds();return t.keyboardFeatures&&n&&t.boundsToRefresh&&$t(n,t.boundsToRefresh)&&t.keyboardFeatures.updateKeyboardFeatures(),e}))}},{key:"_changeClusterMarkerVisibility",value:function(e,t,n,r){var i=this,o=this.getBounds(),a={clusters:[],remainingFeatures:t};this._clearClusters(e),this.clusterers&&this.clusterers[e].forEach((function(t){var r=t.clusterer,s=t.qualifier;if(r){try{var u,l,c,f,d={clientWidth:null!==(u=null===(l=i.node)||void 0===l?void 0:l.clientWidth)&&void 0!==u?u:0,clientHeight:null!==(c=null===(f=i.node)||void 0===f?void 0:f.clientHeight)&&void 0!==c?c:0};a=r.getClustersAndFeatures(a,e,s,o,n,d,i.getTileDim())}catch(e){i.logger.warn("Failed to compute cluster: ".concat(e.message),e.stack)}i._pushClusterData(a.clusters,!1)}})),a.clusters.forEach((function(e){var t=i.features.allClusters().find((function(t){return t.id===e.id}));t&&!t.marker&&i._createMarker(t)}));var s,u=a.remainingFeatures.map((function(e){return e.id})),l=os(t);try{for(l.s();!(s=l.n()).done;){var c=s.value;u.includes(c.id)&&(r.push(c.id),c.marker?c.visible=!0:this._makeMarkerVisible(c,!0))}}catch(e){l.e(e)}finally{l.f()}}},{key:"_haveSomeClustersByFeatureType",value:function(e){return void 0!==this.clusterers&&void 0!==this.clusterers[e]&&this.clusterers[e].length>0}},{key:"_changeMarkersVisibility",value:function(e,t,n,r){var i=this,o=this.getZoom(),a=this.mapData[t].withMarkers,s=this._identifyFeatureWithMarkerAddedToMap(e,o,t,n,r),u=s.inBounds,l=s.outBounds,c=[];this._haveSomeClustersByFeatureType(t)?this._changeClusterMarkerVisibility(t,u,o,c):[].concat(ss(u),ss(l)).forEach((function(e){c.push(e.id),e.marker?(e.visible=!0,e.marker.labels.resetTextLabel(o),e.marker.labels.resetTextSubLabel(o)):i._makeMarkerVisible(e,!0)})),a.filter((function(e){return!c.includes(e.id)})).forEach((function(e){return i._makeMarkerVisible(e,!1)}))}},{key:"_featureShouldHaveMarker",value:function(e,t,n,r){var i,o=null===(i=e.tileData)||void 0===i?void 0:i.tile,a=o&&o.length>=3?o[2]:void 0,s=ys(n,e.hashKeys);return!!((void 0===a||e.hasUserData()||a<=r)&&ys(this.settings.minZoomForDisplay[e.type],e.hashKeys)<=r&&s)&&(!this.isFeatureInRealBound(t,e)||"inViewport")}},{key:"_retrieveCandidates",value:function(e,t,n,r,i,o){for(var a=e.length,s=0;s<a;){var u=e[s];s++;var l=this._featureShouldHaveMarker(u,t,n,i);if(!1!==l){var c=ys(r,u.hashKeys)||"inViewport"===l;!1!==c&&o(u,c)}}}},{key:"_identifyFeatureWithMarkerAddedToMap",value:function(e,t,n,r,i){var o=[],a={selected:{threshold:-1,maxZoomForCount:1,inB:[],outB:[]}};for(var s in this.settings.threshold[n]){var u=this.settings.threshold[n][s],l=ys(this.settings.maxZoomForCount[n],[s]);a[s]={threshold:u,maxZoomForCount:l,inB:[],outB:[]}}this._retrieveCandidates(this.features.allWithCoordinates(n),e,r,i,t,(function(e,t){return ys(a,e.hashKeys)[t?"inB":"outB"].push(e)}));var c=[];for(var f in a){var d=a[f],h=d.threshold,p=d.maxZoomForCount,y=d.inB,v=d.outB;y.length>0&&(t>=p||h<0||y.length<=h)&&(c=c.concat(y)),v.length>0&&(t>=p||h<0||y.length+v.length<=h)&&(o=o.concat(v))}return this.mapData[n].withMarkers=[].concat(ss(c),ss(o)),{inBounds:c,outBounds:o}}},{key:"updateConfigHelperOnFeatures",value:function(e){this.features.all().forEach((function(t){t.updateConfigHelper(e)}))}},{key:"clearHashkeys",value:function(){this.features.all().forEach((function(e){e.clearHashkeys()}))}},{key:"clearMarkers",value:function(){var e=this;this.features.all().forEach((function(t){t.marker&&(e.removeMarkerFromMap(t.marker),delete t.marker)}))}},{key:"listFeatures",value:function(e,t){return this._listFeatures(e,t).map((function(e){return e.toData()}))}},{key:"_listFeatures",value:function(e,t){var n=this,r=this.features.all();if(t){var i=this.asNativeBounds(t.sw,t.ne);r=r.filter((function(e){return void 0!==e})).filter((function(e){return n.isFeatureInRealBound(i,e)}))}return e&&(r=r.filter(e)),r}},{key:"pushFeatureData",value:function(e,t,n){var r=this;this.logger.debug("push feature data");var i=[],o=[],a=[],s=[];this._pushFeatureDataModifyFeatures(e,i,a,o);var u=o.concat(i);switch(t){case"merge":if(a.length===e.length)return;break;case"replace":var l=e.map(this.asKey),c=this.features.allExceptClusters().filter((function(e){return!l.includes(r.asKey(e))}));s=this._removePushedFeatureDataAux(c,!1);break;default:throw new Error("action ".concat(t," not supported"))}if(n&&this._pushFeatureDataHandleEvents(u,s),this.mapData.selectedFeature&&s.map(this.asKey).includes(this.asKey(this.mapData.selectedFeature))&&this.clearSelectedFeature(),u.length>0||s.length>0)return this._updateViewport(),this._computeStrictBounds(u.concat(a).filter((function(e){return void 0!==e.latLng})).map((function(e){return e.latLng})))}},{key:"_pushFeatureDataModifyFeatures",value:function(e,t,n,r){var i,o=os(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=this.features.repository(a.type).find(a.id);if(s)if(s.isUserDataChanged(a)){var u=this.features.upsertUserData(a,this.configHelper);this._fixMarkerToUse(u),t.push(u)}else n.push(s);else{var l=this.features.upsertUserData(a,this.configHelper);this._fixMarkerToUse(l),r.push(l)}}}catch(e){o.e(e)}finally{o.f()}}},{key:"updatePartiallyFeature",value:function(e){var t=this,n=[],r=e.flatMap((function(e){e.id,e.type;var r=is(e,es),i=t.features.repository(e.type).find(e.id);return i?ns(ns({},i.toData()),r):(n.push(e),[])}));return this.pushFeatureData(r,"merge",!1),n}},{key:"_pushFeatureDataHandleEvents",value:function(e,t){var n=[];if(e.length>0){var r=this._computeStrictBounds(e.filter((function(e){return void 0!==e.latLng})).map((function(e){return e.latLng})));n.push({type:"addedOrUpdated",features:e.map((function(e){return e.toData()})),bounds:r})}if(t.length>0){var i=this._computeStrictBounds(t.filter((function(e){return void 0!==e.lat&&void 0!==e.lng})).map((function(e){return[e.lat,e.lng]})));n.push({type:"removed",features:t,bounds:i})}if(n.length>0){var o={changes:n};this.eventsManager.pushEvent(fi.markersChanged,o)}}},{key:"removePushedFeatureData",value:function(e){var t,n,r=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.logger.debug("removing pushed feature data"),this.logger.debug(e),void 0!==e){var o=e.map((function(e){var t=e.id,n=e.type;return r.features.repository(n).find(t)})).filter((function(e){return void 0!==e}));n=this._removePushedFeatureDataAux(o,i)}else{var a=this.features.allExceptClusters();n=this._removePushedFeatureDataAux(a,i)}return(null===(t=n)||void 0===t?void 0:t.length)>0&&this._updateViewport(),n}},{key:"onMarkerIconsChanged",value:function(e){}},{key:"_fixMarkerToUse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,n=t.identifyMarkerProperties(e,this.settings),r=n.icons,i=n.zIndex,o=n.cssClasses,a=e.marker,s=e.ariaLabels,l=null==r?void 0:r.pin,c=this.onMarkerIconsChanged.bind(this),f=this.addEventListener.bind(this);this._shouldRecreateMarker(e,n)?this.switchMarkerType(e,n):a&&(r&&!Y(l)&&t.setMarkerIcons(e,r,f,this.logger).then((function(t){return t&&c(e),t})),ot(a.cssElement,o.toRemove,o.toAdd),t.switchAriaLabel(e.highlighted,a.ariaElement,s),a.cssClasses=o.toAdd,au(a,i),iu(e,this.settings,this.getZoom()))}},{key:"_shouldRecreateMarker",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u;if("clusterMarker"===e.markerType)return!1;var a=e.markerType,s=e.marker,l=t.icons,c=void 0===l?{}:l,f=t.markerType,d=t.label,h=t.frameIcon,p=c.pin,y=c.cornerIcons,v=void 0===y?{}:y,g=c.innerIcons,m=void 0===g?{}:g,b=null==s||null===(n=s.iconElements)||void 0===n||null===(n=n.pin)||void 0===n?void 0:n.hashCode;return f!==a||o.haveCornerIconsChanged((null==s||null===(r=s.iconElements)||void 0===r?void 0:r.cornerIcons)||{},v)||o.haveInnerIconsChanged((null==s||null===(i=s.iconElements)||void 0===i?void 0:i.innerIcons)||{},m)||("price"===f||"text"===f||"priceObfuscate"===f)&&d!==(null==s?void 0:s.label)||("pin"===f||"pinObfuscate"===f)&&h!==(null==s?void 0:s.frameIcon)||b&&(!Y(p)||b!==Pn(J(p)||""))||void 0===b&&Y(p)||this._hasObfuscateMarker(e)&&this.hasObfuscateAreaStyleChanged(e)}},{key:"_hasObfuscateMarker",value:function(e){var t=null==e?void 0:e.markerType;if(t)return"obfuscate"===t||"pinObfuscate"===t||"priceObfuscate"===t}},{key:"_removePushedFeatureDataAux",value:function(e,t){var n,r=[],i=os(e.filter((function(e){return e.hasUserData()})));try{for(i.s();!(n=i.n()).done;){var o=n.value;this.popup&&this.popup.feature&&this.popup.feature.id===o.id&&this._closePopup(),this.isFeatureSelected(o)&&this.clearSelectedFeature(),o.marker&&this.removeMarkerFromMap(o.marker),r.push(o.toData()),o.removeUserData()}}catch(e){i.e(e)}finally{i.f()}if(r.length>0&&t){var a=this._computeStrictBounds(r.filter((function(e){return void 0!==e.latLng})).map((function(e){return e.latLng}))),s={changes:[{type:"removed",features:r,bounds:a}]};this.eventsManager.pushEvent(fi.markersChanged,s)}return r}},{key:"createTileFeature",value:function(e){return this.features.insertTileDataWithLowestZoom(e,this.configHelper)}},{key:"removeTileFeature",value:function(e){return this.features.deleteTileData(e)}},{key:"_makeMarkerVisible",value:function(e,t){e.visible=t,t?this._createMarker(e):e.marker&&this._deleteFeatureMarker(e)}},{key:"_createMarker",value:function(e,t){var n=t;n||(n=tu(e,this.settings));var r,i=n,o=i.markerType,a=i.icons,s=i.frameIcon,u=i.cssClasses,l=i.zIndex,c=i.textContent,f=void 0===c?"?":c,d=i.label,h=i.subLabel,p=a||{},y=p.pin,v=p.cornerIcons,g=p.innerIcons,m=e.ariaLabels;this.clearObfuscateArea(e);var b={feature:e,container:ye(this.getMarkerComponent(e)),cssClasses:u.toAdd,zIndex:l,label:d,subLabel:h,ariaLabels:m},k=ns(ns({},b),{},{cornerIcons:v,innerIcons:g});switch(o){case"price":r=this.createTextMarkerWithClickListener(k,f,"price");break;case"text":r=this.createTextMarkerWithClickListener(k,f,"text");break;case"pin":"none"===s&&(k.innerIcons=void 0),r=this.createPinMarkerWithClickListener(k,y,s);break;case"obfuscate":r=this.createObfuscateMarkerWithClickListener(b);break;case"pinObfuscate":"none"===s&&(k.innerIcons=void 0),r=this.createPinObfuscateMarkerWithClickListener(k,y,s);break;case"priceObfuscate":r=this.createPriceObfuscateMarkerWithClickListener(k,f);break;case"clusterMarker":var w=e;r=this.createClusterMarkerWithClickListener(w,w.featureType,w.qualifier);break;default:throw new Error("marker type not supported: ".concat(o))}e.markerType=o,e.marker=r,e.marker.cssClasses=u.toAdd}},{key:"_deleteFeatureMarker",value:function(e){this.clearObfuscateArea(e),this.removeMarkerFromMap(e.marker),delete e.marker}},{key:"switchMarkerType",value:function(e,t){return e.marker&&(e.visible||this._deleteFeatureMarker(e)),e.markerType=t.markerType,!!e.visible&&(this._createMarker(e,t),!0)}},{key:"turnKeyboardFeaturesMode",value:function(e){if(!this.keyboardFeatures)throw new Error("You need to enable keyboard features from config in order to use it.");this.keyboardFeatures.turnKeyboardFeaturesMode(e)}},{key:"isKeyboardFeaturesModeEnabled",value:function(){var e;return!!this.keyboardFeatures&&(null===(e=this.keyboardFeatures)||void 0===e?void 0:e.isKeyboardFeaturesModeEnabled())}},{key:"_zIndexAdjustment",value:function(e){return e}}],n&&cs(t.prototype,n),r&&cs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(e,t){return Promise.reject(new Error("method init not implemented"))}},{key:"clearObfuscateArea",value:function(e){throw new Error("method clearObfuscateArea not implemented")}},{key:"createPinMarkerWithClickListener",value:function(e,t,n){throw new Error("method createPinMarkerWithClickListener not implemented")}},{key:"createTextMarkerWithClickListener",value:function(e,t,n){throw new Error("method createTextMarkerWithClickListener not implemented")}},{key:"createObfuscateMarkerWithClickListener",value:function(e){throw new Error("method createObfuscateMarkerWithClickListener not implemented")}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,t){throw new Error("method createPriceObfuscateMarkerWithClickListener not implemented")}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,t,n){throw new Error("method createPinObfuscateMarkerWithClickListener not implemented")}},{key:"hasObfuscateAreaStyleChanged",value:function(e){throw new Error("method _hasObfuscateAreaStyleChanged not implemented")}},{key:"createClusterMarkerWithClickListener",value:function(e,t,n){throw new Error("method createClusterMarkerWithClickListener not implemented")}},{key:"removeMarkerFromMap",value:function(e){throw new Error("method removeMarkerFromMap not implemented")}},{key:"cleanMarkerListeners",value:function(e){throw new Error("method cleanMarkerListener not implemented")}},{key:"cloneMarker",value:function(e){throw new Error("method cloneMarker not implemented")}},{key:"updatePopupPositionOnLayer",value:function(){throw new Error("method updatePopupPositionOnLayer not implemented")}},{key:"ensurePopupVisibility",value:function(){throw new Error("method ensurePopupVisibility not implemented")}},{key:"getMarkerComponent",value:function(e){throw new Error("method getMarkerComponent not implemented")}},{key:"moveMarkerPosition",value:function(e,t){throw new Error("method moveMarkerPosition not implemented")}},{key:"getRectOfMarker",value:function(e){throw new Error("method getRectOfMarker not implemented")}},{key:"fitBounds",value:function(e,t,n,r){return Promise.reject("method fitBounds not implemented")}},{key:"nativeBounds",value:function(){throw new Error("method nativeBounds not implemented")}},{key:"asNativeBounds",value:function(e,t){throw new Error("method asNativeBounds not implemented")}},{key:"computeNativeBoundsFromLatLongs",value:function(e){throw new Error("method computeNativeBoundsFromLatLongs not implemented")}},{key:"asBounds",value:function(e){throw new Error("method asBounds not implemented")}},{key:"containerBounds",value:function(e){throw new Error("method containerBounds not implemented")}},{key:"fitLatLongs",value:function(e){return Promise.reject("method fitLatLongs not implemented")}},{key:"getZoom",value:function(){throw new Error("method getZoom not implemented")}},{key:"getCenter",value:function(){throw new Error("method getCenter not implemented")}},{key:"isFeatureInRealBound",value:function(e,t){throw new Error("method isFeatureInRealBound not implemented")}},{key:"centerAndZoomMap",value:function(e,t,n){throw new Error("method centerAndZoomMap not implemented")}},{key:"addEventListener",value:function(e,t,n){throw new Error("method addEventListener not implemented")}},{key:"addRouteOnMap",value:function(e,t){return Promise.reject(new Error("method addRouteOnMap not implemented"))}},{key:"removeRouteOnMap",value:function(e){return Promise.reject(new Error("method removeRouteOnMap not implemented"))}},{key:"addPolygonsOnMap",value:function(e){return Promise.reject(new Error("method addPolygonsOnMap not implemented"))}},{key:"removePolygonsOnMap",value:function(e){return Promise.reject(new Error("method removePolygonsOnMap not implemented"))}},{key:"registerListenerOnMapFocusElement",value:function(e,t){throw new Error("method registerListenerOnMapFocusElement not implemented")}},{key:"unbindAll",value:function(){throw new Error("method unbindAll not implemented")}},{key:"getTileDim",value:function(){throw new Error("method getTileDim not implemented")}},{key:"resetRouteStyle",value:function(){throw new Error("method resetRouteStyle not implemented")}},{key:"updateMapProviderConfig",value:function(){throw new Error("method updateMapProviderConfig not implemented")}},{key:"forceMapModeView",value:function(){throw new Error("method forceMapModeView not implemented")}}])&&Xa(t.prototype,n),r&&Xa(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}());function ks(e){return ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ks(e)}function ws(e){return function(e){if(Array.isArray(e))return Ls(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Cs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ps(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Cs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cs(e,t){if(e){if("string"==typeof e)return Ls(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ls(e,t):void 0}}function Ls(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ms(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_s(r.key),r)}}function _s(e){var t=function(e,t){if("object"!==ks(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ks(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ks(t)?t:String(t)}function xs(){return xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Es(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},xs.apply(this,arguments)}function Os(e,t){return Os=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Os(e,t)}function Fs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Es(e);if(t){var i=Es(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ks(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ss(e)}(this,n)}}function Ss(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Es(e){return Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Es(e)}var Is=Nt,As=Vt,Ts="markers",Ds="default",js="undefined"!=typeof google?google.maps.Marker.MAX_ZINDEX:0,Bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Os(e,t)}(o,e);var t,n,r,i=Fs(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,r))._loadLocale(e),a.i18n=new dr(n,a.locale,{readParam:a.readParam.bind(Ss(a)),writeParam:a.writeParam.bind(Ss(a))}),a.qualifiersAndHashkeysUsed={},a}return t=o,n=[{key:"ready",value:function(){var e=this;return xs(Es(o.prototype),"ready",this).call(this).then((function(){return e.loadQualifiersAndHashkeysUsed(),e}))}},{key:"getEGMapConfigurations",value:function(){var e=this.getConfigurations();return{default:e.default,external:e.external,overwrite:e.overwrite,parameter:e.parameter,final:this.subConfig()}}},{key:"loadQualifiersAndHashkeysUsed",value:function(e){var t=this;(e?[e]:Aa).forEach((function(e){return t.qualifiersAndHashkeysUsed[e]=t._identifyQualifiersAndHashKeysUsedInHashkeys(e)}))}},{key:"_loadLocale",value:function(e){this.locale=null==e?void 0:e.locale;var t=this.readParam("locale");if(t){var n=Ps(/^([a-z]{2})((-|_)([A-Z]{2}))?$/.exec(t)||[],5),r=n[1],i=n[4];r&&(this.locale=i?"".concat(r,"-").concat(i):r)}}},{key:"mapProvider",value:function(){return this.readParam("mapProvider")}},{key:"getLocale",value:function(){return this.locale}},{key:"getI18N",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.i18n).format.apply(t,[e].concat(r))}},{key:"filterQualifiersUsed",value:function(e,t){var n=this.qualifiersAndHashkeysUsed[e].qualifiers;return t.filter((function(e){return n.includes(e)}))}},{key:"isQualifiersUsedInConfig",value:function(e,t){return this.qualifiersAndHashkeysUsed[e].qualifiers.includes(t)}},{key:"filterHashkeysUsed",value:function(e,t){var n=this.qualifiersAndHashkeysUsed[e].hashkeys;return t.filter((function(e){return n.includes(e)}))}},{key:"_identifyQualifiersAndHashKeysUsedInHashkeys",value:function(e){var t=this,n=new Set,r=new Set;return r.add("default"),this._identifyAllHashkeys(e).forEach((function(i){r.add(i),i.split("#").forEach((function(r){t.getFeatureStatus(e).includes(r)||"hl"===r||n.add(r)}))})),{qualifiers:ws(n),hashkeys:ws(r).map((function(e){return e.split("#").sort().join("#")}))}}},{key:"_identifyAllHashkeys",value:function(e){var t=this.listStringKeys("markers,".concat(e)),n=new Set,r=new Set;t.forEach((function(e){if(e.endsWith(Ds))r.add(e.substring(0,e.length-7-1));else{var t=e.indexOf(",".concat(Ds,","));t>0?r.add(e.substring(0,t)):n.add(e)}}));var i=new Set;return n.forEach((function(e){r.forEach((function(t){e.startsWith(t)&&i.add(e.substring(t.length+1).split(",")[0])}))})),ws(i)}},{key:"mapboxAccessToken",value:function(){return this.readParam("mapbox,accessToken")}},{key:"getFeatureTypes",value:function(){return Fa}},{key:"getFeatureStatus",value:function(e){switch(e){case La:return Ea;case Ma:return Ia;case _a:case xa:return[Sa];default:throw new Error("Type unknown: ".concat(e))}}},{key:"iso4217CurrencyCode",value:function(){return this.readParam("iso4217CurrencyCode")}},{key:"icons",value:function(){return this.propertyValues(Ts,"icons",Fa)}},{key:"frameIcons",value:function(){return this.propertyValues(Ts,"frameIcons",Fa)}},{key:"cornerIcons",value:function(){return{"top-left":this.propertyValues(Ts,"cornerIcons,topLeft",Fa),"top-right":this.propertyValues(Ts,"cornerIcons,topRight",Fa),"bottom-left":this.propertyValues(Ts,"cornerIcons,bottomLeft",Fa),"bottom-right":this.propertyValues(Ts,"cornerIcons,bottomRight",Fa)}}},{key:"innerIcons",value:function(){return{left:this.propertyValues(Ts,"innerIcons,left",Fa),right:this.propertyValues(Ts,"innerIcons,right",Fa)}}},{key:"obfuscateRadiusInMeters",value:function(){return this.propertyValues(Ts,"obfuscateMarkers,radiusInM",Oa)}},{key:"obfuscatePrecision",value:function(){return this.propertyValues(Ts,"obfuscateMarkers,precision",Oa)}},{key:"obfuscateStyle",value:function(){return this.propertyValues(Ts,"obfuscateMarkers,style",Oa)}},{key:"polygonStyles",value:function(){return this.propertyValues("polygons","style",Fa)}},{key:"zIndexes",value:function(){var e=this.propertyValues(Ts,"zIndex",Aa);if("google-maps"===this.mapProvider())for(var t in e)for(var n in e[t])e[t][n]=e[t][n]+js;return e}},{key:"maxZIndex",value:function(){var e=this.zIndexes(),t=0;return Object.values(e).forEach((function(e){return Object.values(e).forEach((function(e){e>t&&(t=e)}))})),t}},{key:"textLabelDynamicPlacement",value:function(){return this.propertyValues(Ts,"textLabel,dynamicPlacement",Fa)}},{key:"textLabelMaxLineLength",value:function(){return this.propertyValues(Ts,"textLabel,maxLineLength",Fa)}},{key:"textLabelMaxLines",value:function(){return this.propertyValues(Ts,"textLabel,maxLines",Fa)}},{key:"textLabelMinZoom",value:function(){return this.propertyValues(Ts,"textLabel,minZoom",Fa)}},{key:"textLabelMaxZoom",value:function(){return this.propertyValues(Ts,"textLabel,maxZoom",Fa)}},{key:"textSubLabelMinZoom",value:function(){return this.propertyValues(Ts,"textLabel,subLabel,minZoom",Fa)}},{key:"textSubLabelMaxZoom",value:function(){return this.propertyValues(Ts,"textLabel,subLabel,maxZoom",Fa)}},{key:"textSubLabelMaxLineLength",value:function(){return this.propertyValues(Ts,"textLabel,subLabel,maxLineLength",Fa)}},{key:"textSubLabelMaxLines",value:function(){return this.propertyValues(Ts,"textLabel,subLabel,maxLines",Fa)}},{key:"textLabelVisibility",value:function(){return this.propertyValues(Ts,"textLabel,show",Aa)}},{key:"textSubLabelVisibility",value:function(){return this.propertyValues(Ts,"textLabel,subLabel,show",Aa)}},{key:"textLabelZIndex",value:function(){return this.propertyValues(Ts,"textLabel,zIndex",Aa)}},{key:"textLabelPosition",value:function(){return this.propertyValues(Ts,"textLabel,position",Aa,(function(e){var t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}},{key:"popupPositions",value:function(){return this.propertyValues(Ts,"popup,position",Fa,(function(e){var t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}},{key:"popupVisibilities",value:function(){return this.propertyValues(Ts,"popup,ensureVisibility",Fa)}},{key:"popupVisibilityPaddings",value:function(){return this.propertyValues(Ts,"popup,visibilityPadding",Fa)}},{key:"markerTypes",value:function(){return this.propertyValues(Ts,"markerType",Fa)}},{key:"isAtLeastOneProductStatusUsingObfuscateMarker",value:function(){return Object.values(this.markerTypes().product||{}).some((function(e){return"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e}))}},{key:"isAtLeastOnePropertyStatusUsingObfuscateMarker",value:function(){return Object.values(this.markerTypes().property||{}).some((function(e){return"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e}))}},{key:"markersShow",value:function(){return this.propertyValues(Ts,"show",Fa)}},{key:"markersKeepOutOfViewport",value:function(){return this.propertyValues(Ts,"keepOutOfViewport",Fa)}},{key:"actionsOnFeatureSelect",value:function(){return this.propertyValues(Ts,"actionOnFeatureSelect",Aa)}},{key:"actionsOnFeatureDeselect",value:function(){return this.propertyValues(Ts,"actionOnFeatureDeselect",Fa)}},{key:"actionsOnFeatureOver",value:function(){return this.propertyValues(Ts,"actionOnFeatureOver",Aa)}},{key:"actionsOnFeatureOut",value:function(){return this.propertyValues(Ts,"actionOnFeatureOut",Aa)}},{key:"actionsOnMarkerClick",value:function(){return this.propertyValues(Ts,"actionOnClick",Aa)}},{key:"actionsOnMarkerMouseOver",value:function(){return this.propertyValues(Ts,"actionOnMouseOver",Aa)}},{key:"actionsOnMarkerMouseOut",value:function(){return this.propertyValues(Ts,"actionOnMouseOut",Aa)}},{key:"keyNamesForMarkerKeyPressEvent",value:function(){return this.propertyValues(Ts,"keyNameForKeyPressEvent",Aa)}},{key:"actionsOnPopupClick",value:function(){return this.propertyValues(Ts,"popup,actionOnClick",Fa)}},{key:"actionsOnPopupMouseOver",value:function(){return this.propertyValues(Ts,"popup,actionOnMouseOver",Fa)}},{key:"actionsOnPopupMouseOut",value:function(){return this.propertyValues(Ts,"popup,actionOnMouseOut",Fa)}},{key:"keyNamesForPopupKeyPressEvent",value:function(){return this.propertyValues(Ts,"popup,keyNameForKeyPressEvent",Fa)}},{key:"actionsOnMapDrag",value:function(){return this.readParam("map,onMapDrag")}},{key:"actionsOnMapClick",value:function(){return this.readParam("map,onMapClick")}},{key:"singlePropertiesValues",value:function(e,t){var n=this,r={};return t.map((function(t){r[t]=n.readParam("".concat(Ts,",").concat(t,",").concat(e))})),r}},{key:"threshold",value:function(){var e=this.propertyValues(Ts,"threshold",Fa),t=this.singlePropertiesValues("threshold,".concat(Ds),Fa);return Fa.forEach((function(n){return e[n].default=t[n]})),e}},{key:"style",value:function(){return this.readParam("style")}},{key:"maxZoomForCount",value:function(){var e=this.propertyValues(Ts,"maxZoomForCount",Fa),t=this.singlePropertiesValues("maxZoomForCount,".concat(Ds),Fa);return Fa.forEach((function(n){return e[n].default=t[n]})),e}},{key:"clusterConfigurationByType",value:function(){return this.propertyValues(Ts,"clustering",Fa)}},{key:"clusterDefaultConfigurationByType",value:function(){var e=this,t={};return Fa.forEach((function(n){t[n]=e.subConfig("markers,".concat(n,",clustering,default"))})),t}},{key:"isKeyboardFeaturesDefined",value:function(){return void 0!==this.readParam("a11y,keyboardFeatures,enabled")}},{key:"isKeyboardFeaturesEnabled",value:function(){return!0===this.readParam("a11y,keyboardFeatures,enabled")}},{key:"isAnyContentProviderExists",value:function(){var e=this;return Fa.some((function(t){var n,r;return null!==(n=null===(r=e.readParam("contentProvider,".concat(t,",default")))||void 0===r?void 0:r.length)&&void 0!==n&&n}))}},{key:"minZoomForDisplay",value:function(){var e=this.propertyValues(Ts,"minZoomForDisplay",Fa),t=this.singlePropertiesValues("minZoomForDisplay,".concat(Ds),Fa);return Fa.forEach((function(n){return e[n].default=t[n]})),e}},{key:"minZoomForTileRequest",value:function(){return this.readParam("tiles,minZoomForTileRequest")}},{key:"historicalBoundingBoxDataEndpoint",value:function(){return this.readParam("historicalBoundingBoxDataEndpoint")}},{key:"tagCollidingMarkers",value:function(){var e=this.propertyValues(Ts,"tagCollidingMarkers",Aa),t=this.singlePropertiesValues("tagCollidingMarkers,".concat(Ds),Aa);return Aa.forEach((function(n){return e[n].default=t[n]})),e}},{key:"collisionBufferVariation",value:function(){var e=this.propertyValues(Ts,"collisionBufferVariation",Aa),t=this.singlePropertiesValues("collisionBufferVariation,".concat(Ds),Aa);return Aa.forEach((function(n){return e[n].default=t[n]})),e}},{key:"collisionBuffers",value:function(){return this.readParam("markers,common,collisionBuffers")}},{key:"clusterMarkerCollisionBufferInPixels",value:function(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,clusterMarkerCollisionBufferInPixels,default")}},{key:"shouldMoveCollidingClusterMarkers",value:function(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,moveCollidingClusterMarkers,default")}},{key:"routeLineStyleByDistanceMode",value:function(){return this.propertyValues("routes,style",void 0,["driving","cycling","walking","flying"])}},{key:"googleMaps",value:function(){return this.subConfig("googleMaps")}},{key:"mapbox",value:function(){return this.subConfig("mapbox")}},{key:"tilesReaderConfig",value:function(){return this.subConfig("tiles,enabled")}},{key:"tilesProvidersConfig",value:function(){return this.subConfig("tiles,providers")}},{key:"tilesCacheConfig",value:function(){return this.subConfig("tiles,cache")}},{key:"routeCacheInMs",value:function(){return this.readParam("routes,cacheInMs")}},{key:"egDistances",value:function(){return this.readParam("routes,egDistances")}},{key:"keyboardFeaturesIcon",value:function(){return this.readParam("a11y,keyboardFeatures,keyboardFeaturesIcon")}},{key:"contentProvidersByFeatureType",value:function(){var e=this,t={};return Fa.forEach((function(n){return t[n]=e.readParam("contentProvider,".concat(n,",default"))})),t}},{key:"contentProvidersConfigs",value:function(){return this.subConfig("contentProvider,providers")}},{key:"availabilityProvider",value:function(){return this.readParam("availability,availabilityProvider")}},{key:"gmapsAddConfig",value:function(){return this.subConfig("googleMaps,gmapsAddConfig")}},{key:"loadMapSettings",value:function(){return{mapProvider:this.mapProvider(),loggerFactory:this.logger.bind(this),featureTypes:Fa,getFeatureStatus:this.getFeatureStatus.bind(this),getI18N:this.getI18N.bind(this),actionsOnFeatureSelect:this.actionsOnFeatureSelect(),actionsOnFeatureDeselect:this.actionsOnFeatureDeselect(),actionsOnFeatureOver:this.actionsOnFeatureOver(),actionsOnFeatureOut:this.actionsOnFeatureOut(),actionsOnMarkerClick:this.actionsOnMarkerClick(),actionsOnMarkerMouseOver:this.actionsOnMarkerMouseOver(),actionsOnMarkerMouseOut:this.actionsOnMarkerMouseOut(),keyNamesForMarkerKeyPressEvent:this.keyNamesForMarkerKeyPressEvent(),actionsOnPopupClick:this.actionsOnPopupClick(),actionsOnPopupMouseOver:this.actionsOnPopupMouseOver(),actionsOnPopupMouseOut:this.actionsOnPopupMouseOut(),keyNamesForPopupKeyPressEvent:this.keyNamesForPopupKeyPressEvent(),popupPositions:this.popupPositions(),actionsOnMapDrag:this.actionsOnMapDrag(),actionsOnMapClick:this.actionsOnMapClick(),routeCacheInMs:this.routeCacheInMs(),contentProvidersByFeatureType:this.contentProvidersByFeatureType(),contentProvidersConfigs:this.contentProvidersConfigs(),availabilityProvider:this.availabilityProvider(),locale:this.getLocale(),isKeyboardFeaturesDefined:this.isKeyboardFeaturesDefined(),isKeyboardFeaturesEnabled:this.isKeyboardFeaturesEnabled(),keyboardFeaturesIcon:this.keyboardFeaturesIcon(),tiles:{tilesReaderConfig:this.tilesReaderConfig(),tilesProvidersConfig:this.tilesProvidersConfig(),tilesCacheConfig:this.tilesCacheConfig(),minZoomForTileRequest:this.minZoomForTileRequest(),debugTileId:tr.getDebugTilesIdEnabled()},styling:this.style(),threshold:this.threshold(),maxZoomForCount:this.maxZoomForCount(),minZoomForDisplay:this.minZoomForDisplay(),clusterConfigurationByType:this.clusterConfigurationByType(),clusterDefaultConfigurationByType:this.clusterDefaultConfigurationByType(),isAnyContentProviderExists:this.isAnyContentProviderExists(),historicalBoundingBoxDataEndpoint:this.historicalBoundingBoxDataEndpoint(),markerTypes:this.markerTypes(),isAtLeastOneProductStatusUsingObfuscateMarker:this.isAtLeastOneProductStatusUsingObfuscateMarker(),isAtLeastOnePropertyStatusUsingObfuscateMarker:this.isAtLeastOnePropertyStatusUsingObfuscateMarker(),obfuscateRadiusInMeters:this.obfuscateRadiusInMeters(),obfuscatePrecision:this.obfuscatePrecision(),obfuscateStyle:this.obfuscateStyle(),icons:this.icons(),frameIcons:this.frameIcons(),cornerIcons:this.cornerIcons(),innerIcons:this.innerIcons(),textLabelVisibility:this.textLabelVisibility(),textSubLabelVisibility:this.textSubLabelVisibility(),zIndexes:this.zIndexes(),markersShow:this.markersShow(),markersKeepOutOfViewport:this.markersKeepOutOfViewport(),maxZIndex:this.maxZIndex(),textLabelZIndex:this.textLabelZIndex(),textLabelMinZoom:this.textLabelMinZoom(),textLabelMaxZoom:this.textLabelMaxZoom(),textLabelPosition:this.textLabelPosition(),textLabelMaxLineLength:this.textLabelMaxLineLength(),textLabelMaxLines:this.textLabelMaxLines(),textSubLabelMinZoom:this.textSubLabelMinZoom(),textSubLabelMaxZoom:this.textSubLabelMaxZoom(),textSubLabelMaxLineLength:this.textSubLabelMaxLineLength(),textSubLabelMaxLines:this.textSubLabelMaxLines(),polygonStyles:this.polygonStyles(),iso4217CurrencyCode:this.iso4217CurrencyCode(),debugMarkersPosition:tr.getDebugMarkersPositionEnabled(),collision:{labelVisibility:this.textLabelVisibility(),dynamicPlacement:this.textLabelDynamicPlacement(),collisionBufferVariation:this.collisionBufferVariation(),collisionBuffers:this.collisionBuffers(),tagCollidingMarkers:this.tagCollidingMarkers(),clusterMarkerCollisionBufferInPixels:this.clusterMarkerCollisionBufferInPixels(),shouldMoveCollidingClusterMarkers:this.shouldMoveCollidingClusterMarkers()},routeLineStyleByDistanceMode:this.routeLineStyleByDistanceMode(),googleMaps:this.googleMaps(),mapbox:this.mapbox()}}},{key:"getActiveTilesets",value:function(){var e=this.readParam("tiles,enabled,product"),t=this.readParam("tiles,enabled,property"),n=this.readParam("tiles,enabled,place"),r=[].concat(e,t,n),i=this.subConfig("tiles,providers");return r.map((function(e){var t;return null===(t=i[e])||void 0===t?void 0:t.tilesetId}))}},{key:"overrideMarkerShowConfig",value:function(e,t,n){var r=[n].concat(ws(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[])).filter((function(e){return void 0!==e})).join("#"),i="markers,".concat(e,",show,").concat(r);null===t?this.removeOverrideParam(i):this.writeParam(i,t)}}],n&&Ms(t.prototype,n),r&&Ms(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(ur);function Rs(e,t){var n,r,i=e.mapProvider!==t.mapProvider||"mapbox"===t.mapProvider&&Ns(e.mapbox,t.mapbox)||"google-maps"===t.mapProvider&&((null===(n=e.googleMaps)||void 0===n||null===(n=n.gmapsAddConfig)||void 0===n?void 0:n.mapId)||"")!==((null===(r=t.googleMaps)||void 0===r||null===(r=r.gmapsAddConfig)||void 0===r?void 0:r.mapId)||"");if(i)return{reinstantiate:i};var o="google-maps"===t.mapProvider&&Ns(e.googleMaps.gmapsAddConfig||{},t.googleMaps.gmapsAddConfig||{}),a=Us(e.icons,t.icons),s=Ns(e.frameIcons,t.frameIcons),u=Us(e.cornerIcons,t.cornerIcons),l=Us(e.innerIcons,t.innerIcons),c=Ns(e.contentProvidersByFeatureType,t.contentProvidersByFeatureType),f=Ns(e.threshold,t.threshold),d=Ns(e.maxZoomForCount,t.maxZoomForCount),h=Ns(e.minZoomForDisplay,t.minZoomForDisplay),p=Ns(e.clusterConfigurationByType,t.clusterConfigurationByType),y=Ns(e.markerTypes,t.markerTypes),v=Ns(e.obfuscateRadiusInMeters,t.obfuscateRadiusInMeters),g=Ns(e.obfuscatePrecision,t.obfuscatePrecision),m=Ns(e.obfuscateStyle,t.obfuscateStyle),b=Ns(e.textLabelVisibility,t.textLabelVisibility),k=Ns(e.textSubLabelVisibility,t.textSubLabelVisibility),w=Ns(e.zIndexes,t.zIndexes),P=Ns(e.textLabelZIndex,t.textLabelZIndex),C=Ns(e.textLabelMinZoom,t.textLabelMinZoom),L=Ns(e.textLabelMaxZoom,t.textLabelMaxZoom),M=Ns(e.textLabelPosition,t.textLabelPosition),_=Ns(e.textLabelMaxLineLength,t.textLabelMaxLineLength),x=Ns(e.textLabelMaxLines,t.textLabelMaxLines),O=Ns(e.textSubLabelMinZoom,t.textSubLabelMinZoom),F=Ns(e.textSubLabelMaxZoom,t.textSubLabelMaxZoom),S=Ns(e.textSubLabelMaxLineLength,t.textSubLabelMaxLineLength),E=Ns(e.textSubLabelMaxLines,t.textSubLabelMaxLines),I=Ns(e.polygonStyles,t.polygonStyles),A=Ns(e.collision,t.collision),T=Ns(e.routeLineStyleByDistanceMode,t.routeLineStyleByDistanceMode),D=Ns(e.contentProvidersConfigs,t.contentProvidersConfigs),j=Ns(e.availabilityProvider,t.availabilityProvider),B=Ns(e.clusterDefaultConfigurationByType,t.clusterDefaultConfigurationByType),R=Ns(e.tiles,t.tiles),N=Ns(e.actionsOnFeatureSelect,t.actionsOnFeatureSelect)||Ns(e.actionsOnFeatureDeselect,t.actionsOnFeatureDeselect)||Ns(e.actionsOnFeatureOver,t.actionsOnFeatureOver)||Ns(e.actionsOnFeatureOut,t.actionsOnFeatureOut)||Ns(e.actionsOnMarkerClick,t.actionsOnMarkerClick)||Ns(e.actionsOnMarkerMouseOver,t.actionsOnMarkerMouseOver)||Ns(e.actionsOnMarkerMouseOut,t.actionsOnMarkerMouseOut)||Ns(e.keyNamesForMarkerKeyPressEvent,t.keyNamesForMarkerKeyPressEvent)||Ns(e.actionsOnPopupClick,t.actionsOnPopupClick)||Ns(e.actionsOnPopupMouseOver,t.actionsOnPopupMouseOver)||Ns(e.actionsOnPopupMouseOut,t.actionsOnPopupMouseOut)||Ns(e.keyNamesForPopupKeyPressEvent,t.keyNamesForPopupKeyPressEvent)||Ns(e.popupPositions,t.popupPositions)||c||f||d||h||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||p||y||v||g||m||a||s||u||l||b||k||w||P||C||L||M||_||x||O||F||S||E||A,U=R,V={updateMapProviderConfig:o,updateViewport:T||e.routeCacheInMs!==t.routeCacheInMs||c||D||j||e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||f||d||h||p||B||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||y||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||v||g||m||a||s||u||l||b||k||w||P||C||L||M||_||x||O||F||S||E||e.debugMarkersPosition!==t.debugMarkersPosition||A||R,updateMarkers:y||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||v||g||m||a||s||u||l||b||k||w||P||C||L||M||_||x||O||F||S||E||e.debugMarkersPosition!==t.debugMarkersPosition,updateKeyboardA11yUI:e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||Ns(e.actionsOnMarkerClick,t.actionsOnMarkerClick)||Ns(e.keyNamesForMarkerKeyPressEvent,t.keyNamesForMarkerKeyPressEvent)||Ns(e.keyNamesForPopupKeyPressEvent,t.keyNamesForPopupKeyPressEvent)||Ns(e.keyboardFeaturesIcon,t.keyboardFeaturesIcon),updateStyling:Ns(e.styling,t.styling),resetRouteManagement:T||e.routeCacheInMs!==t.routeCacheInMs,resetPolygonManagement:I,resetClusterers:p||B,resetContentProviders:c||D,resetCollisionManagement:A,resetAvailabilityCheck:j,clearHashkeys:N,updateTiles:U};return Object.keys(V).filter((function(e){return!1===V[e]})).forEach((function(e){return delete V[e]})),V}function Ns(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return As(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})!==As(e)}function Us(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ns(Vs(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Vs(e))}function Vs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new WeakSet;return Object.keys(e).forEach((function(r){var i=e[r];Y(i)?t[r]=J(i):Is(i)?n.has(i)||(t[r]={},Vs(e[r],t[r],n)):t[r]=i})),t}var zs={marker:"data:image/svg+xml,%3c!-- file: marker.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%23026dc5' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",markerHighlighted:"data:image/svg+xml,%3c!-- file: marker-hl.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%2354a0dd' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",keyboardNavigationIcon:"data:image/svg+xml,%3c!-- file: keyboard.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='24'%3e%3cpath d='M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z'/%3e%3c/svg%3e",leftArrowIcon:"data:image/svg+xml,%3c!-- file: left-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M9.87.613Q9.55.96 8.08 2.523 6.612 4.085 4.983 5.82q-1.628 1.736-2.95 3.125L.735 10.335q-.343.322-.54.756-.195.434-.195.88 0 .447.196.881t.539.756l1.298 1.39q1.322 1.388 2.95 3.124l3.098 3.299q1.47 1.562 1.788 1.91.686.669 1.64.669.956 0 1.617-.67t.723-1.537q.06-.868-.723-1.761l-7.518-8.06 7.665-8.06q.784-.794.723-1.712-.062-.917-.723-1.587-.784-.67-1.75-.608-.968.062-1.654.608z'/%3e%3c/svg%3e",rightArrowIcon:"data:image/svg+xml,%3c!-- file: right-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M4.13 23.387q.32-.347 1.789-1.91 1.469-1.562 3.098-3.298 1.628-1.736 2.95-3.125l1.298-1.389q.343-.322.54-.756.195-.434.195-.88 0-.447-.196-.881t-.539-.756l-1.298-1.39q-1.322-1.388-2.95-3.124L5.919 2.579Q4.449 1.017 4.13.67 3.445 0 2.49 0 1.534 0 .873.67T.15 2.207q-.06.868.723 1.761l7.518 8.06-7.665 8.06q-.784.794-.723 1.712.062.917.723 1.587.784.67 1.75.608.968-.062 1.654-.608z'/%3e%3c/svg%3e"},Ks=function(){var e=new Kn;return{mapProvider:"google-maps",map:{onMapDrag:["clearHighlight","clearSelection","closePopup","removeAriaLive"],onMapClick:["clearHighlight","clearSelection","closePopup","removeAriaLive"],mapInitWaitForTiles:!0},googleMaps:{padding:32,gmapsAddConfig:{zoom:2,minZoom:2,mapId:"57df04e09ffe3110",center:{lat:0,lng:0},gestureHandling:"greedy",clickableIcons:!1,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,isFractionalZoomEnabled:!0},urls:{api:"https://maps.googleapis.com/maps/api/js?libraries=places,geometry&version=3.56"},fitBoundsAnimTime:500,debouncingEventsTime:{centerChanged:50,zoomChanged:100}},mapbox:{accessToken:void 0,rtlTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",padding:32,scaleControl:{ctrlEnabled:!1,ctrlOptions:{unit:"metric"},ctrlPosition:void 0},navControl:{ctrlEnabled:!0,ctrlOptions:{},ctrlPosition:void 0},geoLocateControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},fullscreenControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},mapboxAddConf:{center:[0,0],zoom:1,fadeDuration:100,style:"mapbox://styles/expedia-geo/ckfgvpedb2neq19pe9u3zg69x"},urls:{api:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.js",css:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css",pluginUrls:["https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-language/v1.0.0/mapbox-gl-language.js"]}},markers:{common:{collisionBuffers:{low:16,medium:128,high:192}},product:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlightIfNotSelected"]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:[]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1,available:!0,filtered:!1,sold_out:!1,unknown:!1,"linked-features":!1},keepOutOfViewport:{default:!0},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:Di.defaultClusterProductLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:zs.marker,hl:zs.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}},actionOnClick:{default:[]},actionOnMouseOver:{default:[]},actionOnMouseOut:{default:[]}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},minZoom:{default:0},maxZoom:{default:22},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},minZoom:{default:0,restaurant:12},maxZoom:{default:22},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},property:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlightIfNotSelected"]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:[]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1,available:!0,filtered:!1,sold_out:!1,unknown:!1,"linked-features":!1},keepOutOfViewport:{default:!0},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:Di.defaultClusterPropertyLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:zs.marker,hl:zs.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}},actionOnClick:{default:[]},actionOnMouseOver:{default:[]},actionOnMouseOut:{default:[]}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},minZoom:{default:0},maxZoom:{default:22},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},minZoom:{default:0},maxZoom:{default:22},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},place:{threshold:{default:100},maxZoomForCount:{default:10},minZoomForDisplay:{default:11},actionOnFeatureSelect:{default:["bounce","highlight","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","removeAriaLive"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlightIfNotSelected"]},actionOnClick:{default:["select","highlight","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:[]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1},keepOutOfViewport:{default:!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:Di.defaultClusterPlaceLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6},markerType:{default:"pin"},icons:{default:zs.marker,hl:zs.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}},actionOnClick:{default:[]},actionOnMouseOver:{default:[]},actionOnMouseOut:{default:[]}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},minZoom:{default:0},maxZoom:{default:22},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},minZoom:{default:0},maxZoom:{default:22},position:{default:"right"},maxLineLength:{default:20},maxLines:{default:3},dynamicPlacement:{default:!1}}},cluster:{actionOnClick:{default:["zoomToExtent"]},actionOnFeatureSelect:{default:["zoomToExtent"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlight"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:[]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},clusterMarkerCollisionAvoidance:{moveCollidingClusterMarkers:{default:!1},clusterMarkerCollisionBufferInPixels:{default:5}},zIndex:{default:1,hl:6,unknown:2},textLabel:{show:{default:!1},zIndex:{default:"sameAsMarker"},minZoom:{default:0},maxZoom:{default:22},position:{default:"right"}}}},polygons:{product:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}},property:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}},place:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}}},tiles:{enabled:{product:[],property:[],place:[]},providers:{egPois:{type:"eg",tilesetId:"pois",url:"https://www.expedia.com/eg-tile-server",query:"",timeout:2e3}},minZoomForTileRequest:8,cache:{maxSize:-1,maxDistance:30}},contentProvider:{cacheInMs:18e5,product:{default:[]},property:{default:[]},place:{default:[]},providers:{}},historicalBoundingBoxDataEndpoint:"https://a.travel-assets.com/travel-assets-manager/df4af43c-2db9-4868-8665-96b7042a2c98/historical_bbox_data-min.json",availability:{availabilityProvider:"none",availabilityProviders:{}},locale:"en-US",iso4217CurrencyCode:"USD",routes:{egDistances:void 0,cacheInMs:18e5,style:{driving:{lineStyle:"normal",color:"#000000",width:1.5,opacity:.8},cycling:{lineStyle:"dash",color:"#000000",width:1.54,opacity:.8},walking:{lineStyle:"dot",color:"#000000",width:1.5,opacity:.8},flying:{lineStyle:"dash",color:"#000000",width:1.5,opacity:.8}}},a11y:{keyboardFeatures:{keyboardFeaturesIcon:zs.keyboardNavigationIcon}},logging:{logger:e},style:{}}};function Zs(e){return Zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zs(e)}function Hs(e){return function(e){if(Array.isArray(e))return qs(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return qs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qs(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ws(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gs(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Zs(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Zs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Zs(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qs=Tt,$s={doubleClick:"dblclick"};function Xs(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;if(Y(e)){n=e.cloneNode(!0);var s=["component-icon"];a&&s.push(a),o&&(r=Pn(J(e)||"")),ut(n,s)}else n=Se(void 0,void 0,a,void 0,e);if("none"!==i){var u=Js(void 0,void 0,t,n,"frame").main;return r&&(u.hashCode=r),{iconImg:n,main:u}}return be(n,t),r&&(n.hashCode=r),{iconImg:n,main:n}}function Ys(e,t,n,r,i,o,a){var s=_e(void 0,void 0,"".concat(r,"-content"),void 0,o);De(s);var u=Js(e,t,n,s,"".concat(r,"-label"),"".concat(r,"-text ").concat(i),a);return{main:u.main,text:u.text,span:s}}function Js(e,t,n,r,i,o,a){var s=t||we(e,n,o,a);t&&ht(t,o,a);var u=we(void 0,s,i);return u.appendChild(r),{main:s,text:u}}function eu(e,t){var n=e.hashKeys,r=t.textLabelVisibility,i=t.textSubLabelVisibility,o={};if(Qs(r[e.type],n)){var a=e.name;a&&(o.label=a)}if(Qs(i[e.type],n)){var s=e.description;s&&(o.subLabel=s)}return o}function tu(e,t){var n,r,i=t.markerTypes,o=t.frameIcons,a=t.icons,s=t.zIndexes,u=t.cornerIcons,l=t.innerIcons,c=t.iso4217CurrencyCode,f=t.locale,d=e.hashKeys,h=e.type,p=e,y=p.price,v=p.text,g="cluster"===h,m=g?"clusterMarker":Qs(i[h],d),b=g?[]:[e.type,p.status],k=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ws(Object(n),!0).forEach((function(t){Gs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ws(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({markerType:m,zIndex:0,cssClasses:{toAdd:[].concat(b,[p.highlighted?"hl":"not-hl"]),toRemove:[p.highlighted?"not-hl":"hl"]},frameIcon:Qs(o[h],d),icons:{}},eu(p,t));switch(m){case"price":case"priceObfuscate":y?k.textContent=Cn(y,void 0,c,f):k.markerType="price"===m?"pin":"pinObfuscate";break;case"text":v?k.textContent=v:k.markerType="pin"}switch(null!=e&&null!==(n=e.marker)&&void 0!==n&&n.cssClasses&&(r=k.cssClasses.toRemove).push.apply(r,Hs(e.marker.cssClasses)),k.markerType){case"pin":k.cssClasses.toAdd.push("pin-marker"),k.icons.pin=Qs(a[e.type],d);break;case"price":k.cssClasses.toAdd.push("price-marker");break;case"text":k.cssClasses.toAdd.push("text-marker");break;case"obfuscate":k.cssClasses.toAdd.push("obfuscate-marker");break;case"pinObfuscate":k.cssClasses.toAdd.push("pin-obfuscate-marker"),k.icons.pin=Qs(a[e.type],d);break;case"priceObfuscate":k.cssClasses.toAdd.push("price-obfuscate-marker");break;case"clusterMarker":break;default:throw new Error("Unknown marker type: ".concat(k.markerType))}var w,P=p.qualifiers||[];P.length>0&&(w=k.cssClasses.toAdd).push.apply(w,Hs(P)),k.zIndex=Qs(s[p.type],d);var C=yu(p,u);u&&(k.icons.cornerIcons=C);var L=vu(p,l);return l&&(k.icons.innerIcons=L),k}function nu(e,t,n){n&&(e&&n.onSelect?Ee(t,n.onSelect):n.default?Ee(t,n.default):Ae(t))}function ru(e,t,n){nu(e,t,n),Ue(t),Ve(t,0)}function iu(e,t,n){var r,i=e.marker,o=eu(e,t),a=o.label,s=o.subLabel;null===(r=i.labels)||void 0===r||r.updateTextLabel(a,s,n)}function ou(e,t,n,r){var i,o=null==e||null===(i=e.marker)||void 0===i?void 0:i.iconElements;if(o){var a=[];for(var s in t)if("cornerIcons"!==s&&"innerIcons"!==s){var u=o[s];We(o[s],t[s]),a.push(ei(u,n,r))}return $n(a).then((function(){return!0}))}return Promise.resolve(!1)}function au(e,t){e&&e.zIndexElement&&(Ut(e.zIndexElement)?e.zIndexElement.forEach((function(e){return Ge(e,t)})):Ge(e.zIndexElement,t))}function su(e){e&&e.bounceElement&&lr(e.bounceElement)}function uu(e,t){return"none"!==e[t]}function lu(e,t){t&&Object.keys(t).forEach((function(n){if(uu(t,n)){var r=we(void 0,e,"corner-icon ".concat(n));Xs(t[n],r)}}))}function cu(e,t){if(t){var n=e.parentElement||void 0;Object.keys(t).forEach((function(r){if(uu(t,r)){var i;switch(r){case"left":var o=he(e);o>=0&&Ct(i=we(void 0,void 0,"inner-icon ".concat(r)),n,o);break;case"right":i=we(void 0,n,"inner-icon ".concat(r))}i&&Xs(t[r],i)}}))}}function fu(e,t){var n=Object.keys(e);return!(Yt(n,Object.keys(t),!1)&&n.every((function(n){return t[n]&&!ti(e[n],t[n],!0)})))}function du(e,t){return fu(e,t)}function hu(e,t){return fu(e,t)}function pu(e,t){var n;return Object.keys(t).forEach((function(r){var i=Qs(t[r][e.type],e.hashKeys);i&&"none"!==i&&(n||(n={}),n[r]=i)})),n}function yu(e,t){return pu(e,t)}function vu(e,t){return pu(e,t)}function gu(e,t){return t(e,$s.doubleClick,(function(e){e.stopPropagation()}))}var mu=Tt,bu=kn,ku="text-label-hidden",wu="text-sub-label-hidden";function Pu(e,t,n,r,i){e.labels.aligner&&me(e.labels.aligner),e.labels.textLabelPosition=n,e.labels.aligner=we(void 0,e.labels.textLblCont,"marker-labels-aligner ".concat(n)),e.labels.container?be(e.labels.container,e.labels.aligner):e.labels.container=we(void 0,e.labels.aligner,"marker-labels-container");var o=mu(r.textLabelZIndex[t.type],t.hashKeys);"sameAsMarker"!=o&&Ge(e.labels.aligner,i(o))}function Cu(e,t,n,r){var i=mu(t[r.type],r.hashKeys),o=mu(n[r.type],r.hashKeys);return e<i||e>o}function Lu(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(e){return e},a=mu(i.textLabelPosition[t.type],t.hashKeys);n&&(Pu(e,t,a,i,o),Ou(e,t,n,r,i)),e.labels.updateTextLabel=function(n,r,s){n&&!e.labels.aligner&&Pu(e,t,a,i,o),Ou(e,t,n,r,i),Mu(s,i,t,e)},e.labels.updateTextLabelPosition=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,r=arguments.length>1?arguments[1]:void 0;n!==e.labels.textLabelPosition&&(Pu(e,t,n,i,o),Mu(r,i,t,e))},e.labels.hideTextLabel=function(t){var n=e.labels.aligner;n&&(t?st(n,ku):lt(n,ku))},e.labels.hideTextSubLabel=function(t){var n=e.labels.subLabel;n&&(t?st(n,wu):lt(n,wu))},e.labels.resetTextLabel=function(t){e.labels.hideTextLabel(!1),e.labels.updateTextLabelPosition(a,t)},e.labels.resetTextSubLabel=function(t){e.labels.hideTextSubLabel(!1),e.labels.updateTextLabelPosition(a,t)}}function Mu(e,t,n,r){Cu(e,t.textLabelMinZoom,t.textLabelMaxZoom,n)&&r.labels.hideTextLabel(!0),Cu(e,t.textSubLabelMinZoom,t.textSubLabelMaxZoom,n)&&r.labels.hideTextSubLabel(!0)}function _u(e,t,n,r){var i={};return e.forEach((function(e){var o=mu(n.textLabelVisibility[e.type],e.hashKeys),a=Cu(t,n.textLabelMinZoom,n.textLabelMaxZoom,e),s=r(e);i[s]="always"===o?"always":o&&!a})),i}function xu(e,t,n,r,i,o,a){var s=mu(n[e.type],e.hashKeys),u=mu(r[e.type],e.hashKeys),l=bu(i,s,u);return a?(ne(a,l),a):_e(void 0,t,"marker-".concat(o,"-text"),void 0,l)}function Ou(e,t,n,r,i){var o=e.labels,a=o.container,s=o.label,u=o.subLabel;if(n){var l=i.textLabelMaxLineLength,c=i.textLabelMaxLines;if(e.labels.label=xu(t,a,l,c,n,"label",s),r){var f=i.textSubLabelMaxLineLength,d=i.textSubLabelMaxLines;e.labels.subLabel=xu(t,a,f,d,r,"sublabel",u)}else me(u),e.labels.subLabel=void 0}else e.labels&&(me(e.labels.aligner),e.labels.aligner=void 0,e.labels.container=void 0,e.labels.label=void 0,e.labels.subLabel=void 0,e.labels.textLabelPosition=void 0)}function Fu(e,t,n,r,i){var o=ce(t,["marker-labels-container"],!0),a=i(e),s=a.width,u=a.height,l=a.center,c=r||mu(n.textLabelPosition[e.type],e.hashKeys),f=o.scrollWidth,d=o.scrollHeight;switch(l.x-=s/2,l.y-=u/2,c){case"right":l.y+=u/2,l.x+=s+f/2;break;case"left":l.y+=u/2,l.x-=f/2;break;case"above":l.y-=d/2,l.x+=s/2;break;default:l.y+=u+d/2,l.x+=s/2}return vt(l,f,d)}function Su(e){return Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Su(e)}function Eu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Iu(r.key),r)}}function Iu(e){var t=function(e,t){if("object"!==Su(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Su(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Su(t)?t:String(t)}var Au=wn,Tu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxSize=t,this.maxDistance=n,this.cache={},this.listeners=new Set,this.size=0}var t,n,r;return t=e,(n=[{key:"getTile",value:function(e,t,n){return this.cache[n]&&this.cache[n][e]?this.cache[n][e][t]:void 0}},{key:"setTile",value:function(e,t,n,r){var i=this.cache;i[n]||(i[n]={}),!i[n][e]&&Au(n)&&Au(e)&&(i[n][e]={}),!i[n][e][t]&&r?this.size=this.size+1:i[n][e][t]&&!r&&(this.size=this.size-1),Au(n)&&Au(e)&&Au(t)&&(i[n][e][t]=r),this.maxSize>0&&this.size>this.maxSize&&this._expire(e,t,n)}},{key:"addTilesListener",value:function(e){this.listeners.add(e)}},{key:"removeTilesListener",value:function(e){this.listeners.delete(e)}},{key:"_expire",value:function(t,n,r){var i=this,o=function(o){var a=function(a){var s=function(s){Zr(t,n,r,a,s,o)>i.maxDistance&&(i.listeners.forEach((function(t){return t(e.EVENTS.EXPIRE,Number(a),Number(s),Number(o),i.cache[o][a][s])})),delete i.cache[o][a][s],i.size=i.size-1)};for(var u in i.cache[o][a])s(u)};for(var s in i.cache[o])a(s)};for(var a in this.cache)o(a)}}])&&Eu(t.prototype,n),r&&Eu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Du(e){return Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Du(e)}function ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bu(r.key),r)}}function Bu(e){var t=function(e,t){if("object"!==Du(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Du(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Du(t)?t:String(t)}Tu.EVENTS={EXPIRE:"expire"};var Ru=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"loadTile",value:function(e,t,n,r,i){return Promise.reject("not implemented")}}])&&ju(t.prototype,n),r&&ju(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Nu=n(736);function Uu(e){return Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uu(e)}function Vu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zu(r.key),r)}}function zu(e){var t=function(e,t){if("object"!==Uu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Uu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Uu(t)?t:String(t)}function Ku(e,t){return Ku=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ku(e,t)}function Zu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hu(e);if(t){var i=Hu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Uu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Hu(e){return Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hu(e)}var qu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ku(e,t)}(o,e);var t,n,r,i=Zu(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).codec=new Nu.EGTSCodec,n.logger=t("EgTilesReader"),n.tilesUrlPrefix=e.url,n.query=e.query,n.tilesetId=e.tilesetId,n.queryByZoom=e.queryByZoom,n.timeout=e.timeout||500,n}return t=o,(n=[{key:"loadTile",value:function(e,t,n,r,i){var o=this,a=this.buildUrl(t,n,r,i);return this.fetchTile(a,e,t,n,r).then((function(e){return e.success?e.data.map((function(e){return o.removeColonFromQualifiers(e)})):(o.logger.error("Failed to load tile from ".concat(e.url,": ").concat(e.error.message),e.error.stack),[])}))}},{key:"removeColonFromQualifiers",value:function(e){var t;return e.qualifiers=null===(t=e.qualifiers)||void 0===t?void 0:t.map((function(e){return e.replace(":","__")})),e}},{key:"buildUrl",value:function(e,t,n,r){var i="/v1/tilesets/".concat(this.tilesetId,"/").concat(n,"/").concat(e,"/").concat(t,"/egmaps.pbf?locale=").concat(r),o=i;return this.queryByZoom&&this.queryByZoom[n]?o="".concat(i,"&").concat(this.queryByZoom[n]):this.query&&(o="".concat(i,"&").concat(this.query)),o}},{key:"fetchTile",value:function(e,t,n,r,i){var o=this;return Xn("".concat(this.tilesUrlPrefix).concat(e),this.timeout,{referrerPolicy:"no-referrer",credentials:"omit"}).then((function(t){return t.ok?t.arrayBuffer():404===t.status?void 0:Promise.reject(new Error("Server returns error code ".concat(t.status," ")+"when calling ".concat(e," for tile {x: ").concat(n,", y: ").concat(r,", zoom: ").concat(i,"}: \n              ").concat(t.statusText)))})).then((function(t){return o.handleResponse(t).then((function(t){return{url:e,success:!0,data:t}}))})).catch((function(t){return{url:e,success:!1,error:t}}))}},{key:"handleResponse",value:function(e){return e?this.codec.decode(e):Promise.resolve([])}}])&&Vu(t.prototype,n),r&&Vu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(Ru);function Wu(e){return Wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wu(e)}function Gu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Qu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Qu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xu(r.key),r)}}function Xu(e){var t=function(e,t){if("object"!==Wu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Wu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Wu(t)?t:String(t)}var Yu=function(){function e(t,n,r,i,o,a,s){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},l=u.delayBeforeRefresh,c=void 0===l?100:l,f=u.delayForceRefresh,d=void 0===f?2e3:f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=t.loggerFactory("TilesLoader"),this.delayBeforeRefresh=c,this.delayForceRefresh=d,this.refreshRequested=Date.now(),this.lastRefresh=this.refreshRequested,this.createFeature=n,this.deleteFeature=r,this.updateViewport=i,this.handleTilesLoaded=o,this.handleTilesContentLoaded=a,this.depth=s,this.tilesInFlight=new Set,this.instantiateTilesProvider(t)}var t,n,r;return t=e,(n=[{key:"instantiateTilesProvider",value:function(e){var t=this,n=e.tiles,r=n.tilesReaderConfig,i=n.tilesProvidersConfig,o=n.tilesCacheConfig,a=n.minZoomForTileRequest,s=e.locale;this.locale=s,this.tilesProvidersConfig={},Object.keys(r).forEach((function(n){r[n].forEach((function(r){if(!t.tilesProvidersConfig[r]){t.tilesProvidersConfig[r]={featureTypes:[]};var o=i[r];switch(o&&o.type||r){case"eg":t.tilesProvidersConfig[r].service=new qu(o,e.loggerFactory);break;case"noop":t.tilesProvidersConfig[r].service=new Ru;break;default:throw new Error("Tiles provider ".concat(r," not supported"))}}t.tilesProvidersConfig[r].featureTypes.push(n)}))})),this.minZoomForTileRequest=a,this.tilesCache=new Tu(o.maxSize,o.maxDistance),this.tilesCache.addTilesListener(this.handleCacheEvent.bind(this))}},{key:"getNormalizedCoord",value:function(e,t,n){var r=1<<n,i=e;return t<0||t>=r?null:((i<0||i>=r)&&(i=(i%r+r)%r),{x:i,y:t})}},{key:"registerRefreshViewport",value:function(){var e=this,t=Date.now();this.refreshRequested=t,setTimeout((function(){var n=Date.now();(e.refreshRequested===t||e.lastRefresh+e.delayForceRefresh<n)&&(e.refreshRequested=n,e.lastRefresh=n,e.updateViewport())}),this.delayBeforeRefresh)}},{key:"_getTileInFlightKey",value:function(e,t,n,r){return"".concat(e,",").concat(t,",").concat(n,",").concat(r)}},{key:"_registerTileInFlight",value:function(e,t,n,r){this.tilesInFlight.add(this._getTileInFlightKey(e,t,n,r))}},{key:"_removeTileInFlight",value:function(e,t,n,r){this.tilesInFlight.delete(this._getTileInFlightKey(e,t,n,r))}},{key:"_areInFlightTilesDone",value:function(){return 0===this.tilesInFlight.size}},{key:"_loadData",value:function(e,t,n,r,i,o,a){for(var s=Math.pow(2,a),u=i+a,l=n*s,c=r*s,f=[],d=0;d<s;d++)for(var h=0;h<s;h++)f.push(e.loadTile(t,l+d,c+h,u,o));return Promise.all(f).then((function(e){return e.flat()}))}},{key:"loadTile",value:function(e,t,n){var r=this;if(this.tilesProvidersConfig&&Object.keys(this.tilesProvidersConfig).length>0&&!isNaN(e)&&!isNaN(t)&&!isNaN(n)){var i=this.getNormalizedCoord(e,t,n);if(null!==i&&n>=this.minZoomForTileRequest&&!this.tilesCache.getTile(i.x,i.y,n)){this.tilesCache.setTile(i.x,i.y,n,[]);var o=[],a=function(e){var t=r.tilesProvidersConfig[e],a=t.service,s=t.featureTypes;r._registerTileInFlight(e,i.x,i.y,n);var u,l=Gu(s);try{var c=function(){var t=u.value;o.push(r._loadData(a,t,i.x,i.y,n,r.locale,r.depth).then((function(n){return{data:n,tilesProvider:e,featureType:t}})))};for(l.s();!(u=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}};for(var s in this.tilesProvidersConfig)a(s);return Promise.all(o).then((function(o){var a=[],s={};for(var u in o.forEach((function(i){var o=i.data,u=i.tilesProvider,l=i.featureType;return o.forEach((function(i){i.tile=[e,t,n],a.push(r.createFeature(i)),s[u]?s[u].includes(l)||s[u].push(l):s[u]=[l]}))})),r.tilesCache.setTile(i.x,i.y,n,a),r.tilesProvidersConfig)r._removeTileInFlight(u,i.x,i.y,n);r._areInFlightTilesDone()&&r.handleTilesContentLoaded(Object.keys(r.tilesProvidersConfig)),a.length>0&&(r.registerRefreshViewport(),Object.keys(s).forEach((function(e){return r.handleTilesLoaded(e,s[e].join(","),["(".concat(i.x,", ").concat(i.y,", ").concat(n,")")])})))})).catch((function(){return r.tilesCache.setTile(i.x,i.y,n,null)}))}}return Promise.resolve()}},{key:"handleCacheEvent",value:function(e,t,n,r,i){var o=this;e===Tu.EVENTS.EXPIRE&&(this.logger.infoEnabled()&&this.logger.info("Cache expires. Deleting ".concat(i.length," features")),i.forEach((function(e){return o.deleteFeature(e)})))}}])&&$u(t.prototype,n),r&&$u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ju(e){return Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ju(e)}function el(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tl(r.key),r)}}function tl(e){var t=function(e,t){if("object"!==Ju(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ju(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ju(t)?t:String(t)}var nl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.configHelper=new Bs(Ks(),t,Qi),this.eventsManager=new di(this.configHelper.logger("EventsManager")),this.dataRepositories=new Ra,this.mapData=ms(),this.uniqId=an()}var t,n,r;return t=e,n=[{key:"_initializeProperties",value:function(){this.logger=this.configHelper.logger("EGMap"),this.logger.debug("initializing EGMaps"),"mapbox"===this.configHelper.mapProvider()?this.mapImpl=this._createMapBox():this.mapImpl=this._createGMaps()}},{key:"_createMapBox",value:function(){if(this.logger.debug("creating MapBox"),"undefined"!=typeof egmapsMapbox)return new egmapsMapbox.MapBox(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/mapbox' to use this map provider")}},{key:"_createGMaps",value:function(){if(this.logger.debug("creating GMaps"),"undefined"!=typeof egmapsGoogleMaps)return new egmapsGoogleMaps.GMaps(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/google-maps' to use this map provider")}},{key:"initMap",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return this.configHelper.ready().then((function(){return t._initMap(e,n,r,i)})).then((function(){}))}},{key:"_cleanPreviousMapContainer",value:function(e,t){var n=le(e,["egmaps"]);return n.length>0?(t||this.logger.warn("This container contains some other instance of eg-maps.In order to avoid unexpected behavior the container will be cleaned."),n.forEach((function(e){return me(e.element)})),n[0].index):-1}},{key:"_createMapContainer",value:function(e,t,n){var r=this.uniqId;null!=e&&e.id&&(r="".concat(e.id,"-").concat(r));var i=we(r,void 0,"egmaps",void 0,n);t>=0?Ct(i,e,t):e.appendChild(i);var o=this.configHelper.readParam("additionalCssClass");return o&&st(i,o),st(i,this.configHelper.mapProvider()),i}},{key:"updateConfiguration",value:function(e){var t,n=this,r=this.configHelper,i=r.getConfigurations(),o=null===(t=i.parameter)||void 0===t?void 0:t.externalConfigEndpoint,a=e.externalConfigEndpoint&&e.externalConfigEndpoint===o?i.external:void 0,s=new Bs(Ks(),e,Qi,a);return s.ready().then((function(){var e=r.loadMapSettings(),t=s.loadMapSettings(),i=Rs(e,t);if(Object.keys(i).filter((function(e){return i[e]})).length>0){if(n.configHelper=s,n.mapImpl.updateConfigHelperOnFeatures(n.configHelper),i.reinstantiate){var o=n.mapImpl.getBounds(),a=n.mapImpl.listRegisteredRoutes();return n.mapImpl.clearHashkeys(),n.mapImpl.clearMarkers(),n._initMap(n.originalNode,!0,o,void 0).then((function(e){return e.refresh()})).then((function(){return n.mapImpl.syncRegisteredRoutes(a),n.mapImpl.updateRoutesOnViewport()})).then((function(){return i}))}return n.mapImpl.updateConfiguration(n.configHelper,t,i).then((function(){return i}))}return{}}))}},{key:"_initMap",value:function(e,t,n,r){var i=this;this._initializeProperties();var o=this._cleanPreviousMapContainer(e,t),a="style-".concat(this.uniqId);return this.originalNode=e,this.node=this._createMapContainer(e,o,a),this.clientPadding=r,this.mapImpl.initMap(this.node,a,n,this.clientPadding).then((function(){return i.mapImpl}))}},{key:"centerAndZoomMap",value:function(e,t,n){var r;return!0===(null===(r=this.mapImpl)||void 0===r?void 0:r.centerAndZoomMap(e,t,n))}},{key:"getCenter",value:function(){if(this.mapImpl)return this.mapImpl.getCenter();throw new Error("map is not initialized")}},{key:"getZoom",value:function(){if(this.mapImpl)return this.mapImpl.getZoom();throw new Error("map is not initialized")}},{key:"getBounds",value:function(){if(this.mapImpl)return this.mapImpl.getBounds();throw new Error("map is not initialized")}},{key:"unbindAll",value:function(){this.mapImpl&&this.mapImpl.unbindAll(),me(this.node)}},{key:"fitLatLongs",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;return this.mapImpl?this.mapImpl.fitLatLongs(e,t,n):Promise.reject(new Error("map is not initialized"))}},{key:"fitBounds",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return this.mapImpl?this.mapImpl.fitBounds(e,t,n,r):Promise.reject(new Error("map is not initialized"))}},{key:"boundsContaining",value:function(e,t,n){return this.mapImpl?this.mapImpl.boundsContaining(e,t,n):Promise.reject(new Error("map is not initialized"))}},{key:"boundsContainingPolygon",value:function(e){return this.mapImpl?this.mapImpl.boundsContainingPolygon(e):Promise.reject(new Error("map is not initialized"))}},{key:"pushFeatureData",value:function(e,t){if(this.mapImpl)return this.mapImpl.pushFeatureData(e,t,!1);throw new Error("map is not initialized")}},{key:"removePushedFeatureData",value:function(e){if(this.mapImpl)return this.mapImpl.removePushedFeatureData(e,!1);throw new Error("map is not initialized")}},{key:"registerRoute",value:function(e,t,n){if(this.mapImpl)return this.mapImpl.registerRoute(e,t,n);throw new Error("map is not initialized")}},{key:"registerRouteDestination",value:function(){var e;if(this.mapImpl)return(e=this.mapImpl).registerRouteDestination.apply(e,arguments);throw new Error("map is not initialized")}},{key:"listRegisteredRouteDestinations",value:function(){if(this.mapImpl)return this.mapImpl.listRegisteredRouteDestinations();throw new Error("map is not initialized")}},{key:"listRegisteredRoutes",value:function(e){if(this.mapImpl)return this.mapImpl.listRegisteredRoutes(e);throw new Error("map is not initialized")}},{key:"deregisterRouteDestination",value:function(){var e;if(this.mapImpl)return(e=this.mapImpl).deregisterRouteDestination.apply(e,arguments);throw new Error("map is not initialized")}},{key:"deregisterRoute",value:function(e,t){if(this.mapImpl)return this.mapImpl.deregisterRoute(e,t);throw new Error("map is not initialized")}},{key:"showRoutes",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).showRoutes.apply(n,[e,t].concat(i))}return Promise.reject(new Error("map is not initialized"))}},{key:"hideRoutes",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).hideRoutes.apply(n,[e,t].concat(i))}return Promise.reject(new Error("map is not initialized"))}},{key:"listRoutesDisplayed",value:function(){if(this.mapImpl)return this.mapImpl.listRoutesDisplayed();throw new Error("map is not initialized")}},{key:"showPolygons",value:function(){var e;return this.mapImpl?(e=this.mapImpl).showPolygons.apply(e,arguments):Promise.reject(new Error("map is not initialized"))}},{key:"hidePolygons",value:function(){var e;return this.mapImpl?(e=this.mapImpl).hidePolygons.apply(e,arguments):Promise.reject(new Error("map is not initialized"))}},{key:"listPolygonsDisplayed",value:function(){if(this.mapImpl)return this.mapImpl.listPolygonsDisplayed();throw new Error("map is not initialized")}},{key:"listFeatures",value:function(e,t){if(this.mapImpl)return this.mapImpl.listFeatures(e,t);throw new Error("map is not initialized")}},{key:"selectFeature",value:function(e,t,n){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.selectFeature(e,t,n)}},{key:"clearSelectedFeature",value:function(){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.clearSelectedFeature()}},{key:"dehighlightFeatures",value:function(){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.dehighlightFeatures()}},{key:"listHighlightedFeatures",value:function(){if(this.mapImpl)return this.mapImpl.listHighlightedFeatures();throw new Error("map is not initialized")}},{key:"markFeatureOver",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.markFeatureOver(e,t)}},{key:"markFeatureOut",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.markFeatureOut(e,t)}},{key:"getFeatureSelected",value:function(){if(this.mapImpl)return this.mapImpl.getFeatureSelected();throw new Error("map is not initialized")}},{key:"setPopupContent",value:function(e,t,n){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.setPopupContent(e,t,n)}},{key:"turnProductsVisible",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("product",e,t,n,r)}},{key:"turnPropertiesVisible",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("property",e,t,n,r)}},{key:"turnPlacesVisible",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("place",e,t,n,r)}},{key:"addBoundChangeListener",value:function(e,t){return this.eventsManager.addBoundChangeListener(e,t)}},{key:"removeBoundChangeListener",value:function(e){return this.eventsManager.removeBoundChangeListener(e)}},{key:"deregisterBoundChangeListener",value:function(e){return this.eventsManager.deregisterBoundChangeListener(e)}},{key:"addMarkerChangeListener",value:function(e,t){return this.eventsManager.addMarkerChangeListener(e,t)}},{key:"removeMarkerChangeListener",value:function(e){return this.eventsManager.removeMarkerChangeListener(e)}},{key:"deregisterMarkerChangeListener",value:function(e){return this.eventsManager.deregisterMarkerChangeListener(e)}},{key:"addSelectionChangeListener",value:function(e,t){return this.eventsManager.addSelectionChangeListener(e,t)}},{key:"removeSelectionChangeListener",value:function(e){return this.eventsManager.removeSelectionChangeListener(e)}},{key:"deregisterSelectionChangeListener",value:function(e){return this.eventsManager.deregisterSelectionChangeListener(e)}},{key:"addKeyPressListener",value:function(e,t){return this.eventsManager.addKeyPressListener(e,t)}},{key:"removeKeyPressListener",value:function(e){return this.eventsManager.removeKeyPressListener(e)}},{key:"deregisterKeyPressListener",value:function(e){return this.eventsManager.deregisterKeyPressListener(e)}},{key:"addHoverChangeListener",value:function(e,t){return this.eventsManager.addHoverChangeListener(e,t)}},{key:"removeHoverChangeListener",value:function(e){return this.eventsManager.removeHoverChangeListener(e)}},{key:"deregisterHoverChangeListener",value:function(e){return this.eventsManager.deregisterHoverChangeListener(e)}},{key:"addFeatureContentLoadedListener",value:function(e,t){return this.eventsManager.addFeatureContentLoadedListener(e,t)}},{key:"removeFeatureContentLoadedListener",value:function(e){return this.eventsManager.removeFeatureContentLoadedListener(e)}},{key:"deregisterFeatureContentLoadedListener",value:function(e){return this.eventsManager.deregisterFeatureContentLoadedListener(e)}},{key:"addIdleListener",value:function(e,t){return this.eventsManager.addIdleListener(e,t)}},{key:"removeIdleListener",value:function(e){return this.eventsManager.removeIdleListener(e)}},{key:"deregisterIdleListener",value:function(e){return this.eventsManager.deregisterIdleListener(e)}},{key:"addRouteChangeListener",value:function(e,t){return this.eventsManager.addRouteChangeListener(e,t)}},{key:"removeRouteChangeListener",value:function(e){return this.eventsManager.removeRouteChangeListener(e)}},{key:"deregisterRouteChangeListener",value:function(e){return this.eventsManager.deregisterRouteChangeListener(e)}},{key:"addTilesLoadedListener",value:function(e,t){return this.eventsManager.addTilesLoadedListener(e,t)}},{key:"removeTilesLoadedListener",value:function(e){return this.eventsManager.removeTilesLoadedListener(e)}},{key:"deregisterTilesLoadedListener",value:function(e){return this.eventsManager.deregisterTilesLoadedListener(e)}},{key:"addTilesContentLoadedListener",value:function(e,t){return this.eventsManager.addTilesContentLoadedListener(e,t)}},{key:"removeTilesContentLoadedListener",value:function(e){return this.eventsManager.removeTilesContentLoadedListener(e)}},{key:"deregisterTilesContentLoadedListener",value:function(e){return this.eventsManager.deregisterTilesContentLoadedListener(e)}},{key:"addMapTypeChangedListener",value:function(e,t){return this.eventsManager.addMapTypeChangedListener(e,t)}},{key:"deregisterMapTypeChangedListener",value:function(e){return this.eventsManager.deregisterMapTypeChangedListener(e)}},{key:"setStay",value:function(e){if(this.mapImpl)return this.mapImpl.setStay(e);throw new Error("map is not initialized")}},{key:"refresh",value:function(){return this.mapImpl?this.mapImpl.refresh():Promise.resolve()}},{key:"turnKeyboardFeaturesMode",value:function(e){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnKeyboardFeaturesMode(e)}},{key:"isKeyboardFeaturesModeEnabled",value:function(){if(this.mapImpl)return this.mapImpl.isKeyboardFeaturesModeEnabled();throw new Error("map is not initialized")}},{key:"getActiveTilesets",value:function(){if(this.mapImpl)return this.configHelper.getActiveTilesets();throw new Error("map is not initialized")}},{key:"readConfigParam",value:function(e){return this.configHelper.readParam(e)}},{key:"getSubConfig",value:function(e){return this.configHelper.subConfig(e)}},{key:"getConfigurations",value:function(){return this.configHelper.getEGMapConfigurations()}},{key:"updatePartiallyFeature",value:function(e){if(this.mapImpl)return this.mapImpl.updatePartiallyFeature(e);throw new Error("map is not initialized")}},{key:"addQualifierToFeature",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).addQualifierToFeature.apply(n,[e,t].concat(i))}throw new Error("map is not initialized")}},{key:"addQualifierToFeatures",value:function(e){if(this.mapImpl){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.mapImpl).addQualifierToFeatures.apply(t,[e].concat(r))}throw new Error("map is not initialized")}},{key:"removeQualifierFromFeature",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).removeQualifierFromFeature.apply(n,[e,t].concat(i))}throw new Error("map is not initialized")}},{key:"removeQualifierFromFeatures",value:function(e){if(this.mapImpl){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.mapImpl).removeQualifierFromFeatures.apply(t,[e].concat(r))}throw new Error("map is not initialized")}},{key:"bounceMarker",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.bounceMarker(e,t)}},{key:"forceMapModeView",value:function(){this.mapImpl&&this.mapImpl.forceMapModeView()}}],n&&el(t.prototype,n),r&&el(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}(),r}()},22676:function(e,t,n){var r;window,e.exports=(r=n(90439),function(){var e={621:function(e){e.exports=r}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){n.r(i);var e={};n.r(e),n.d(e,{GMaps:function(){return ae}});var t,r=n(621),o=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return this.None(e)},Out:function(e){return this.None(e)},InOut:function(e){return this.None(e)}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(e){var t=1.70158;return 1===e?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return 0===e?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-o.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*o.Bounce.In(2*e):.5*o.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),a=function(){return performance.now()},s=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=a()),void 0===t&&(t=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var i=this._tweens[n[r]],o=!t;i&&!1===i.update(e,o)&&!t&&delete this._tweens[n[r]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),u={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=u.Utils.Linear;return t<0?o(e[0],e[1],r):t>1?o(e[n],e[n-1],n-r):o(e[i],e[i+1>n?n:i+1],r-i)},Bezier:function(e,t){for(var n=0,r=e.length-1,i=Math.pow,o=u.Utils.Bernstein,a=0;a<=r;a++)n+=i(1-t,r-a)*i(t,a)*e[a]*o(r,a);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=u.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(i=Math.floor(r=n*(1+t))),o(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(o(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):o(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=u.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:(t=[1],function(e){var n=1;if(t[e])return t[e];for(var r=e;r>1;r--)n*=r;return t[e]=n,n}),CatmullRom:function(e,t,n,r,i){var o=.5*(n-e),a=.5*(r-t),s=i*i;return(2*t-2*n+o+a)*(i*s)+(-3*t+3*n-2*o-a)*s+o*i+t}}},l=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),c=new s,f=function(){function e(e,t){void 0===t&&(t=c),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=o.Linear.None,this._interpolationFunction=u.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=l.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=a()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var n in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var i in this._valuesEnd)r[i]=this._valuesEnd[i];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,n,r,i){for(var o in n){var a=e[o],s=Array.isArray(a),u=s?"array":typeof a,l=!s&&Array.isArray(n[o]);if("undefined"!==u&&"function"!==u){if(l){if(0===(v=n[o]).length)continue;for(var c=[a],f=0,d=v.length;f<d;f+=1){var h=this._handleRelativeValue(a,v[f]);if(isNaN(h)){l=!1,console.warn("Found invalid interpolation list. Skipping.");break}c.push(h)}l&&(n[o]=c)}if("object"!==u&&!s||!a||l)(void 0===t[o]||i)&&(t[o]=a),s||(t[o]*=1),r[o]=l?n[o].slice().reverse():t[o]||0;else{t[o]=s?[]:{};var p=a;for(var y in p)t[o][y]=p[y];r[o]=s?[]:{};var v=n[o];if(!this._isDynamic){var g={};for(var y in v)g[y]=v[y];n[o]=v=g}this._setupProperties(p,t[o],v,r[o],i)}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=a()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=a()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return void 0===e&&(e=c),this._group=e,this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=o.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=u.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){var n,r,i=this;if(void 0===e&&(e=a()),void 0===t&&(t=!0),this._isPaused)return!0;var o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>o)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var s=e-this._startTime,u=this._duration+(null!==(n=this._repeatDelayTime)&&void 0!==n?n:this._delayTime),l=this._duration+this._repeat*u,c=function(){if(0===i._duration)return 1;if(s>l)return 1;var e=Math.trunc(s/u),t=s-e*u,n=Math.min(t/i._duration,1);return 0===n&&s===i._duration?1:n}(),f=this._easingFunction(c);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,c),0===this._duration||s>=this._duration){if(this._repeat>0){var d=Math.min(Math.trunc((s-this._duration)/u)+1,this._repeat);for(r in isFinite(this._repeat)&&(this._repeat-=d),this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[r]||(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=u*d,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var h=0,p=this._chainedTweens.length;h<p;h++)this._chainedTweens[h].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,n,r){for(var i in n)if(void 0!==t[i]){var o=t[i]||0,a=n[i],s=Array.isArray(e[i]),u=Array.isArray(a);!s&&u?e[i]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(e[i],o,a,r):"number"==typeof(a=this._handleRelativeValue(o,a))&&(e[i]=o+(a-o)*r)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),d=(l.nextId,c),h=(d.getAll.bind(d),d.removeAll.bind(d),d.add.bind(d),d.remove.bind(d),d.update.bind(d));function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},b.apply(this,arguments)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===p(i)?i:String(i)),r)}var i}function P(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var i=_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var x=r.Utils.firstDefinedValue,O=r.Utils.firstDefinedValueAndKey,F=r.Utils.firstDefinedKey,S=r.Utils.removeDuplicates,E=r.Utils.roundLatOrLng,I=r.Utils.roundLatLng,A=r.Utils.isArray,T=r.Utils.getPaddedZoomAndCenter,D=r.Utils.roundZoom,j=r.Geo.computeZoomFromBBox,B=r.Geo.addMeterToLat,R=r.Geo.convertGeoJsonPolygonToPath,N=r.MarkerUtils.setAccessibilityFields,U=r.MarkerUtils.createCornerIcons,V=r.MarkerUtils.createInnerIcons,z=r.MarkerUtils.createDoubleClickEventCanceller,K=r.MarkerUtils.createImageIcon,Z=r.MarkerUtils.createBasicTextMarker,H=r.Labels.createLabels,q=256,W=256,G=function(e){C(n,e);var t=M(n);function n(e,r,i,o,a,s){var u;return k(this,n),(u=t.call(this,e,r,i,o,a,s,0)).tileSize=new google.maps.Size(q,W),u.debugTileId=e.tiles.debugTileId,u}return P(n,[{key:"getTile",value:function(e,t,n){var r=this;if(setTimeout((function(){return r.loadTile(e.x,e.y,t)}),10),this.debugTileId){var i=n.createElement("div");return i.innerHTML=String(e),i.style.width=this.tileSize.width+"px",i.style.height=this.tileSize.height+"px",i.style.fontSize="10",i.style.borderStyle="solid",i.style.borderWidth="1px",i.style.borderColor="#AAAAAA",i}}},{key:"unbindAll",value:function(){this.getPanes().overlayMouseTarget.removeAllChildren()}}]),n}(r.TilesLoader),Q="click",$="click",X="mouseenter",Y="mouseleave",J="focus",ee="focusout",te="keydown",ne="keyup",re="keypress",ie={mapDragStart:"dragstart",mapDragEnd:"dragend",mapCenterChanged:"center_changed",mapBoundsChanged:"bounds_changed",mapZoomChanged:"zoom_changed",tilesLoaded:"tilesloaded",idle:"idle",mapTypeIdChanged:"maptypeid_changed"},oe="marker-icon",ae=function(e){C(n,e);var t=M(n);function n(e,r,i,o){var a;return k(this,n),(a=t.call(this,e,r,i,o)).logger=e.logger("GMaps"),a.logger.debug("GMaps constructor"),a.mapFocusListenersToRegister=[],a.visiblePolygonsByKey=new Map,a.realmap=void 0,a.keyboardListeners=void 0,a}return P(n,[{key:"_buildMapProviderOptions",value:function(e,t){var n,r={keyboardShortcuts:!1};return null!==(n=this.settings.googleMaps)&&void 0!==n&&n.gmapsAddConfig&&Object.assign(r,this.settings.googleMaps.gmapsAddConfig),e&&t&&(r.zoom=e,r.center={lat:t[0],lng:t[1]}),r}},{key:"updateMapProviderConfig",value:function(){var e=this._buildMapProviderOptions(this.realmap.getZoom(),this.getCenter());this.realmap.setOptions(e)}},{key:"removeMarkerFromMap",value:function(e){r.HtmlUtils.detachElement(e),e.debug&&e.debug.setMap(null),this.clearObfuscateAreaFromMarker(e),this.cleanMarkerListeners(e)}},{key:"cleanMarkerListeners",value:function(e){var t;null===(t=e.clean)||void 0===t||t.forEach((function(e){return e()})),e.clean=[]}},{key:"cloneMarker",value:function(e){return null==e?void 0:e.clone()}},{key:"_callbackWhenElementReattached",value:function(){var e=this;return new Promise((function(t){setTimeout((function(){var n=e.temporaryDiv;e.temporaryDiv=void 0,e._reattachElementFromTemporaryDiv(n,e.customMarkerOverlay.getPanes().overlayMouseTarget),e._updateViewport(),t()}),20)}))}},{key:"init",value:function(e,t){var n=this,i=this.addEventListener.bind(this),o=this._zoomAndCenterFromViewport(e,t)||{},a=o.zoom,s=o.center,u=this._buildMapProviderOptions(a,s);this.node&&(this.realmap=new google.maps.Map(this.node,u)),this._initializeTilesOverlayMapType(),r.HtmlUtils.documentIsDefined()&&(this.temporaryDiv=r.HtmlUtils.createDiv(this.uniqId("temporaryDiv")));var l=this._createPopup.bind(this),c=this._registerKeyboardListeners.bind(this),f=this._registerListenersMap.bind(this),d=this._registerMapFocusListeners.bind(this),h=this._registerTilesLoadedListener.bind(this),p=this._updateViewport.bind(this);return this._initializeCustomMarkerOverlay(this.temporaryDiv,this._callbackWhenElementReattached.bind(this)).then((function(){n.mapNavFocusElement=n._findMapFocusElement(),n.mapNavFocusElement&&(r.HtmlUtils.setTabIndex(n.mapNavFocusElement,0),n.mapFocusListenersToRegister.forEach((function(e){var t=e.eventName,r=e.cb;n.listenersToDeregister.push(i(n.mapNavFocusElement,t,r))}))),n.popup=l(),c(),f(),d(),h(),p()})),this.configHelper.readParam("map,mapInitWaitForTiles")?new Promise((function(e){return i(n.realmap,ie.tilesLoaded,e,!0)})):Promise.resolve()}},{key:"_findMapFocusElement",value:function(){if(this.node)return r.HtmlUtils.childrenAsArray(this.node).map((function(e){return r.HtmlUtils.getFirstChildWithAriaRoleDescription(e,"map",!0)})).filter((function(e){return void 0!==e}))[0]}},{key:"registerListenerOnMapFocusElement",value:function(e,t){this.mapNavFocusElement?this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t)):this.mapFocusListenersToRegister.push({eventName:e,cb:t})}},{key:"_registerMapFocusListeners",value:function(){var e=this;this.keyboardFeatures&&this.mapNavFocusElement&&(this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,J,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility()}))),this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,ee,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility(!1)}))))}},{key:"_registerTilesLoadedListener",value:function(){var e=this;this.listenersToDeregister.push(this.addEventListener(this.realmap,ie.tilesLoaded,(function(){return e.handleTilesLoaded("mapProvider","map")})))}},{key:"_initializeTilesOverlayMapType",value:function(){var e;this.tilesLoader=new G(this.settings,this.createTileFeature.bind(this),this.removeTileFeature.bind(this),this._updateViewport.bind(this),this.handleTilesLoaded.bind(this),this.handleTilesContentLoaded.bind(this)),null===(e=this.realmap)||void 0===e||null===(e=e.overlayMapTypes)||void 0===e||e.insertAt(0,this.tilesLoader)}},{key:"_reattachElementFromTemporaryDiv",value:function(e,t){if(e)for(var n=e.children,i=0;i<((null==n?void 0:n.length)||-1);i++)r.HtmlUtils.reattachElement(n[i],t)}},{key:"_initializeCustomMarkerOverlay",value:function(e,t){var n=this,i=this._updateMarkerPosition.bind(this),o=this.features.all.bind(this),a=function(n,i,o,a,s){this.updateTextMarkerPosition=i,this.listAllFeatures=o,this.onAdd=function(){var n=this.getPanes().overlayMouseTarget;a(e),r.HtmlUtils.setZIndex(n,google.maps.Marker.MAX_ZINDEX+1),t(),s()},this.setMap(n),this.onRemove=function(){this.listAllFeatures().forEach((function(e){r.HtmlUtils.detachElement(e.popup)}));var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.clusters);try{for(t.s();!(e=t.n()).done;){var n=e.value;r.HtmlUtils.detachElement(n.marker)}}catch(e){t.e(e)}finally{t.f()}},this.draw=function(){this.updateTextMarkerPosition()}};return a.prototype=new google.maps.OverlayView,new Promise((function(e){n.customMarkerOverlay=new a(n.realmap,i,o,n._reattachElementFromTemporaryDiv.bind(n),e)}))}},{key:"getMarkerComponent",value:function(e){return e.marker}},{key:"moveMarkerPosition",value:function(e,t){var n=this.customMarkerOverlay.getProjection(),r=n.fromLatLngToDivPixel(new google.maps.LatLng(e.latLng[0],e.latLng[1])),i={x:r.x+t.x,y:r.y+t.y},o=n.fromDivPixelToLatLng(i);e.latLng[0]=o.lat(),e.latLng[1]=o.lng(),e.computedLatLng=[o.lat(),o.lng()],this.getMarkerComponent(e).position=o,this._updateMarkerPositionOnLayer(e,n)}},{key:"_updateViewport",value:function(e){var t,r=this;return null!==(t=this.customMarkerOverlay)&&void 0!==t&&null!==(t=t.getPanes())&&void 0!==t&&t.overlayMouseTarget?b(_(n.prototype),"_updateViewport",this).call(this,e).then((function(e){return r._updateMarkerPosition(),e})):Promise.resolve(e)}},{key:"getRectOfMarker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.customMarkerOverlay.getProjection(),i=e.computedLatLng&&e.computedLatLng[0]?e.computedLatLng[0]:e.latLng[0],o=e.computedLatLng&&e.computedLatLng[1]?e.computedLatLng[1]:e.latLng[1],a=n.fromLatLngToDivPixel(new google.maps.LatLng(i,o)),s=this.getMarkerComponent(e),u=s.clientWidth,l=s.clientHeight;return r.HtmlUtils.getRect(a,u+2*t,l+2*t)}},{key:"_updateMarkerPosition",value:function(e){var t=this;if(this.customMarkerOverlay){var r=this.customMarkerOverlay.getProjection();if(r){var i=e?e.filter((function(e){return t.getMarkerComponent(e)})):this.features.all().filter((function(e){return t.getMarkerComponent(e)})).concat(this.clusters||[]);if(this.settings.isAtLeastOnePropertyStatusUsingObfuscateMarker||this.settings.isAtLeastOneProductStatusUsingObfuscateMarker){var o=this.getCenter();Object.values(this.settings.obfuscateRadiusInMeters).forEach((function(e){var n=[E(B(o[0],2*e.radius)),o[1]];e.width=Math.round(t._fromLatLngToDivPixel.apply(t,[r].concat(v(o))).y-t._fromLatLngToDivPixel.apply(t,[r].concat(n)).y)}))}i.forEach((function(e){return t._updateMarkerPositionOnLayer(e,r)})),b(_(n.prototype),"_updateMarkerPosition",this).call(this,i),this.updatePopupPositionOnLayer()}}}},{key:"_updateMarkerPositionOnLayer",value:function(e,t){if(e&&this.getMarkerComponent(e)&&t){var n=t.fromLatLngToDivPixel(this.getMarkerComponent(e).position);if(n){var i="middle";switch(e.markerType){case"pin":case"price":case"text":i="bottom"}r.HtmlUtils.setPosition(this.getMarkerComponent(e),n.x+0,n.y+0,i)}}}},{key:"_fromLatLngToDivPixel",value:function(e,t,n){return null==e?void 0:e.fromLatLngToDivPixel(new google.maps.LatLng(t,n))}},{key:"_fromDivPixelToLatLng",value:function(e,t,n){return null==e?void 0:e.fromDivPixelToLatLng(new google.maps.Point(t,n))}},{key:"updatePopupPositionOnLayer",value:function(){var e,t=(this.popup||{}).feature;if(null!==(e=this.customMarkerOverlay)&&void 0!==e&&e.getProjection()&&t&&t.defined){var n,i,o,a=this._fromLatLngToDivPixel.apply(this,[this.customMarkerOverlay.getProjection()].concat(v(t.latLng)));switch(x(this.settings.popupPositions[t.type],t.hashKeys)){case"above":default:n=0,i=-2,o="bottom";break;case"below":n=0,i=2,o="top"}a&&r.HtmlUtils.setPosition(this.popup,a.x+n,a.y+i,o)}}},{key:"ensurePopupVisibility",value:function(){var e=this.popup,t=e.feature,n=e.offsetWidth,r=e.offsetHeight,i=this.node,o=i.offsetWidth,a=i.offsetHeight,s=x(this.configHelper.popupVisibilityPaddings()[t.type],t.hashKeys),u=null==s?void 0:s.x,l=null==s?void 0:s.y,c="below"===x(this.settings.popupPositions[t.type],t.hashKeys),f=c?1:-1,d=this.getRectOfMarker(t).height,h=this._fromLatLngToDivPixel.apply(this,[this.customMarkerOverlay.getProjection()].concat(v(t.latLng))),p={x:h.x+o/2-n/2,y:h.y+d*f+a/2+r*f},g=y(this._calculatePopupVisibilityOffsetValues(p,u,l,o,a,n,r,c),2),m=g[0],b=g[1];0===m&&0===b||this.realmap.panBy(m,b)}},{key:"_registerListenersMap",value:function(){var e,t,n,i=this;this.lastCenterChecked={centers:[this.getCenter()],events:[]},this.lastZoomValueChecked=[this.getZoom()],(e=this.listenersToDeregister).push.apply(e,v(this._registerListenerForIdle())),this.listenersToDeregister.push(this._registerDragEndEventLogic()),(t=this.listenersToDeregister).push.apply(t,v(this._registerZoomListener())),(n=this.listenersToDeregister).push.apply(n,v(this._registerCenterChangedEventLogic())),this.listenersToDeregister.push(this.addEventListener(this.realmap,ie.mapDragStart,this.handleDragStart.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.node,$,this.handleMapClick.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.realmap,ie.mapTypeIdChanged,function(){i.eventsManager.pushEvent(r.EventTypes.mapTypeChanged,{mapTypeId:i.realmap.getMapTypeId()})}.bind(this)))}},{key:"_registerListenerForIdle",value:function(){this.idle=!0;var e=this;return[this.addEventListener(this.realmap,ie.idle,(function(){e.idle=!0,e.eventsManager.pushEvent(r.EventTypes.idle)})),this.addEventListener(this.realmap,ie.mapBoundsChanged,(function(){return e.idle=!1}))]}},{key:"_registerKeyboardListeners",value:function(){var e=this,t=this.getZoom.bind(this);this.keyboardListeners=new r.KeyboardListeners((function(t){var n;return(n=e.realmap).panBy.apply(n,v(t))}),(function(){return e.realmap.setZoom(t()+1)}),(function(){return e.realmap.setZoom(t()-1)})),this.registerListenerOnMapFocusElement(te,this.keyboardListeners.keyDownListenerCallback),this.registerListenerOnMapFocusElement(ne,this.keyboardListeners.keyUpListenerCallback),this.registerListenerOnMapFocusElement(re,this.keyboardListeners.keyPressListenerCallback)}},{key:"_registerDragEndEventLogic",value:function(){var e=this;return this.addEventListener(this.realmap,ie.mapDragEnd,(function(){e.lastCenterChecked.events.push("drag")}))}},{key:"_registerCenterChangedEventLogic",value:function(){var e=this,t=this.settings.googleMaps.debouncingEventsTime.centerChanged;return[this.addEventListener(this.realmap,ie.mapCenterChanged,(function(){e.boundChangedDisabled?e.lastCenterChecked.centers=[e.getCenter()]:e.lastCenterChecked.centers[1]=e.getCenter()})),this.addEventListener(this.realmap,ie.idle,(function(){if(e.lastCenterChecked.centers.length>1){var n=y(e.getCenter(),2),r=n[0],i=n[1],o=e.handleBoundsChanged.bind(e);setTimeout((function(){var t=e.getCenter(),n=y(t,2),a=n[0],s=n[1];if(a===r&&s===i){e.lastCenterChecked.centers=[t];var u=e.lastCenterChecked.events.splice(0,e.lastCenterChecked.events.length),l=e.keyboardListeners.extractKeyboardEvent("center_changed");S(l).forEach(o),S(u).forEach(o)}}),t)}}))]}},{key:"_registerZoomListener",value:function(){var e=this,t=this.settings.googleMaps.debouncingEventsTime.zoomChanged;return[this.addEventListener(this.realmap,ie.mapZoomChanged,(function(){e.boundChangedDisabled?e.lastZoomValueChecked=[e.getZoom()]:e.lastZoomValueChecked[1]=e.getZoom()})),this.addEventListener(this.realmap,ie.idle,(function(){if(e.lastZoomValueChecked.length>1){var n=e.getZoom(),r=e.handleBoundsChanged.bind(e);setTimeout((function(){var t=e.getZoom();if(t===n){var i=t>y(e.lastZoomValueChecked,1)[0];e.lastZoomValueChecked=[t];var o=e.keyboardListeners.extractKeyboardEvent("zoom_changed");o.length>0?S(o).forEach(r):i?e.handleBoundsChanged("zoomIn"):e.handleBoundsChanged("zoomOut")}}),t)}}))]}},{key:"_createCallbackForBoundsChanged",value:function(e){var t=this.handleBoundsChanged.bind(this);return function(){return t(e)}}},{key:"centerAndZoomMap",value:function(e,t,n){var r=y(e?I(e):[],2),i=r[0],o=r[1],a=t?D(t):void 0;if(void 0!==i&&void 0!==o&&void 0!==a&&void 0!==n){var s=this._parseClientPadding(n),u=this._getPaddedZoomAndCenterForCenterAndZoom(e,a,s)||{},l=u.zoom,c=u.center;if(void 0!==l&&void 0!==c){var f=y(c,2);i=f[0],o=f[1],a=l}}var d=this.realmap.getCenter(),h=y(I([d.lat(),d.lng()])||[],2),p=h[0],v=h[1],g=void 0!==i&&void 0!==o&&(p!==i||v!==o)||void 0!==a&&this.getZoom()!==a;return g&&this._fitViewport(a,[i,o],!1).then(this._updateViewport.bind(this)),g}},{key:"isFeatureInRealBound",value:function(e,t){return null==e?void 0:e.contains({lat:t.latLng[0],lng:t.latLng[1]})}},{key:"asNativeBounds",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new google.maps.LatLngBounds(new google.maps.LatLng(E(e[0]),E(e[1],void 0,n)),new google.maps.LatLng(E(t[0]),E(t[1],void 0,n)))}},{key:"getCenter",value:function(){var e=this.realmap.getCenter();return[E(e.lat()),E(e.lng())]}},{key:"getZoom",value:function(){return D(this.realmap.getZoom())}},{key:"unbindAll",value:function(){this.listenersToDeregister.forEach((function(e){return e()})),this.customMarkerOverlay&&this.customMarkerOverlay.unbindAll(),this.realmap.unbindAll()}},{key:"asBounds",value:function(e){if(e){var t=e.getSouthWest(),n=e.getNorthEast(),r=this.getCenter();return{sw:[E(t.lat()),E(t.lng())],ne:[E(n.lat()),E(n.lng())],center:r}}}},{key:"containerBounds",value:function(e){if(this.customMarkerOverlay){var t=this.customMarkerOverlay.getProjection();if(t){var n=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2)),r=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2));return{sw:[E(n.lat()),E(n.lng())],ne:[E(r.lat()),E(r.lng())],center:[E(n.lat()+(n.lat()-r.lat())/2),E(r.lng()+(r.lng()-n.lng())/2)]}}}}},{key:"_boundsForOneCoordinate",value:function(e){return e.getNorthEast().equals(e.getSouthWest())}},{key:"_extendsOneCoordinateBounds",value:function(e){var t=new google.maps.LatLng(e.getNorthEast().lat()+.01,e.getNorthEast().lng()+.01),n=new google.maps.LatLng(e.getNorthEast().lat()-.01,e.getNorthEast().lng()-.01);e.extend(t),e.extend(n)}},{key:"computeNativeBoundsFromLatLongs",value:function(e){if(e.length>0){var t=new google.maps.LatLngBounds;return e.forEach((function(e){var n=y(I(e),2),r=n[0],i=n[1];t.extend(new google.maps.LatLng(r,i))})),t}}},{key:"fitLatLongs",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;if(this.realmap){var r=this._parseClientPadding(n),i=this._getPaddedZoomAndCenterFromLatLongs(e,t,r)||{},o=i.zoom,a=i.center;if(void 0!==o&&void 0!==a){var s=this._updateViewport.bind(this),u=this.asBounds.bind(this);return this._fitViewport(o,a).then(s).then(u)}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"nativeBounds",value:function(){var e,t;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getProjection())||void 0===e||null===(e=e.getVisibleRegion())||void 0===e?void 0:e.latLngBounds)||(null===(t=this.realmap)||void 0===t?void 0:t.getBounds())}},{key:"switchMarkerType",value:function(e,t){b(_(n.prototype),"switchMarkerType",this).call(this,e,t)&&this.customMarkerOverlay&&this._updateMarkerPositionOnLayer(e,this.customMarkerOverlay.getProjection())}},{key:"onMarkerIconsChanged",value:function(e){this._updateMarkerPositionOnLayer(e,this.customMarkerOverlay.getProjection())}},{key:"_fitViewport",value:function(e,t){var n=this;if(void 0!==e||t){var i=this.settings.googleMaps.fitBoundsAnimTime||500,a=y(this.getCenter(),2),s=a[0],u=a[1],l={tilt:0,heading:0,zoom:this.getZoom(),center:{lat:s,lng:u}},c=y(t,2),d=c[0],p=c[1],v={zoom:e,center:{lat:d,lng:p}},g=this;r.Geo.areLongitudesCrossingDateLine([u,p])&&(u<0?l.center.lng+=360:l.center.lng-=360);var m=this.addEventListener.bind(this),b=function(){return new Promise((function(e){new f(l).to(v,i).easing(o.Exponential.Out).onUpdate((function(){var e=l;l.center.lng<-180?e={zoom:l.zoom,center:{lat:l.center.lat,lng:l.center.lng+360}}:l.center.lng>180&&(e={zoom:l.zoom,center:{lat:l.center.lat,lng:l.center.lng-360}}),g.boundChangedDisabled=!0,g.realmap.moveCamera(e)})).onComplete((function(){m(g.realmap,ie.idle,(function(){g.boundChangedDisabled=!1,e()}),!0)})).start(),requestAnimationFrame((function e(t){requestAnimationFrame(e),h(t)}))}))};return this.idle?b():new Promise((function(e){return m(n.realmap,ie.idle,(function(){return b().then(e)}),!0)}))}return Promise.resolve()}},{key:"_zoomAndCenterFromViewport",value:function(e,t){if(e){var n=e.center,r=e.zoom,i=e.sw,o=e.ne,a=e.coordinates,s=e.useBoundsComputation,u=e.options,l=this._parseClientPadding(t);if(n&&r)return this._getPaddedZoomAndCenterForCenterAndZoom(n,r,l);if(i&&o){var c=I(i),f=I(o);return this._getPaddedZoomAndCenterForBounds(c,f,!1,l)}if(a&&s){var d=this._computeNativeBounds(a,s,u),h=this._computeZoomAndCenterFromGmapsBounds(d,!1,l)||{},p=h.zoom,y=h.center;if(p&&y)return T(p,y,l)}else if(A(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLongs(e,!0,l)}}},{key:"_getPaddedZoomAndCenterForCenterAndZoom",value:function(e,t,n){return T(t,e,n)}},{key:"_getPaddedZoomAndCenterForBounds",value:function(e,t,n,r){var i=new google.maps.LatLngBounds(new google.maps.LatLng(e[0],e[1]),new google.maps.LatLng(t[0],t[1])),o=this._computeZoomAndCenterFromGmapsBounds(i,n,r)||{},a=o.zoom,s=o.center;if(a&&s)return T(a,s,r)}},{key:"_getPaddedZoomAndCenterFromLatLongs",value:function(e,t,n){var r=this._computeZoomAndCenterFromGmapsBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,n)||{},i=r.zoom,o=r.center;if(i&&o)return T(i,o,n)}},{key:"_computeZoomAndCenterFromGmapsBounds",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=e;this._boundsForOneCoordinate(r)&&(r=new google.maps.LatLngBounds(r.getSouthWest(),r.getNorthEast()),this._extendsOneCoordinateBounds(r));var i=j(this.node,r.getSouthWest().lat(),r.getSouthWest().lng(),r.getNorthEast().lat(),r.getNorthEast().lng(),{zoomMax:21,padding:t?this.settings.googleMaps.padding:0,parsedClientPadding:n});if(isFinite(i))return{zoom:i,center:I([r.getCenter().lat(),r.getCenter().lng()])}}},{key:"getTileDim",value:function(){return{width:q,height:W}}},{key:"fitBounds",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;if(this.realmap){var i=this._parseClientPadding(r),o=I(e),a=I(t),s=this._getPaddedZoomAndCenterForBounds(o,a,n,i)||{},u=s.zoom,l=s.center;if(void 0!==u&&void 0!==l){var c=this.getZoom(),f=y(this.getCenter(),2),d=f[0],h=f[1];if(d!==l[0]||h!==l[1]||c!==u){var p=this._updateViewport.bind(this),v=this.asBounds.bind(this);return this._fitViewport(u,l).then(p).then(v)}}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"addEventListener",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e instanceof google.maps.Polygon||Object.values(ie).includes(t)?this._addGoogleMapsEventListener(e,t,n,r):this._addEventListener(e,t,n,r)}},{key:"_addEventListener",value:function(e,t,n){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?e.addEventListenerOnce(t,n):e.addEventListener(t,n),function(){return e.removeEventListener(t,n)}}},{key:"_addGoogleMapsEventListener",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?google.maps.event.addListenerOnce(e,t,n):google.maps.event.addListener(e,t,n);return function(){return google.maps.event.removeListener(r)}}},{key:"_createPopup",value:function(){var e=this._createGenericPopup(this._getMainParent());return r.HtmlUtils.setZIndex(e,this.settings.maxZIndex+1),r.HtmlUtils.setDisplayNone(e),e.visibleElement=e,e.cssElement=e,e.listening=e,e.clean=[].concat(v(this.registerCompListeners(e.listening,!1)),[z(e,this.addEventListener.bind(this))]),e}},{key:"registerCompListeners",value:function(e,t,n){var i=this,o=t?this.settings.actionsOnMarkerClick:this.settings.actionsOnPopupClick,a=t?this.settings.actionsOnMarkerMouseOver:this.settings.actionsOnPopupMouseOver,s=t?this.settings.actionsOnMarkerMouseOut:this.settings.actionsOnPopupMouseOut,u=t?this.settings.keyNamesForMarkerKeyPressEvent:this.settings.keyNamesForPopupKeyPressEvent,l=this.handleClick.bind(this),c=this.handleMouseOver.bind(this),f=this.handleMouseOut.bind(this),d=this.handleKeyPress.bind(this),h=function(e,t){r.HtmlUtils.isAnHtmlElement(e)&&t.stopPropagation(),t.stop&&(t.stop(),i.ignoreMapClickEvent=!0)};return[this.addEventListener(e,Q,(function(r){h(e,r),l(n,t,o,r.type)})),this.addEventListener(e,re,(function(t){h(e,t),d(n,u,t.code)})),this.addEventListener(e,X,(function(r){h(e,r),c(n,t,a,r.type)})),this.addEventListener(e,Y,(function(r){h(e,r),f(n,t,s,r.type)})),z(e,this.addEventListener.bind(this))]}},{key:"_createDebugMarker",value:function(e){return this.settings.debugMarkersPosition?{debug:new google.maps.Marker({position:new google.maps.LatLng(e.latLng[0],e.latLng[1]),map:this.realmap}),style:"opacity: 0.5"}:{}}},{key:"clearObfuscateArea",value:function(e){null!=e&&e.marker&&this.clearObfuscateAreaFromMarker(e.marker)}},{key:"clearObfuscateAreaFromMarker",value:function(e){var t,n;null!=e&&null!==(t=e.obfuscateArea)&&void 0!==t&&t.setMap&&(null==e||null===(n=e.obfuscateArea)||void 0===n||n.setMap(null)),null==e||delete e.obfuscateArea}},{key:"_createObfuscatedPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getCirclePolygonData(e);return new google.maps.Polygon({paths:n,map:this.realmap.data.getMap(),clickable:t})}},{key:"_updateObfuscateAreaStyle",value:function(e,t){var n,r,i,o,a,s=O(this.settings.obfuscateStyle[e.type],e.hashKeys),u=s.key,l=s.value;t.setOptions({fillColor:null==l||null===(n=l.fill)||void 0===n?void 0:n.color,fillOpacity:null==l||null===(r=l.fill)||void 0===r?void 0:r.opacity,strokeColor:null==l||null===(i=l.line)||void 0===i?void 0:i.color,strokeOpacity:null==l||null===(o=l.line)||void 0===o?void 0:o.opacity,strokeWeight:null==l||null===(a=l.line)||void 0===a?void 0:a.weight}),t.styleKey=u}},{key:"hasObfuscateAreaStyleChanged",value:function(e){var t,n;return(null===(t=this.getMarkerComponent(e))||void 0===t?void 0:t.obfuscateArea)&&(null===(n=this.getMarkerComponent(e))||void 0===n||null===(n=n.obfuscateArea)||void 0===n?void 0:n.styleKey)!==F(this.settings.obfuscateStyle[e.type],e.hashKeys)}},{key:"_getMainParent",value:function(){var e;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getPanes())||void 0===e?void 0:e.overlayMouseTarget)||this.temporaryDiv}},{key:"createPinMarkerWithClickListener",value:function(e,t,n){var i=e.feature,o=e.container,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h="none"!==n,p=this._createDebugMarker(i),y=p.debug,v=p.style,g=this.uniqId("marker-".concat(this.asKey(i))),m="".concat(u.join(" ")).concat(h?" frame-".concat(n):""),b=o||r.HtmlUtils.createDiv(g,this._getMainParent(),m,v);o&&r.HtmlUtils.replaceClassesAndStyle(o,m,v);var k=K(t,b,n,!0,oe),w=k.iconImg,P=k.main;b.frameIcon=n,b.compType="pin",r.HtmlUtils.setAriaHidden(P),b.iconElements={cornerIcons:a,innerIcons:s},U(b,a),V(w,s),r.HtmlUtils.setZIndex(b,l),b.ariaElement=b,N(i.highlighted,b.ariaElement,d),b.zIndexElement=b,b.iconElements.pin=P,b.clone=function(){return b.cloneNode(!0)},b.bounceElement=P,b.cssElement=b,b.labels={textLblCont:b},H(b,i,c,f,this.settings,this._zIndexAdjustment);var C=h?b:w;return b.listening!==C&&(this.cleanMarkerListeners(b),b.listening=C,b.clean=this.registerCompListeners(b.listening,!0,i)),b.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),b.debug=y,b}},{key:"createTextMarkerWithClickListener",value:function(e,t,n){var i=e.feature,o=e.container,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(i),p=h.debug,y=h.style,v=this.uniqId("marker-".concat(this.asKey(i))),g=u.join(" "),m=Z(v,o,this._getMainParent(),n,g,t,y),b=m.main,k=m.text,w=m.span;b.iconElements={cornerIcons:a,innerIcons:s},U(k,a),V(w,s),r.HtmlUtils.setZIndex(b,l),b.ariaElement=k,N(i.highlighted,b.ariaElement,d),b.zIndexElement=b,b.clone=function(){return b.cloneNode(!0)},b.bounceElement=k,b.cssElement=b,b.labels={textLblCont:b},b.label=t,H(b,i,c,f,this.settings,this._zIndexAdjustment.bind(this));var P=b;return b.listening!==P&&(this.cleanMarkerListeners(b),b.listening=P,b.clean=this.registerCompListeners(b.listening,!0,i)),b.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),b.debug=p,b}},{key:"createClusterMarkerWithClickListener",value:function(e,t,n){var i=this._createDebugMarker(e),o=i.debug,a=i.style,s=this._createClusterMarker(this._getMainParent(),e,t,n,a);s.clone=function(){return s.cloneNode(!0)};var u=x(this.settings.zIndexes[e.type],e.hashKeys);return r.HtmlUtils.setZIndex(s,u),s.zIndexElement=s,this.cleanMarkerListeners(s),s.listening=s,s.clean=this.registerCompListeners(s.listening,!0,e),s.position=new google.maps.LatLng(e.latLng[0],e.latLng[1]),s.debug=o,s}},{key:"createObfuscateMarkerWithClickListener",value:function(e){var t=this,n=e.feature,i=e.container,o=e.cssClasses,a=e.zIndex,s=e.label,u=e.subLabel,l=e.ariaLabels,c=this._createDebugMarker(n),f=c.debug,d=c.style,h=this.uniqId("marker-".concat(this.asKey(n))),p=o.join(" "),y=i||r.HtmlUtils.createDiv(h,this._getMainParent(),p,d);i&&r.HtmlUtils.replaceClassesAndStyle(i,p,d);var v=this._createObfuscatedPolygon(n,!0);this._updateObfuscateAreaStyle(n,v),r.HtmlUtils.setZIndex(y,a),y.ariaElement=y,N(n.highlighted,y.ariaElement,l),y.zIndexElement=y,y.cssElement=y,y.labels={textLblCont:y},H(y,n,s,u,this.settings,this._zIndexAdjustment);var g=v;return y.listening!==g&&(this.cleanMarkerListeners(y),y.listening=g,y.clean=this.registerCompListeners(y.listening,!0,n)),y.position=new google.maps.LatLng(n.latLng[0],n.latLng[1]),y.clone=function(){return t.cloneObfuscatedPolygon(n,y)},y.obfuscateArea=v,y.debug=f,y}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,t,n){var i=this,o=e.feature,a=e.container,s=e.cornerIcons,u=e.innerIcons,l=e.cssClasses,c=e.zIndex,f=e.label,d=e.subLabel,h=e.ariaLabels,p=this._createDebugMarker(o),y=p.debug,v=p.style,g=this.uniqId("marker-".concat(this.asKey(o))),m="none"!==n,b="".concat(l.join(" ")).concat(m?" frame-".concat(n):""),k=a||r.HtmlUtils.createDiv(g,this._getMainParent(),b,v);a&&r.HtmlUtils.replaceClassesAndStyle(a,b,v);var w=r.HtmlUtils.createDiv(void 0,k,"pin-marker"),P=r.HtmlUtils.createDiv(void 0,w,"marker-icon-inter");r.HtmlUtils.setAriaHidden(P);var C=K(t,P,n,!0,oe),L=C.iconImg,M=C.main;k.frameIcon=n,k.iconElements={cornerIcons:s,innerIcons:u},U(P,s),V(L,u);var _=this._createObfuscatedPolygon(o);return this._updateObfuscateAreaStyle(o,_),r.HtmlUtils.setZIndex(w,c),k.ariaElement=w,N(o.highlighted,k.ariaElement,h),k.zIndexElement=w,k.bounceElement=M,k.cssElement=k,k.labels={textLblCont:r.HtmlUtils.isAnHtmlElement(t)?M:P},k.iconElements.pin=M,k.obfuscateArea=_,k.clone=function(){return i.cloneObfuscatedPolygon(o,k)},H(k,o,f,d,this.settings,this._zIndexAdjustment),this.cleanMarkerListeners(k),k.listening=m?w:L,k.clean=this.registerCompListeners(k.listening,!0,o),k.position=new google.maps.LatLng(o.latLng[0],o.latLng[1]),k.debug=y,k}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,t){var n=this,i=e.feature,o=e.container,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(i),p=h.debug,y=h.style,v=this.uniqId("marker-".concat(this.asKey(i))),g=u.join(" "),m=o||r.HtmlUtils.createDiv(v,this._getMainParent(),g,y);o&&r.HtmlUtils.replaceClassesAndStyle(o,g,y);var b=Z(void 0,void 0,m,"price","price-marker",t),k=b.main,w=b.text,P=b.span;m.iconElements={cornerIcons:a,innerIcons:s},U(w,a),V(P,s);var C=this._createObfuscatedPolygon(i);return this._updateObfuscateAreaStyle(i,C),r.HtmlUtils.setZIndex(k,l),m.ariaElement=w,N(i.highlighted,m.ariaElement,d),m.zIndexElement=k,m.bounceElement=w,m.cssElement=m,m.labels={textLblCont:k},this.cleanMarkerListeners(m),m.listening=k,m.clean=this.registerCompListeners(m.listening,!0,i),m.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),m.obfuscateArea=C,m.clone=function(){return n.cloneObfuscatedPolygon(i,m)},m.label=t,H(m,i,c,f,this.settings,this._zIndexAdjustment),m.debug=p,m}},{key:"resetRouteStyle",value:function(){}},{key:"_createPolyline",value:function(e,t,n){var r={path:e,geodesic:null!=n&&n};switch(t.lineStyle){case"none":break;case"dash":r.icons=[{icon:{path:"M 0,-1 0,1",fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width},offset:"0",repeat:"".concat(4*t.width,"px")}],r.strokeOpacity=0;break;case"dot":r.icons=[{icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width/2},offset:"0",repeat:"".concat(2*t.width,"px")}],r.strokeOpacity=0;break;default:r.strokeColor=t.color,r.strokeWeight=t.width,r.strokeOpacity=t.opacity}return new google.maps.Polyline(r)}},{key:"addRouteOnMap",value:function(e,t){var n=this;return new Promise((function(r){var i;null===(i=t.route)||void 0===i||delete i.copyrights;var o="flying"==e.mode;e.polyline=n._createPolyline(t.route.path,n.settings.routeLineStyleByDistanceMode[e.mode],o),e.polyline.setMap(n.realmap),r(e)}))}},{key:"removeRouteOnMap",value:function(e){return new Promise((function(t){var n;null===(n=e.polyline)||void 0===n||n.setMap(null),t()}))}},{key:"addPolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=e.polygonDisplayed,r=e.style,i=n.id,o=n.type,a=n.polygon,s=t._createPolygon(a,r);s.forEach((function(e){return e.setMap(t.realmap)}));var u={id:i,type:o},l=t.asKey(u);return t.visiblePolygonsByKey.set(l,s),u}));return Promise.resolve(n)}},{key:"removePolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=t.asKey(e),r=t.visiblePolygonsByKey.get(n);if(r)return r.forEach((function(e){return e.setMap(null)})),t.visiblePolygonsByKey.delete(n),e})).filter((function(e){return void 0!==e}));return Promise.resolve(n)}},{key:"_createPolygon",value:function(e,t){return R(e).map((function(e){var n={clickable:!1,paths:1===e.length?e[0]:e,strokeColor:t.line.color,strokeOpacity:t.line.opacity,strokeWeight:t.line.weight,fillColor:t.fill.color,fillOpacity:t.fill.opacity};return new google.maps.Polygon(n)}))}},{key:"_zIndexAdjustment",value:function(e){return google.maps.Marker.MAX_ZINDEX+e}},{key:"forceMapModeView",value:function(){var e;null===(e=this.realmap)||void 0===e||null===(e=e.getStreetView())||void 0===e||e.setVisible(!1)}}]),n}(r.BaseMap);window.egmapsGoogleMaps=e}(),i}())},11921:function(e,t,n){var r;window,e.exports=(r=n(90439),function(){var e={621:function(e){e.exports=r}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){n.r(i);var e={};n.r(e),n.d(e,{MapBox:function(){return Pe}});var t=n(621),r=6371008.8,o={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*r,kilometers:6371.0088,kilometres:6371.0088,meters:r,metres:r,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:r/1852,radians:1,yards:6967335.223679999};function a(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function s(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!h(e[0])||!h(e[1]))throw new Error("coordinates must contain numbers");return a({type:"Point",coordinates:e},t,n)}function u(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:e},t,n)}function l(e,t){void 0===t&&(t="kilometers");var n=o[t];if(!n)throw new Error(t+" units is invalid");return e*n}function c(e,t){void 0===t&&(t="kilometers");var n=o[t];if(!n)throw new Error(t+" units is invalid");return e/n}function f(e){return e%(2*Math.PI)*180/Math.PI}function d(e){return e%360*Math.PI/180}function h(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function p(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function y(e,t,n){if(void 0===n&&(n={}),!0===n.final)return function(e,t){var n=y(t,e);return(n+180)%360}(e,t);var r=p(e),i=p(t),o=d(r[0]),a=d(i[0]),s=d(r[1]),u=d(i[1]),l=Math.sin(a-o)*Math.cos(u),c=Math.cos(s)*Math.sin(u)-Math.sin(s)*Math.cos(u)*Math.cos(a-o);return f(Math.atan2(l,c))}function v(e,t,n,r){void 0===r&&(r={});var i=p(e),o=d(i[0]),a=d(i[1]),u=d(n),l=c(t,r.units),h=Math.asin(Math.sin(a)*Math.cos(l)+Math.cos(a)*Math.sin(l)*Math.cos(u));return s([f(o+Math.atan2(Math.sin(u)*Math.sin(l)*Math.cos(a),Math.cos(l)-Math.sin(a)*Math.sin(h))),f(h)],r.properties)}var g=function(e,t,n){void 0===n&&(n={});var r=p(e),i=p(t),o=d(i[1]-r[1]),a=d(i[0]-r[0]),s=d(r[1]),u=d(i[1]),c=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(u);return l(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n.units)};function m(e,t,n){void 0===n&&(n={});for(var r,i=("Feature"===(r=e).type?r.geometry:r).coordinates,o=0,a=0;a<i.length&&!(t>=o&&a===i.length-1);a++){if(o>=t){var u=t-o;if(u){var l=y(i[a],i[a-1])-180;return v(i[a],u,l,n)}return s(i[a])}o+=g(i[a],i[a+1],n)}return s(i[i.length-1])}function b(e,t,n){if(null!==e)for(var r,i,o,a,s,u,l,c,f=0,d=0,h=e.type,p="FeatureCollection"===h,y="Feature"===h,v=p?e.features.length:1,g=0;g<v;g++){s=(c=!!(l=p?e.features[g].geometry:y?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;m<s;m++){var k=0,w=0;if(null!==(a=c?l.geometries[m]:l)){u=a.coordinates;var P=a.type;switch(f=!n||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===t(u,d,g,k,w))return!1;d++,k++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===t(u[r],d,g,k,w))return!1;d++,"MultiPoint"===P&&k++}"LineString"===P&&k++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(i=0;i<u[r].length-f;i++){if(!1===t(u[r][i],d,g,k,w))return!1;d++}"MultiLineString"===P&&k++,"Polygon"===P&&w++}"Polygon"===P&&k++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(w=0,i=0;i<u[r].length;i++){for(o=0;o<u[r][i].length-f;o++){if(!1===t(u[r][i][o],d,g,k,w))return!1;d++}w++}k++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===b(a.geometries[r],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function k(e,t){var n,r,i,o,a,s,u,l,c,f,d=0,h="FeatureCollection"===e.type,p="Feature"===e.type,y=h?e.features.length:1;for(n=0;n<y;n++){for(s=h?e.features[n].geometry:p?e.geometry:e,l=h?e.features[n].properties:p?e.properties:{},c=h?e.features[n].bbox:p?e.bbox:void 0,f=h?e.features[n].id:p?e.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,d,l,c,f))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===t(o.geometries[r],d,l,c,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,d,l,c,f))return!1;d++}}function w(e,t){k(e,(function(e,n,r,i,o){var s,u=null===e?null:e.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==t(a(e,r,{bbox:i,id:o}),n,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<e.coordinates.length;l++){var c=e.coordinates[l];if(!1===t(a({type:s,coordinates:c},r),n,l))return!1}}))}function P(e,t,n){var r=n,i=!1;return function(e,t){w(e,(function(e,n,r){var i=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,s=0,l=0,c=0;return!1!==b(e,(function(o,f,d,h,p){if(void 0===a||n>s||h>l||p>c)return a=o,s=n,l=h,c=p,void(i=0);var y=u([a,o],e.properties);if(!1===t(y,n,r,p,i))return!1;i++,a=o}))&&void 0}}}))}(e,(function(e,o,a,s,u){r=!1===i&&void 0===n?e:t(r,e,o,a,s,u),i=!0})),r}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function I(e){var t=function(e,t){if("object"!==C(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===C(t)?t:String(t)}function A(){return A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},A.apply(this,arguments)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var i=j(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var B=t.Utils.firstDefinedValue,R=t.Utils.firstDefinedValueAndKey,N=t.Utils.firstDefinedKey,U=t.Utils.removeDuplicates,V=t.Utils.roundLatOrLng,z=t.Utils.roundLatLng,K=t.Utils.isArray,Z=t.Utils.getPaddedZoomAndCenter,H=t.Utils.roundZoom,q=t.MarkerUtils.setAccessibilityFields,W=t.MarkerUtils.createCornerIcons,G=t.MarkerUtils.createInnerIcons,Q=t.MarkerUtils.createDoubleClickEventCanceller,$=t.MarkerUtils.createImageIcon,X=t.MarkerUtils.createBasicTextMarker,Y=t.Labels.createLabels,J=t.Geo.computeZoomFromBBox,ee=t.Geo.areBoundsCrossingDateLine,te=t.Geo.areCoordinatesCrossingDateLine,ne="flying",re={height:512,width:512},ie=200,oe="fill-color",ae="fill-opacity",se="line-color",ue="line-width",le="line-opacity",ce="visiblePolygons",fe="obfuscatedPolygons",de="click",he="mouseenter",pe="mouseleave",ye="focus",ve="focusout",ge="keydown",me="keyup",be="keypress",ke={scaleControl:function(e){return new mapboxgl.ScaleControl(e)},navControl:function(e){return new mapboxgl.NavigationControl(e)},geoLocateControl:function(e){return new mapboxgl.GeolocateControl(e)},fullscreenControl:function(e){return new mapboxgl.FullscreenControl(e)}},we="marker-icon",Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(a,e);var n,r,i,o=D(a);function a(e,n,r,i){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(s=o.call(this,e,n,r,i)).TilesLoader=t.TilesLoader,s.logger=e.logger("MapBox"),s.logger.debug("MapBox constructor"),s.mapConfig={keyboard:!1},s.additionalConfig=s.settings.mapbox.mapboxAddConf,s.rtlTextPlugin=s.settings.mapbox.rtlTextPlugin,s.additionalConfig&&Object.assign(s.mapConfig,s.additionalConfig),s}return n=a,r=[{key:"removeMarkerFromMap",value:function(e){e.remove(),e.debug&&e.debug.remove(),this.clearObfuscateAreaFromId(e.id),this.cleanMarkerListeners(e)}},{key:"cleanMarkerListeners",value:function(e){var t;null===(t=e.clean)||void 0===t||t.forEach((function(e){return e()})),e.clean=[]}},{key:"cloneMarker",value:function(e){return null==e?void 0:e.clone()}},{key:"init",value:function(e,t){var n=this;this.mapConfig.container=this.node;var r=this.configHelper.mapboxAccessToken();if(r)mapboxgl.accessToken=r;else if(!mapboxgl.accessToken)throw new Error("No mapbox access token set ! Mapbox cannot work properly !");var i=this._zoomAndCenterFromViewport(e,t)||{},o=i.zoom,a=i.center;o&&a&&(this.mapConfig.zoom=o-1,this.mapConfig.center=[a[1],a[0]]),this.realmap=new mapboxgl.Map(this.mapConfig),Object.keys(ke).forEach((function(e){return n._addControl(e,ke[e])})),this.mapNavFocusElement=this.realmap.getCanvas(),this._handleMapFocus(),this._registerMapListeners(),this.visiblePolygons=[],this.obfuscatedPolygons=[];var s=[];s.push(this._initializeTilesLoader());var u=this._initializeRoutesSourcesAndLayers.bind(this),l=this._initializePolygonsSourcesAndLayers.bind(this,ce,this.visiblePolygons),c=this._initializePolygonsSourcesAndLayers.bind(this,fe,this.obfuscatedPolygons),f=new Promise((function(e){n.realmap.on("load",(function(){u(),l(),c(),e()}))}));return this.configHelper.readParam("map,mapInitWaitForTiles")&&s.push(f),this.popup=this._createPopup(),Promise.all(s)}},{key:"_addControl",value:function(e,t){var n=this.configHelper.readParam("mapbox,".concat(e));if(n.ctrlEnabled){var r=t(n.ctrlOptions),i=n.ctrlPosition;this.realmap.addControl(r,i)}}},{key:"registerListenerOnMapFocusElement",value:function(e,t){this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t))}},{key:"_handleMapFocus",value:function(){var e=this;this.keyboardFeatures&&this.mapNavFocusElement&&(this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,ye,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility()}))),this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,ve,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility(!1)}))))}},{key:"_initializeTilesLoader",value:function(){var e=this;return new Promise((function(t){e.tilesLoader=new e.TilesLoader(e.settings,e.createTileFeature.bind(e),e.removeTileFeature.bind(e),e._updateViewport.bind(e),e.handleTilesLoaded.bind(e),e.handleTilesContentLoaded.bind(e),1),e.realmap.on("data",(function(t){if(t&&t.coord&&"source"===t.dataType&&t.coord.canonical){var n=t.coord.canonical;e.tilesLoader.loadTile(n.x,n.y,n.z,1)}})),t()}))}},{key:"resetRouteStyle",value:function(){var e=this;Object.keys(this.routesSources).forEach((function(t){e.realmap.removeLayer(e.routesSources[t].id),e.realmap.addLayer(e._createRouteLayer(t))}))}},{key:"_createRouteLayer",value:function(e){var t=this.settings.routeLineStyleByDistanceMode[e],n={id:"layer-".concat(e),type:"line",source:e,data:{type:"FeatureCollection",features:[]},paint:{"line-color":t.color,"line-opacity":t.opacity,"line-width":t.width}};switch(t.lineStyle){case"dash":n.paint["line-dasharray"]=[2,2];break;case"dot":n.paint["line-dasharray"]=[1,1]}return this.routesSources[e]=n,n}},{key:"_initializePolygonsSourcesAndLayers",value:function(e,t){var n,r;this.realmap.addSource(e,{type:"geojson",data:{type:"FeatureCollection",features:t}}),this.realmap.addLayer({id:"".concat(e,"Fill"),type:"fill",source:e,layout:{},paint:(n={},S(n,oe,["get",oe]),S(n,ae,["get",ae]),n)}),this.realmap.addLayer({id:"".concat(e,"Stroke"),type:"line",source:e,layout:{},paint:(r={},S(r,se,["get",se]),S(r,ue,["get",ue]),S(r,le,["get",le]),r)})}},{key:"_initializeRoutesSourcesAndLayers",value:function(){var e=this;this.routesSources={},["cycling","driving","walking",ne].forEach((function(t){e.realmap.addSource(t,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),e.realmap.addLayer(e._createRouteLayer(t))}))}},{key:"_registerMapListeners",value:function(){var e,t,n,r,i;this.registeredEvents={},(e=this.listenersToDeregister).push.apply(e,x(this._registerKeyboardListeners())),this.listenersToDeregister.push(this._registerIdleListener()),this.listenersToDeregister.push(this._registerZoomListener()),(t=this.listenersToDeregister).push.apply(t,x(this._registerListenerForBoundsChanged("dragend","drag"))),(n=this.listenersToDeregister).push.apply(n,x(this._registerListenerForBoundsChanged("pitchend","pitch"))),(r=this.listenersToDeregister).push.apply(r,x(this._registerListenerForBoundsChanged("rotatend","rotate"))),(i=this.listenersToDeregister).push.apply(i,x(this._registerListenerForBoundsChanged("touchend","touch"))),this.listenersToDeregister.push(this._registerMapListener("dragstart",this.handleDragStart.bind(this))),this.listenersToDeregister.push(this._registerMapListener("style.load",this.setLocale.bind(this))),this.listenersToDeregister.push(this._registerMapListener("click",this.handleMapClick.bind(this))),this.listenersToDeregister.push(this._registerTilesLoadedListener())}},{key:"_registerTilesLoadedListener",value:function(){var e=this;return this.tilesLoadedCount=0,this._registerMapListener("sourcedata",(function(){e.tilesLoadedCount++,setTimeout(function e(t,n){return function(){t>0&&t===n.tilesLoadedCount?(n.tilesLoadedCount=0,n.handleTilesLoaded("mapProvider","map")):n.tilesLoadedCount>0&&setTimeout(e(n.tilesLoadedCount,n),500)}}(e.tilesLoadedCount,e),500)}))}},{key:"_registerKeyboardListeners",value:function(){var e=this,n={duration:ie},r=this.realmap.zoomIn.bind(this.realmap),i=this.realmap.zoomOut.bind(this.realmap);this.keyboardListeners=new t.KeyboardListeners((function(t){return e.realmap.panBy(t,n)}),r,i);var o=this.handleBoundsChanged.bind(this);return[this.addEventListener(this.mapNavFocusElement,ge,this.keyboardListeners.keyDownListenerCallback),this.addEventListener(this.mapNavFocusElement,me,this.keyboardListeners.keyUpListenerCallback),this.addEventListener(this.mapNavFocusElement,be,this.keyboardListeners.keyPressListenerCallback),this._registerMapListener("idle",(function(){U(e.keyboardListeners.extractKeyboardEvent("center_changed")).forEach(o)}))]}},{key:"_registerZoomListener",value:function(){var e=this;this.lastZoomValueChecked=this.getZoom();var t=this.handleBoundsChanged.bind(this),n=this.getZoom.bind(this);return this._registerMapListener("zoomend",(function(){var r=n(),i=r>e.lastZoomValueChecked;e.lastZoomValueChecked=r;var o=e.keyboardListeners.extractKeyboardEvent("zoom_changed");o.length>0?U(o).forEach(t):t(i?"zoomIn":"zoomOut")}))}},{key:"_registerMapListener",value:function(e,t,n){var r=this;return n?(this.realmap.on(e,n,t),function(){return r.realmap.off(e,n,t)}):(this.realmap.on(e,t),function(){return r.realmap.off(e,t)})}},{key:"_registerListenerForBoundsChanged",value:function(e,t){var n=this,r=this.handleBoundsChanged.bind(this);return this.registeredEvents[e]=[],[this._registerMapListener(e,(function(r){r.originalEvent&&n.registeredEvents[e].push(t)})),this._registerMapListener("idle",(function(){return U(n.registeredEvents[e].splice(0)).forEach(r)}))]}},{key:"_registerIdleListener",value:function(){var e=this;return this._registerMapListener("idle",(function(){return e.eventsManager.pushEvent(t.EventTypes.idle)}))}},{key:"unbindAll",value:function(){this.listenersToDeregister.forEach((function(e){return e()})),this.realmap&&this.realmap.remove()}},{key:"addEventListener",value:function(e,t,n){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?e.addEventListenerOnce(t,n):e.addEventListener(t,n),function(){return e.removeEventListener(t,n)}}},{key:"centerAndZoomMap",value:function(e,t,n){var r=this,i=_(e?z(e):[],2),o=i[0],a=i[1],s=t,u={};if(void 0!==o&&void 0!==a&&void 0!==s&&void 0!==n){var l=this._parseClientPadding(n),c=this._getPaddedZoomAndCenterForCenterAndZoom(e,t,l)||{},f=c.zoom,d=c.center;if(void 0!==f&&void 0!==d){var h=_(d,2);o=h[0],a=h[1],s=f-1}}if(void 0!==o&&void 0!==a){var p=this.realmap.getCenter(),y=_(z([p.lat,p.lng]),2),v=y[0],g=y[1];v===o&&g===a||(u.center=new mapboxgl.LngLat(a,o))}return s&&this.getZoom()!==s&&(u.zoom=s),!(!u.center&&!u.zoom||(this.boundChangedDisabled=!0,this.realmap.once("moveend",(function(){r._updateViewport()})),this.realmap.easeTo(M({duration:ie},u)),0))}},{key:"asNativeBounds",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new mapboxgl.LngLatBounds(new mapboxgl.LngLat(V(e[1],void 0,n),V(e[0],void 0,!1)),new mapboxgl.LngLat(V(t[1],void 0,n),V(t[0],void 0,!1)))}},{key:"isFeatureInRealBound",value:function(e,t){var n=e.contains([t.latLng[1],t.latLng[0]]);if(!n){if(e.getNorthEast().lng>180)return e.contains([t.latLng[1]+360,t.latLng[0]]);if(e.getSouthWest().lng<-180)return e.contains([t.latLng[1]-360,t.latLng[0]])}return n}},{key:"getCenter",value:function(){var e=this.realmap.getCenter();return[e.lat,e.lng]}},{key:"getRectOfMarker",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.getMarkerComponent(e),i=r.clientWidth,o=r.clientHeight,a=this.realmap.project(e.marker.getLngLat());return t.HtmlUtils.getRect(a,i+2*n,o+2*n)}},{key:"getZoom",value:function(){return H(this.realmap.getZoom())}},{key:"asBounds",value:function(e){if(e){var t=e.getSouthWest(),n=e.getNorthEast(),r=this.getCenter();return{sw:[V(t.lat),V(t.lng)],ne:[V(n.lat),V(n.lng)],center:r}}}},{key:"containerBounds",value:function(e){if(this.realmap){var t=this.realmap.unproject([e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2]),n=this.realmap.unproject([e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2]);return{sw:[V(t.lat),V(t.lng)],ne:[V(n.lat),V(n.lng)],center:[V(t.lat+(t.lat-n.lat)/2),V(n.lng+(n.lng-t.lng)/2)]}}}},{key:"computeNativeBoundsFromLatLongs",value:function(e){if((null==e?void 0:e.length)>0){var t=this._computeNativeBoundsFromLatLongsAux(e);if(te(e)){var n=this._computeNativeBoundsFromLatLongsAux(e.filter((function(e){var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])<0}))),r=this._computeNativeBoundsFromLatLongsAux(e.filter((function(e){var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])>=0})));return this.asNativeBounds(z([t.getSouthWest().lat,r.getSouthWest().lng]),z([n.getNorthEast().lat,n.getNorthEast().lng]))}return t}}},{key:"_computeNativeBoundsFromLatLongsAux",value:function(e){var t=new mapboxgl.LngLatBounds;return e.forEach((function(e){var n=_(z(e),2),r=n[0],i=n[1];t=t.extend(new mapboxgl.LngLat(i,r))})),t}},{key:"_zoomAndCenterFromViewport",value:function(e,t){if(e){var n=e.center,r=e.zoom,i=e.sw,o=e.ne,a=e.coordinates,s=e.useBoundsComputation,u=e.options,l=this._parseClientPadding(t);if(n&&r)return this._getPaddedZoomAndCenterForCenterAndZoom(n,r,l);if(i&&o){var c=z(i),f=z(o);return this._getPaddedZoomAndCenterForBounds(c,f,!1,l)}if(a&&s){var d=this._computeNativeBounds(a,s,u),h=this._computeZoomAndCenterFromMapboxBounds(d,!1,l)||{},p=h.zoom,y=h.center;if(void 0!==p&&void 0!==y)return Z(p+1,y,l)}else if(K(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLongs(e,!0,l)}}},{key:"_getPaddedZoomAndCenterForCenterAndZoom",value:function(e,t,n){return Z(t+1,e,n)}},{key:"_getPaddedZoomAndCenterForBounds",value:function(e,t,n,r){var i=new mapboxgl.LngLatBounds(new mapboxgl.LngLat(e[1],e[0]),new mapboxgl.LngLat(t[1],t[0])),o=this._computeZoomAndCenterFromMapboxBounds(i,n,r)||{},a=o.zoom,s=o.center;if(void 0!==a&&void 0!==s)return Z(a+1,s,r)}},{key:"_getPaddedZoomAndCenterFromLatLongs",value:function(e,t,n){var r=this._computeZoomAndCenterFromMapboxBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,n)||{},i=r.zoom,o=r.center;if(void 0!==i&&void 0!==o)return Z(i+1,o,n)}},{key:"_computeZoomAndCenterFromMapboxBounds",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=e;this._boundsForOneCoordinate(r)&&(r=new mapboxgl.LngLatBounds(r.getSouthWest(),r.getNorthEast()),r=this._extendsOneCoordinateBounds(r)),r=this._fixDatelineBoundsForMapboxInternalMethods(r);var i=J(this.node,r.getSouthWest().lat,r.getSouthWest().lng,r.getNorthEast().lat,r.getNorthEast().lng,{zoomMax:22,padding:t?this.configHelper.readParam("mapbox,padding"):0,worldDimensions:re,parsedClientPadding:n});if(isFinite(i))return{zoom:i,center:z([r.getCenter().lat,r.getCenter().lng])}}},{key:"_extendsOneCoordinateBounds",value:function(e){var t=new mapboxgl.LngLat(e.getNorthEast().lng+.01,e.getNorthEast().lat+.01),n=new mapboxgl.LngLat(e.getNorthEast().lng-.01,e.getNorthEast().lat-.01);return e.extend(t).extend(n)}},{key:"_boundsForOneCoordinate",value:function(e){return e.getNorthEast().lat===e.getSouthWest().lat&&e.getNorthEast().lng===e.getSouthWest().lng}},{key:"_fixDatelineBoundsForMapboxInternalMethods",value:function(e){var t=e.getSouthWest(),n=e.getNorthEast();return ee(t,n)?this.asNativeBounds([t.lat,t.lng],[n.lat,n.lng+360],!1):e}},{key:"fitLatLongs",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;if(this.realmap){this.boundChangedDisabled=!0;var i=this._parseClientPadding(r),o=this._getPaddedZoomAndCenterFromLatLongs(e,n,i)||{},a=o.zoom,s=o.center;if(void 0!==a&&void 0!==s){var u={center:new mapboxgl.LngLat(s[1],s[0]),zoom:a-1};return new Promise((function(e){t.realmap.once("moveend",(function(){t._updateViewport().then((function(n){return e(t.asBounds(n))}))})),t.realmap.easeTo(M({duration:ie},u))}))}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"refresh",value:function(){this.realmap.resize(),A(j(a.prototype),"refresh",this).call(this)}},{key:"nativeBounds",value:function(){if(this.realmap)return this.realmap.getBounds()}},{key:"getTileDim",value:function(){return{width:re.width,height:re.height}}},{key:"fitBounds",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;if(this.realmap){this.boundChangedDisabled=!0;var o=this._parseClientPadding(i),a=z(e),s=z(t),u=this._getPaddedZoomAndCenterForBounds(a,s,r,o)||{},l=u.zoom,c=u.center;if(void 0!==l&&void 0!==c){var f=this.getZoom(),d=_(this.getCenter(),2),h=d[0],p=d[1];if(h!==c[0]||p!==c[1]||f!==l-1){var y={center:new mapboxgl.LngLat(c[1],c[0]),zoom:l-1};return new Promise((function(e){n.realmap.once("moveend",(function(){n._updateViewport().then((function(t){return e(n.asBounds(t))}))})),n.realmap.easeTo(M({duration:ie},y))}))}this.boundChangedDisabled=!1}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"getMarkerComponent",value:function(e){var t;return null===(t=e.marker)||void 0===t?void 0:t.getElement()}},{key:"moveMarkerPosition",value:function(e,t){var n=this.realmap.project(e.marker.getLngLat());n.x+=t.x,n.y+=t.y;var r=this.realmap.unproject(n);e.marker.setLngLat(r)}},{key:"updatePopupPositionOnLayer",value:function(){var e=(this.popup||{}).feature;if(e&&e.defined){var t,n;switch(B(this.settings.popupPositions[e.type],e.hashKeys)){case"above":default:t=0,n=-24;break;case"below":t=0,n=5+this.popup.getElement().offsetHeight}this.popup.setOffset([t,n]),this.popup.setLngLat([this.popup.feature.latLng[1],this.popup.feature.latLng[0]])}}},{key:"_updateViewport",value:function(e){var t=this;return this.realmap?A(j(a.prototype),"_updateViewport",this).call(this,e).then((function(e){return t._updateMarkerPosition(),e})):Promise.resolve(e)}},{key:"ensurePopupVisibility",value:function(){var e=this.popup,t=e.feature,n=e.visibleElement,r=n.offsetWidth,i=n.offsetHeight,o=this.node,a=o.offsetWidth,s=o.offsetHeight,u=B(this.configHelper.popupVisibilityPaddings()[t.type],t.hashKeys),l=null==u?void 0:u.x,c=null==u?void 0:u.y,f="below"===B(this.settings.popupPositions[t.type],t.hashKeys),d=f?1:-1,h=this.getRectOfMarker(t).height,p=this.realmap.project(t.marker.getLngLat()),y={x:p.x-r/2,y:p.y+h*d+i*d},v=_(this._calculatePopupVisibilityOffsetValues(y,l,c,a,s,r,i,f),2),g=v[0],m=v[1];if(0!==g||0!==m){var b=this.realmap.project(this.realmap.getCenter()),k=this.realmap.unproject([b.x+g,b.y+m]);this.realmap.easeTo(k,{duration:ie})}}},{key:"_createPopup",value:function(){var e=this._createGenericPopup(void 0),n=new mapboxgl.Marker({element:e,anchor:"bottom"}).setLngLat([0,0]).addTo(this.realmap);return t.HtmlUtils.setZIndex(e,this.settings.maxZIndex+1),t.HtmlUtils.setDisplayNone(e),n.content=e.content,n.cssElement=e,n.visibleElement=e,e.listening=e,this.cleanMarkerListeners(n),n.clean=[].concat(x(this.registerCompListeners(e,!1)),[Q(e,this.addEventListener.bind(this))]),n}},{key:"registerCompListeners",value:function(e,t,n){var r=t?this.settings.actionsOnMarkerClick:this.settings.actionsOnPopupClick,i=t?this.settings.actionsOnMarkerMouseOver:this.settings.actionsOnPopupMouseOver,o=t?this.settings.actionsOnMarkerMouseOut:this.settings.actionsOnPopupMouseOut,a=t?this.settings.keyNamesForMarkerKeyPressEvent:this.settings.keyNamesForPopupKeyPressEvent,s=this.handleClick.bind(this),u=this.handleMouseOver.bind(this),l=this.handleMouseOut.bind(this),c=this.handleKeyPress.bind(this);return[this.addEventListener(e,de,(function(e){e.stopPropagation(),s(n,t,r,e.type)})),this.addEventListener(e,be,(function(e){e.stopPropagation(),c(n,a,e.code)})),this.addEventListener(e,he,(function(e){e.stopPropagation(),u(n,t,i,e.type)})),this.addEventListener(e,pe,(function(e){e.stopPropagation(),l(n,t,o,e.type)})),Q(e,this.addEventListener.bind(this))]}},{key:"clearObfuscateArea",value:function(e){var t=this.asKey(e);this.clearObfuscateAreaFromId(t)}},{key:"clearObfuscateAreaFromId",value:function(e){this.obfuscatedPolygons.findIndex((function(t){return t.feature_id==e}))>=0&&(this.obfuscatedPolygons=this.obfuscatedPolygons.filter((function(t){return t.feature_id!==e})),this._updateObfuscatedPolygonsSource())}},{key:"_fixMarkerToUse",value:function(e){A(j(a.prototype),"_fixMarkerToUse",this).call(this,e),this._updateObfuscatedPolygonsSource()}},{key:"_updateObfuscatedPolygonsSource",value:function(){this._updatePolygonsSource(fe,this.obfuscatedPolygons)}},{key:"_updateVisiblePolygonsSource",value:function(){this._updatePolygonsSource(ce,this.visiblePolygons)}},{key:"_updatePolygonsSource",value:function(e,t){var n;if("function"==typeof(null===(n=this.realmap)||void 0===n?void 0:n.getSource)){var r,i=null===(r=this.realmap)||void 0===r?void 0:r.getSource(e);null==i||i.setData({type:"FeatureCollection",features:t})}}},{key:"hasObfuscateAreaStyleChanged",value:function(e){var t=this,n=this.obfuscatedPolygons.findIndex((function(n){return n.feature_id===t.asKey(e)}));if(n>=0){var r=N(this.settings.obfuscateStyle[e.type],e.hashKeys);return this.obfuscatedPolygons[n].properties.styleKey!==r}return!1}},{key:"_getPolygonStyle",value:function(e){var t;return S(t={},oe,e.fill.color),S(t,ae,e.fill.opacity),S(t,se,e.line.color),S(t,ue,e.line.weight),S(t,le,e.line.opacity),t}},{key:"_createObfuscatedPolygon",value:function(e){var t=this.asKey(e),n=this.getCirclePolygonData(e),r=R(this.settings.obfuscateStyle[e.type],e.hashKeys),i=r.key,o=r.value,a=this.obfuscatedPolygons.findIndex((function(e){return e.feature_id==t}));if(a<0){var s={feature_id:t,type:"Feature",properties:M({styleKey:i},this._getPolygonStyle(o)),geometry:{type:"Polygon",coordinates:[n.map((function(e){return[e.lng,e.lat]}))]}};this.obfuscatedPolygons.push(s)}else this.obfuscatedPolygons[a].properties=this._getPolygonStyle(o),this._updateObfuscatedPolygonsSource()}},{key:"_createDebugMarker",value:function(e){return this.settings.debugMarkersPosition?{debug:(new mapboxgl.Marker).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap),style:"opacity: 0.5"}:{}}},{key:"createPinMarkerWithClickListener",value:function(e,n,r){var i=e.feature,o=e.container,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(i),p=h.debug,y=h.style,v=this.uniqId("marker-".concat(this.asKey(i))),g="".concat(u.join(" ")).concat("none"!==r?" frame-".concat(r):""),m=o||t.HtmlUtils.createDiv(v,void 0,g,y);o&&t.HtmlUtils.replaceClassesAndStyle(o,g,y);var b=new mapboxgl.Marker({element:m,anchor:"bottom"}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap),k=$(n,m,r,!0,we),w=k.iconImg,P=k.main;b.frameIcon=r,t.HtmlUtils.setAriaHidden(P),b.iconElements={cornerIcons:a,innerIcons:s},W(m,a),G(w,s),b.debug=p,t.HtmlUtils.setZIndex(m,l),t.HtmlUtils.clearAriaLabel(m),b.ariaElement=m,q(i.highlighted,b.ariaElement,d),b.zIndexElement=m,b.iconElements.pin=P,b.cssElement=m,b.labels={textLblCont:m},b.bounceElement=P,b.clone=function(){return m.cloneNode(!0)},Y(b,i,c,f,this.settings,this._zIndexAdjustment);var C=m;return b.listening!==C&&(this.cleanMarkerListeners(b),b.listening=C,b.clean=this.registerCompListeners(b.listening,!0,i)),b}},{key:"createTextMarkerWithClickListener",value:function(e,n,r){var i=e.feature,o=e.container,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(i),p=h.debug,y=h.style,v=this.uniqId("marker-".concat(this.asKey(i))),g=u.join(" "),m=X(v,o,void 0,r,g,n,y),b=m.main,k=m.text,w=m.span,P=new mapboxgl.Marker({element:b,anchor:"bottom"}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap);P.iconElements={cornerIcons:a,innerIcons:s},W(k,a),G(w,s),P.debug=p,t.HtmlUtils.setZIndex(b,l),t.HtmlUtils.clearAriaLabel(b),P.ariaElement=k,q(i.highlighted,P.ariaElement,d),P.zIndexElement=b,P.bounceElement=k,P.cssElement=b,P.labels={textLblCont:b},P.clone=function(){return b.cloneNode(!0)},P.label=n,Y(P,i,c,f,this.settings,this._zIndexAdjustment);var C=b;return P.listening!==C&&(this.cleanMarkerListeners(P),P.listening=C,P.clean=this.registerCompListeners(b,!0,i)),P}},{key:"createClusterMarkerWithClickListener",value:function(e,n,r){var i=this._createDebugMarker(e),o=i.debug,a=i.style,s=this._createClusterMarker(void 0,e,n,r,a),u=new mapboxgl.Marker({element:s}).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap);u.debug=o;var l=B(this.settings.zIndexes[e.type],e.hashKeys);return t.HtmlUtils.setZIndex(s,l),u.zIndexElement=s,u.cssElement=s.cssElement,u.clone=function(){return s.cloneNode(!0)},this.cleanMarkerListeners(u),u.listening=s,u.clean=this.registerCompListeners(s,!0,e),u}},{key:"createObfuscateMarkerWithClickListener",value:function(e){var n=this,r=e.feature,i=e.container,o=e.cssClasses,a=e.zIndex,s=e.label,u=e.subLabel,l=e.ariaLabels,c=this._createDebugMarker(r),f=c.debug,d=c.style,h=this.uniqId("marker-".concat(this.asKey(r))),p=o.join(" "),y=i||t.HtmlUtils.createDiv(h,void 0,p,d);i&&t.HtmlUtils.replaceClassesAndStyle(i,p,d);var v=new mapboxgl.Marker({element:y}).setLngLat([r.latLng[1],r.latLng[0]]).addTo(this.realmap);v.debug=f,t.HtmlUtils.setZIndex(y,a),t.HtmlUtils.clearAriaLabel(y),v.ariaElement=y,q(r.highlighted,v.ariaElement,l),v.zIndexElement=y,v.cssElement=y,v.labels={textLblCont:y},v.obfuscateArea=v,v.featureId=r.id,v.clone=function(){return n.cloneObfuscatedPolygon(r,y)},this._createObfuscatedPolygon(r),Y(v,r,s,u,this.settings,this._zIndexAdjustment);var g=y;return v.listening!==g&&(this.cleanMarkerListeners(v),v.listening=g,v.clean=this.registerCompListeners(v.listening,!0,r)),v}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,n,r){var i=this,o=e.feature,a=e.container,s=e.cornerIcons,u=e.innerIcons,l=e.cssClasses,c=e.zIndex,f=e.label,d=e.subLabel,h=e.ariaLabels,p=this._createDebugMarker(o),y=p.debug,v=p.style,g=this.uniqId("marker-".concat(this.asKey(o))),m="".concat(l.join(" ")).concat("none"!==r?" frame-".concat(r):""),b=a||t.HtmlUtils.createDiv(g,void 0,m,v);a&&t.HtmlUtils.replaceClassesAndStyle(a,m,v);var k=new mapboxgl.Marker({element:b}).setLngLat([o.latLng[1],o.latLng[0]]).addTo(this.realmap),w=t.HtmlUtils.createDiv(void 0,b,"pin-marker"),P=t.HtmlUtils.createDiv(void 0,w,"marker-icon-inter");t.HtmlUtils.setAriaHidden(P);var C=$(n,P,r,!0,we),L=C.iconImg,M=C.main;return k.frameIcon=r,k.iconElements={cornerIcons:s,innerIcons:u},W(P,s),G(L,u),k.debug=y,t.HtmlUtils.setZIndex(w,c),t.HtmlUtils.clearAriaLabel(b),k.ariaElement=w,q(o.highlighted,k.ariaElement,h),k.zIndexElement=w,k.bounceElement=M,k.cssElement=b,k.labels={textLblCont:t.HtmlUtils.isAnHtmlElement(n)?M:P},k.featureId=o.id,k.clone=function(){return i.cloneObfuscatedPolygon(o,b)},k.obfuscateArea=k,this._createObfuscatedPolygon(o),Y(k,o,f,d,this.settings,this._zIndexAdjustment),k.iconElements.pin=M,this.cleanMarkerListeners(k),k.listening=w,k.clean=this.registerCompListeners(k.listening,!0,o),k.id=this.asKey(o),k}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,n){var r=this,i=e.feature,o=e.container,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(i),p=h.debug,y=h.style,v=this.uniqId("marker-".concat(this.asKey(i))),g=u.join(" "),m=o||t.HtmlUtils.createDiv(v,void 0,g,y);o&&t.HtmlUtils.replaceClassesAndStyle(o,g,y);var b=X(void 0,void 0,m,"price","price-marker",n),k=b.main,w=b.text,P=b.span,C=new mapboxgl.Marker({element:m}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap);return C.iconElements={cornerIcons:a,innerIcons:s},W(w,a),G(P,s),C.debug=p,t.HtmlUtils.setZIndex(k,l),t.HtmlUtils.clearAriaLabel(m),C.ariaElement=w,q(i.highlighted,C.ariaElement,d),C.zIndexElement=k,C.bounceElement=w,C.cssElement=m,C.labels={textLblCont:k},C.featureId=i.id,C.clone=function(){return r.cloneObfuscatedPolygon(i,m)},C.obfuscateArea=C,this._createObfuscatedPolygon(i),this.cleanMarkerListeners(C),C.listening=k,C.clean=this.registerCompListeners(C.listening,!0,i),C.label=n,C.id=this.asKey(i),Y(C,i,c,f,this.settings,this._zIndexAdjustment),C}},{key:"setLocale",value:function(){if(this.settings.locale){var e=this.settings.locale.substring(0,2);"unavailable"===mapboxgl.getRTLTextPluginStatus()&&mapboxgl.setRTLTextPlugin(this.rtlTextPlugin,null,!0);var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=O(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.realmap.getStyle().layers.filter((function(e){return/-label/.test(e.id)})));try{for(n.s();!(t=n.n()).done;){var r=t.value;this.realmap.setLayoutProperty(r.id,"text-field",["coalesce",["get","name_"+e],["get","name"]])}}catch(e){n.e(e)}finally{n.f()}}}},{key:"_genGeodesicRoute",value:function(e,t){try{for(var n={type:"Feature",geometry:{type:"LineString",coordinates:[e,t]}},r=(void 0===s&&(s={}),P(n,(function(e,t){var n=t.geometry.coordinates;return e+g(n[0],n[1],s)}),0)),i=[],o=0;o<r;o+=r/500){var a=m(n,o);i.push(a.geometry.coordinates)}return i.length>1&&i[0][0]<0&&i[1][0]>0&&(i[0][0]+=360),i}catch(e){this.logger.error("failed to generate geodesic line. use straight line",e)}var s}},{key:"addRouteOnMap",value:function(e,t){var n=this;return new Promise((function(r){var i=n.routesSources[e.mode];if(i){var o=t.route.path.map((function(e){var t=e.lat;return[e.lng,t]}));e.mode===ne&&2==o.length&&(o=n._genGeodesicRoute(o[0],o[1])||o),i.data.features.push({id:e.id,type:"Feature",geometry:{type:"LineString",coordinates:o}}),n.realmap.getSource(e.mode).setData(i.data)}r(e)}))}},{key:"removeRouteOnMap",value:function(e){var t=this;return new Promise((function(n,r){var i=t.routesSources[e.mode];if(i){var o=i.data.features.findIndex((function(t){return t.id===e.id}));o>=0&&(i.data.features.splice(o,1),t.realmap.getSource(e.mode).setData(i.data)),n()}else r(new Error("can't find source for ".concat(e.mode)))}))}},{key:"updateMapProviderConfig",value:function(){}},{key:"addPolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=e.polygonDisplayed,r=e.style,i=n.id,o=n.type,a=n.polygon,s={feature_id:t.asKey({id:i,type:o}),type:"Feature",properties:t._getPolygonStyle(r),geometry:a};return t.visiblePolygons.push(s),{id:i,type:o}}));return this._updateVisiblePolygonsSource(),Promise.resolve(n)}},{key:"removePolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=t.asKey(e),r=t.visiblePolygons.findIndex((function(e){return e.feature_id==n}));if(r>=0)return t.visiblePolygons.splice(r,1),e})).filter((function(e){return void 0!==e}));return e.length>0&&this._updateVisiblePolygonsSource(),Promise.resolve(n)}},{key:"forceMapModeView",value:function(){}}],r&&E(n.prototype,r),i&&E(n,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(t.BaseMap);window.egmapsMapbox=e}(),i}())}}]);
//# sourceMappingURL=eg-maps.7e81324274030a805a23.js.map